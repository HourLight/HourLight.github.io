<!-- 
  é¦¥éˆä¹‹é‘°ï½œå¡”ç¾…æŠ½ç‰Œæ¨¡çµ„ v2ï¼ˆé»‘é‡‘å®‡å®™ç‰ˆï¼‰
  ä½¿ç”¨æ–¹æ³•ï¼šå°‡æ­¤æª”æ¡ˆçš„å…§å®¹è¤‡è£½åˆ°ä»»ä½•é é¢çš„ <body> ä¸­å³å¯
  
  Â© 2025 é¦¥éˆä¹‹é‘°Â® Hour LightÂ®ï½œé¦¥éˆä¹‹é‘°åœ‹éš›æœ‰é™å…¬å¸
-->

<style>
  /* å¡”ç¾…æŠ½ç‰Œæ¨¡çµ„æ¨£å¼ - é»‘é‡‘å®‡å®™ç‰ˆ */
  .tarot-widget{
    background: rgba(18,13,28,0.96);
    backdrop-filter: blur(16px) saturate(140%);
    border-radius: 20px;
    padding: 26px 24px;
    box-shadow: 0 10px 28px rgba(0,0,0,0.55);
    border: 1px solid rgba(255,255,255,0.12);
    margin: 20px 0;
  }
  .tarot-widget h3{
    text-align: center;
    font-size: 1.4rem;
    font-weight: 900;
    margin-bottom: 6px;
    letter-spacing: 0.05em;
    background: linear-gradient(135deg, #e9c27d, #fff8e7, #cda86e);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .tarot-widget .widget-subtitle{
    text-align: center;
    color: #e9c27d;
    font-size: 0.85rem;
    font-weight: 600;
    margin-bottom: 20px;
  }
  
  /* å¼µæ•¸é¸æ“‡å™¨ */
  .tarot-count-selector{
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 18px;
    flex-wrap: wrap;
  }
  .tarot-count-btn{
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.12);
    color: #f9f0e5;
    padding: 8px 16px;
    border-radius: 999px;
    cursor: pointer;
    font-weight: 700;
    font-size: 0.85rem;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .tarot-count-btn:hover{
    background: rgba(233,194,125,0.15);
    border-color: #e9c27d;
    transform: translateY(-2px);
  }
  .tarot-count-btn.active{
    background: linear-gradient(135deg, #e9c27d, #cda86e);
    color: #1a1a1a;
    border-color: #cda86e;
    box-shadow: 0 4px 14px rgba(233,194,125,0.3);
  }
  
  /* æŠ½ç‰ŒæŒ‰éˆ• */
  .tarot-draw-btn{
    display: block;
    width: 100%;
    max-width: 240px;
    margin: 0 auto 20px;
    background: linear-gradient(135deg, #e9c27d, #cda86e);
    color: #1a1a1a;
    border: none;
    padding: 14px 24px;
    border-radius: 999px;
    font-size: 1rem;
    font-weight: 800;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(233,194,125,0.3);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .tarot-draw-btn:hover{
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(233,194,125,0.45);
  }
  
  /* å¡ç‰‡å®¹å™¨ */
  .tarot-cards-container{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 14px;
    margin-bottom: 18px;
    min-height: 180px;
  }
  
  /* å¡ç‰‡ */
  .tarot-card{
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 14px;
    padding: 16px 10px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
    transform: scale(0.8) rotateY(180deg);
    animation: tarotCardAppear 0.5s forwards;
  }
  @keyframes tarotCardAppear{
    to{
      opacity: 1;
      transform: scale(1) rotateY(0deg);
    }
  }
  .tarot-card.reversed{
    background: linear-gradient(135deg, rgba(92,58,99,0.3), rgba(92,58,99,0.15));
    border-color: rgba(156,39,176,0.3);
  }
  .tarot-card:hover{
    transform: translateY(-4px) scale(1.02);
    border-color: #e9c27d;
    box-shadow: 0 8px 20px rgba(233,194,125,0.2);
  }
  
  /* å¡ç‰‡åœ–æ¨™ */
  .tarot-card-icon{
    font-size: 2.4rem;
    margin-bottom: 10px;
    display: block;
    transition: transform 0.3s;
  }
  .tarot-card.reversed .tarot-card-icon{
    transform: rotate(180deg);
  }
  
  /* å¡ç‰‡åç¨± */
  .tarot-card-name-zh{
    font-size: 0.95rem;
    font-weight: 800;
    color: #e9c27d;
    margin-bottom: 4px;
  }
  .tarot-card-name-en{
    font-size: 0.7rem;
    color: #e2d3c4;
    margin-bottom: 8px;
    opacity: 0.8;
  }
  
  /* æ­£é€†ä½æ¨™ç±¤ */
  .tarot-card-position{
    display: inline-block;
    padding: 4px 12px;
    border-radius: 999px;
    font-size: 0.72rem;
    font-weight: 700;
  }
  .tarot-card-position.upright{
    background: rgba(76,175,80,0.2);
    color: #81c784;
    border: 1px solid rgba(76,175,80,0.3);
  }
  .tarot-card-position.reversed{
    background: rgba(156,39,176,0.2);
    color: #ce93d8;
    border: 1px solid rgba(156,39,176,0.3);
  }
  
  /* è¤‡è£½æŒ‰éˆ• */
  .tarot-copy-btn{
    display: block;
    width: 100%;
    max-width: 240px;
    margin: 0 auto;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.12);
    color: #f9f0e5;
    padding: 12px 20px;
    border-radius: 999px;
    font-size: 0.9rem;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .tarot-copy-btn:hover{
    background: rgba(255,255,255,0.12);
    border-color: #e9c27d;
    transform: translateY(-2px);
  }
  .tarot-copy-btn.copied{
    background: rgba(76,175,80,0.3);
    border-color: #4caf50;
    color: #81c784;
  }
  
  /* ç©ºç‹€æ…‹ */
  .tarot-empty-state{
    text-align: center;
    padding: 36px 16px;
    color: #e2d3c4;
    font-size: 0.9rem;
    opacity: 0.7;
  }
  
  /* LINE æŒ‰éˆ• */
  .tarot-line-btn{
    display: block;
    width: 100%;
    max-width: 240px;
    margin: 12px auto 0;
    background: #06C755;
    border: none;
    color: #fff;
    padding: 12px 20px;
    border-radius: 999px;
    font-size: 0.9rem;
    font-weight: 800;
    cursor: pointer;
    text-decoration: none;
    text-align: center;
    box-shadow: 0 4px 14px rgba(6,199,85,0.3);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .tarot-line-btn:hover{
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(6,199,85,0.45);
  }
  
  /* RWD */
  @media(max-width:600px){
    .tarot-widget{
      padding: 20px 16px;
    }
    .tarot-cards-container{
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
    }
    .tarot-card{
      padding: 12px 8px;
    }
    .tarot-card-icon{
      font-size: 2rem;
    }
    .tarot-count-btn{
      padding: 6px 12px;
      font-size: 0.8rem;
    }
  }
</style>

<div class="tarot-widget">
  <h3>ğŸ´ é¦¥éˆä¹‹é‘°ï½œå¡”ç¾…æŠ½ç‰Œ</h3>
  <p class="widget-subtitle">ğŸ‡¹ğŸ‡¼ æºè‡ªå°ç£ï½œHour LightÂ®</p>

  <div class="tarot-count-selector">
    <button class="tarot-count-btn" data-count="1">1å¼µ</button>
    <button class="tarot-count-btn active" data-count="3">3å¼µ</button>
    <button class="tarot-count-btn" data-count="5">5å¼µ</button>
    <button class="tarot-count-btn" data-count="7">7å¼µ</button>
    <button class="tarot-count-btn" data-count="9">9å¼µ</button>
    <button class="tarot-count-btn" data-count="12">12å¼µ</button>
  </div>

  <button class="tarot-draw-btn" onclick="tarotDraw()">ğŸ”® é–‹å§‹æŠ½ç‰Œ</button>

  <div class="tarot-cards-container" id="tarotCardsContainer">
    <div class="tarot-empty-state">é¸æ“‡å¼µæ•¸å¾Œï¼Œé»æ“Šã€Œé–‹å§‹æŠ½ç‰Œã€</div>
  </div>

  <button class="tarot-copy-btn" id="tarotCopyBtn" onclick="tarotCopyResult()" style="display:none">
    ğŸ“‹ ä¸€éµè¤‡è£½çµæœ
  </button>
  
  <a class="tarot-line-btn" href="https://lin.ee/vpbLhNjF" target="_blank" rel="noopener" id="tarotLineBtn" style="display:none">
    ğŸ’¬ LINE æ·±åº¦è§£è®€
  </a>
</div>

<script>
(function(){
  // å¡”ç¾…ç‰Œè³‡æ–™ï¼ˆ78å¼µå®Œæ•´ç‰Œçµ„ï¼‰
  const majorArcana=[
    {zh:"æ„šè€…",en:"The Fool",icon:"ğŸŒŸ"},
    {zh:"é­”è¡“å¸«",en:"The Magician",icon:"ğŸ©"},
    {zh:"å¥³ç¥­å¸",en:"The High Priestess",icon:"ğŸŒ™"},
    {zh:"çš‡å",en:"The Empress",icon:"ğŸ‘‘"},
    {zh:"çš‡å¸",en:"The Emperor",icon:"âš”ï¸"},
    {zh:"æ•™çš‡",en:"The Hierophant",icon:"ğŸ“¿"},
    {zh:"æˆ€äºº",en:"The Lovers",icon:"ğŸ’•"},
    {zh:"æˆ°è»Š",en:"The Chariot",icon:"ğŸ‡"},
    {zh:"åŠ›é‡",en:"Strength",icon:"ğŸ¦"},
    {zh:"éš±è€…",en:"The Hermit",icon:"ğŸ•¯ï¸"},
    {zh:"å‘½é‹ä¹‹è¼ª",en:"Wheel of Fortune",icon:"ğŸ¡"},
    {zh:"æ­£ç¾©",en:"Justice",icon:"âš–ï¸"},
    {zh:"å€’åŠäºº",en:"The Hanged Man",icon:"ğŸ”„"},
    {zh:"æ­»ç¥",en:"Death",icon:"ğŸŒ‘"},
    {zh:"ç¯€åˆ¶",en:"Temperance",icon:"ğŸ¶"},
    {zh:"æƒ¡é­”",en:"The Devil",icon:"ğŸ˜ˆ"},
    {zh:"é«˜å¡”",en:"The Tower",icon:"ğŸ—¼"},
    {zh:"æ˜Ÿæ˜Ÿ",en:"The Star",icon:"â­"},
    {zh:"æœˆäº®",en:"The Moon",icon:"ğŸŒœ"},
    {zh:"å¤ªé™½",en:"The Sun",icon:"â˜€ï¸"},
    {zh:"å¯©åˆ¤",en:"Judgement",icon:"ğŸ“¯"},
    {zh:"ä¸–ç•Œ",en:"The World",icon:"ğŸŒ"}
  ];
  
  const suits={
    wands:{zh:"æ¬Šæ–",en:"Wands",icon:"ğŸ”¥"},
    cups:{zh:"è–æ¯",en:"Cups",icon:"ğŸ’§"},
    swords:{zh:"å¯¶åŠ",en:"Swords",icon:"âš”ï¸"},
    pentacles:{zh:"éŒ¢å¹£",en:"Pentacles",icon:"ğŸ’°"}
  };
  
  const ranks=[
    {zh:"ç‹ç‰Œ",en:"Ace"},
    {zh:"äºŒ",en:"Two"},
    {zh:"ä¸‰",en:"Three"},
    {zh:"å››",en:"Four"},
    {zh:"äº”",en:"Five"},
    {zh:"å…­",en:"Six"},
    {zh:"ä¸ƒ",en:"Seven"},
    {zh:"å…«",en:"Eight"},
    {zh:"ä¹",en:"Nine"},
    {zh:"å",en:"Ten"},
    {zh:"ä¾è€…",en:"Page"},
    {zh:"é¨å£«",en:"Knight"},
    {zh:"ç‹å",en:"Queen"},
    {zh:"åœ‹ç‹",en:"King"}
  ];
  
  // çµ„åˆå®Œæ•´ 78 å¼µç‰Œ
  const allCards=[...majorArcana];
  Object.entries(suits).forEach(([key,suit])=>{
    ranks.forEach(rank=>{
      allCards.push({
        zh:`${suit.zh}${rank.zh}`,
        en:`${rank.en} of ${suit.en}`,
        icon:suit.icon
      });
    });
  });

  let selectedCount=3;
  let drawnCards=[];

  // é¸æ“‡å¼µæ•¸
  document.querySelectorAll('.tarot-count-btn').forEach(btn=>{
    btn.addEventListener('click',function(){
      document.querySelectorAll('.tarot-count-btn').forEach(b=>b.classList.remove('active'));
      this.classList.add('active');
      selectedCount=parseInt(this.dataset.count);
    });
  });

  // æŠ½ç‰ŒåŠŸèƒ½
  window.tarotDraw=function(){
    const container=document.getElementById('tarotCardsContainer');
    const copyBtn=document.getElementById('tarotCopyBtn');
    const lineBtn=document.getElementById('tarotLineBtn');
    
    // æ´—ç‰Œä¸¦æŠ½å–æŒ‡å®šå¼µæ•¸
    const shuffled=[...allCards].sort(()=>Math.random()-0.5);
    drawnCards=shuffled.slice(0,selectedCount).map(card=>({
      ...card,
      reversed:Math.random()>0.5
    }));

    container.innerHTML='';

    // æ¸²æŸ“å¡ç‰‡
    drawnCards.forEach((card,index)=>{
      const cardEl=document.createElement('div');
      cardEl.className='tarot-card'+(card.reversed?' reversed':'');
      cardEl.style.animationDelay=`${index*0.08}s`;
      cardEl.innerHTML=`
        <span class="tarot-card-icon">${card.icon}</span>
        <div class="tarot-card-name-zh">${card.zh}</div>
        <div class="tarot-card-name-en">${card.en}</div>
        <span class="tarot-card-position ${card.reversed?'reversed':'upright'}">
          ${card.reversed?'é€†ä½':'æ­£ä½'}
        </span>
      `;
      container.appendChild(cardEl);
    });

    // é¡¯ç¤ºè¤‡è£½å’Œ LINE æŒ‰éˆ•
    copyBtn.style.display='block';
    copyBtn.textContent='ğŸ“‹ ä¸€éµè¤‡è£½çµæœ';
    copyBtn.classList.remove('copied');
    lineBtn.style.display='block';
  };

  // è¤‡è£½çµæœ
  window.tarotCopyResult=function(){
    const now=new Date();
    const time=`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
    
    let text='ğŸ´ é¦¥éˆä¹‹é‘°ï½œå¡”ç¾…æŠ½ç‰Œçµæœ\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    drawnCards.forEach((card,i)=>{
      text+=`${i+1}. ${card.zh} (${card.en}) - ${card.reversed?'é€†ä½':'æ­£ä½'}\n`;
    });
    text+=`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\næŠ½ç‰Œæ™‚é–“ï¼š${time}\nğŸ‡¹ğŸ‡¼ æºè‡ªå°ç£ï½œé¦¥éˆä¹‹é‘° Hour LightÂ®\nLINEï¼š@hourlight`;

    navigator.clipboard.writeText(text).then(()=>{
      const btn=document.getElementById('tarotCopyBtn');
      btn.textContent='âœ… å·²è¤‡è£½ï¼';
      btn.classList.add('copied');
      setTimeout(()=>{
        btn.textContent='ğŸ“‹ ä¸€éµè¤‡è£½çµæœ';
        btn.classList.remove('copied');
      },2000);
    }).catch(err=>{
      // å‚™ç”¨æ–¹æ¡ˆï¼šå»ºç«‹è‡¨æ™‚æ–‡å­—æ¡†
      const textarea=document.createElement('textarea');
      textarea.value=text;
      textarea.style.position='fixed';
      textarea.style.opacity='0';
      document.body.appendChild(textarea);
      textarea.select();
      try{
        document.execCommand('copy');
        const btn=document.getElementById('tarotCopyBtn');
        btn.textContent='âœ… å·²è¤‡è£½ï¼';
        btn.classList.add('copied');
        setTimeout(()=>{
          btn.textContent='ğŸ“‹ ä¸€éµè¤‡è£½çµæœ';
          btn.classList.remove('copied');
        },2000);
      }catch(e){
        alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ï¼š\n\n'+text);
      }
      document.body.removeChild(textarea);
    });
  };
})();
</script>
