<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¥éˆç§˜ç¢¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #D4AF37; --gold-light: #F5E6A3; --cream: #FDF8E8; --brown: #4A3728; --night-bg: #1A1A2E; --night-card: #16213E; --purple: #9F5FDB; }
        body { font-family: 'Noto Sans TC', sans-serif; }
        .serif { font-family: 'Noto Serif TC', serif; }
        body.day-mode { background: linear-gradient(135deg, #FDF8E8 0%, #F5E6A3 50%, #FDF8E8 100%); color: #4A3728; }
        body.night-mode { background: linear-gradient(135deg, #1A1A2E 0%, #16213E 50%, #0F0F23 100%); color: #E0D4FC; }
        .gold-text { color: var(--gold); }
        .night-mode .gold-text { color: #FFD700; text-shadow: 0 0 15px rgba(255,215,0,0.3); }
        .gold-btn { background: linear-gradient(135deg, #D4AF37 0%, #F5E6A3 50%, #D4AF37 100%); color: #2D1B0E; font-weight: 600; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); transition: all 0.3s; }
        .gold-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4); }
        .night-mode .gold-btn { background: linear-gradient(135deg, #6B2C91 0%, #9F5FDB 50%, #6B2C91 100%); color: #fff; }
        .key-btn { background: linear-gradient(135deg, #1E3A5F 0%, #2D5A8C 50%, #1E3A5F 100%); color: #FFD700; font-weight: 700; box-shadow: 0 4px 20px rgba(30, 58, 95, 0.5); transition: all 0.3s; border: 2px solid #D4AF37; }
        .key-btn:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 8px 30px rgba(30, 58, 95, 0.6); }
        .night-mode .key-btn { background: linear-gradient(135deg, #2D1B4E 0%, #4A2C7A 50%, #2D1B4E 100%); border-color: #9F5FDB; }
        .card { backdrop-filter: blur(10px); border-radius: 1rem; transition: all 0.3s; }
        .day-mode .card { background: rgba(255, 255, 255, 0.9); border: 1px solid rgba(212, 175, 55, 0.2); box-shadow: 0 4px 20px rgba(139, 115, 85, 0.1); }
        .night-mode .card { background: rgba(22, 33, 62, 0.9); border: 1px solid rgba(159, 95, 219, 0.3); }
        .tab-btn { transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { border-bottom-color: var(--gold); }
        .night-mode .tab-btn.active { border-bottom-color: var(--purple); }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; z-index: 100; }
        .modal-content { max-height: 90vh; overflow-y: auto; }
        select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12'%3E%3Cpath fill='%23D4AF37' d='M6 8L1 3h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 12px center; appearance: none; }
        .score-bar { height: 8px; border-radius: 4px; overflow: hidden; }
        .score-fill { height: 100%; transition: width 0.8s ease-out; }
        .master-badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; animation: glow 2s ease-in-out infinite alternate; }
        .day-mode .master-badge { background: linear-gradient(135deg, #D4AF37, #F5E6A3); color: #4A3728; }
        .night-mode .master-badge { background: linear-gradient(135deg, #9F5FDB, #E066FF); color: #1A1A2E; }
        @keyframes glow { from { box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); } to { box-shadow: 0 0 15px rgba(212, 175, 55, 0.8); } }
        .detail-panel { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .detail-panel.open { max-height: 2000px; }
        .bridge-section { position: relative; overflow: hidden; }
        .bridge-section::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(212,175,55,0.1), transparent); animation: shimmer 3s infinite; }
        @keyframes shimmer { 0% { left: -100%; } 100% { left: 100%; } }
        .floating-card-btn { position: fixed; bottom: 100px; right: 20px; z-index: 45; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        .fire-text { background: linear-gradient(45deg, #ff6b6b, #feca57, #ff9ff3, #ff6b6b); background-size: 300% 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: fireGlow 3s ease infinite; }
        @keyframes fireGlow { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        @media (max-width: 768px) { .tab-btn { font-size: 0.75rem; padding: 0.5rem; } }
    </style>
</head>
<body class="day-mode">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const HOURS = [
            { id: 'zi', name: 'å­æ™‚ (23:00-01:00)', num: 1, palace: 1, meridian: 'è†½ç¶“' },
            { id: 'chou', name: 'ä¸‘æ™‚ (01:00-03:00)', num: 2, palace: 2, meridian: 'è‚ç¶“' },
            { id: 'yin', name: 'å¯…æ™‚ (03:00-05:00)', num: 3, palace: 3, meridian: 'è‚ºç¶“' },
            { id: 'mao', name: 'å¯æ™‚ (05:00-07:00)', num: 4, palace: 4, meridian: 'å¤§è…¸ç¶“' },
            { id: 'chen', name: 'è¾°æ™‚ (07:00-09:00)', num: 5, palace: 5, meridian: 'èƒƒç¶“' },
            { id: 'si', name: 'å·³æ™‚ (09:00-11:00)', num: 6, palace: 6, meridian: 'è„¾ç¶“' },
            { id: 'wu', name: 'åˆæ™‚ (11:00-13:00)', num: 7, palace: 7, meridian: 'å¿ƒç¶“' },
            { id: 'wei', name: 'æœªæ™‚ (13:00-15:00)', num: 8, palace: 8, meridian: 'å°è…¸ç¶“' },
            { id: 'shen', name: 'ç”³æ™‚ (15:00-17:00)', num: 9, palace: 9, meridian: 'è†€èƒ±ç¶“' },
            { id: 'you', name: 'é…‰æ™‚ (17:00-19:00)', num: 10, palace: 10, meridian: 'è…ç¶“' },
            { id: 'xu', name: 'æˆŒæ™‚ (19:00-21:00)', num: 11, palace: 11, meridian: 'å¿ƒåŒ…ç¶“' },
            { id: 'hai', name: 'äº¥æ™‚ (21:00-23:00)', num: 12, palace: 12, meridian: 'ä¸‰ç„¦ç¶“' },
            { id: 'unknown', name: 'æ™‚è¾°ä¸è©³', num: 0, palace: 0, meridian: '' }
        ];
        const getHourData = (hourId) => HOURS.find(h => h.id === hourId) || HOURS[12];

        const LUNAR_YEAR_DATA = {
            1940: [6, 0b010010110110, 2, 8], 1941: [0, 0b010010101110, 1, 27], 1942: [0, 0b101001010110, 2, 15],
            1943: [0, 0b110100100110, 2, 5], 1944: [4, 0b110110010010, 1, 25], 1945: [0, 0b110101010100, 2, 13],
            1946: [0, 0b101101011010, 2, 2], 1947: [2, 0b010101101100, 1, 22], 1948: [0, 0b100101101110, 2, 10],
            1949: [7, 0b010010101110, 1, 29], 1950: [0, 0b110001010110, 2, 17], 1951: [0, 0b110100100110, 2, 6],
            1952: [5, 0b101100101010, 1, 27], 1953: [0, 0b101101010100, 2, 14], 1954: [0, 0b101101011010, 2, 3],
            1955: [3, 0b010101011100, 1, 24], 1956: [0, 0b100101011110, 2, 12], 1957: [8, 0b010010011110, 1, 31],
            1958: [0, 0b110010010110, 2, 18], 1959: [0, 0b110101001010, 2, 8], 1960: [6, 0b110110100100, 1, 28],
            1961: [0, 0b101101101010, 2, 15], 1962: [0, 0b010101101100, 2, 5], 1963: [4, 0b100101011100, 1, 25],
            1964: [0, 0b101001011110, 2, 13], 1965: [0, 0b101001001110, 2, 2], 1966: [3, 0b110100100110, 1, 21],
            1967: [0, 0b110101010100, 2, 9], 1968: [7, 0b101101010100, 1, 30], 1969: [0, 0b101101011010, 2, 17],
            1970: [0, 0b010101101100, 2, 6], 1971: [5, 0b100100101110, 1, 27], 1972: [0, 0b110010010110, 2, 15],
            1973: [0, 0b110101001010, 2, 3], 1974: [4, 0b110110100100, 1, 23], 1975: [0, 0b101011010100, 2, 11],
            1976: [8, 0b010101101100, 1, 31], 1977: [0, 0b100101011010, 2, 18], 1978: [0, 0b101001011100, 2, 7],
            1979: [6, 0b110100101010, 1, 28], 1980: [0, 0b110101010100, 2, 16], 1981: [0, 0b110101101010, 2, 5],
            1982: [4, 0b010101101100, 1, 25], 1983: [0, 0b101010101110, 2, 13], 1984: [10, 0b100101001110, 2, 2],
            1985: [0, 0b110010100110, 2, 20], 1986: [0, 0b110101010010, 2, 9], 1987: [6, 0b110101101010, 1, 29],
            1988: [0, 0b010101101100, 2, 17], 1989: [0, 0b101010101110, 2, 6], 1990: [5, 0b010100101110, 1, 27],
            1991: [0, 0b101100100110, 2, 15], 1992: [0, 0b110101010010, 2, 4], 1993: [3, 0b110101101010, 1, 23],
            1994: [0, 0b010101011100, 2, 10], 1995: [8, 0b100101011010, 1, 31], 1996: [0, 0b110010011010, 2, 19],
            1997: [0, 0b110101001010, 2, 7], 1998: [5, 0b110110100100, 1, 28], 1999: [0, 0b101011010100, 2, 16],
            2000: [0, 0b101011011010, 2, 5], 2001: [4, 0b010101011100, 1, 24], 2002: [0, 0b101001011110, 2, 12],
            2003: [0, 0b101000101110, 2, 1], 2004: [2, 0b110100100110, 1, 22], 2005: [0, 0b110101010100, 2, 9],
            2006: [7, 0b101101010100, 1, 29], 2007: [0, 0b010101101100, 2, 18], 2008: [0, 0b100101101110, 2, 7],
            2009: [5, 0b010010101110, 1, 26], 2010: [0, 0b101001010110, 2, 14], 2011: [0, 0b110100101010, 2, 3],
            2012: [4, 0b110101010100, 1, 23], 2013: [0, 0b101101011010, 2, 10], 2014: [9, 0b010101011010, 1, 31],
            2015: [0, 0b100101011100, 2, 19], 2016: [0, 0b110010101100, 2, 8], 2017: [6, 0b101010010110, 1, 28],
            2018: [0, 0b110101001010, 2, 16], 2019: [0, 0b110110100100, 2, 5], 2020: [4, 0b101011010100, 1, 25],
            2021: [0, 0b101011011010, 2, 12], 2022: [0, 0b010101011100, 2, 1], 2023: [2, 0b100101011010, 1, 22],
            2024: [0, 0b110010011010, 2, 10], 2025: [6, 0b101010010110, 1, 29], 2026: [0, 0b110101001010, 2, 17],
            2027: [0, 0b110110100100, 2, 6], 2028: [5, 0b101011010010, 1, 26], 2029: [0, 0b101011101010, 2, 13],
            2030: [0, 0b010101101100, 2, 3]
        };

        const solarToLunar = (year, month, day) => {
            const yearData = LUNAR_YEAR_DATA[year];
            if (!yearData) return { lunarMonth: 0, lunarDay: 0, isApprox: true };
            const [leapMonth, monthInfo, newYearMonth, newYearDay] = yearData;
            const newYearDate = new Date(year, newYearMonth - 1, newYearDay);
            const targetDate = new Date(year, month - 1, day);
            let daysDiff = Math.floor((targetDate - newYearDate) / 86400000);
            if (daysDiff < 0) {
                const prevYearData = LUNAR_YEAR_DATA[year - 1];
                if (prevYearData) return { lunarMonth: 12, lunarDay: Math.max(1, 30 + daysDiff), isApprox: false };
                return { lunarMonth: 12, lunarDay: 15, isApprox: true };
            }
            let lunarMonth = 1, remainingDays = daysDiff;
            for (let m = 1; m <= 12; m++) {
                const isBigMonth = (monthInfo >> (12 - m)) & 1;
                const monthDays = isBigMonth ? 30 : 29;
                if (remainingDays < monthDays) { lunarMonth = m; break; }
                remainingDays -= monthDays;
                if (leapMonth > 0 && m === leapMonth) {
                    if (remainingDays < 29) { lunarMonth = m; break; }
                    remainingDays -= 29;
                }
                if (m === 12) lunarMonth = 12;
            }
            return { lunarMonth: Math.max(1, Math.min(12, lunarMonth)), lunarDay: Math.max(1, Math.min(30, remainingDays + 1)), isApprox: false };
        };

        const NUMBER_DATA = {
            1: { title: 'é ˜èˆªè€…', essence: 'ç¨ç«‹ã€é–‹å‰µã€é ˜å°', meridian: 'è…ç¶“ã€è†½ç¶“', emotionSpectrum: 'ææ‡¼ â†â†’ å‹‡æ°£', light: 'ç¨ç«‹é–‹å‰µã€æœ‰æ–¹å‘æ„Ÿã€æ•¢åšæ±ºå®šã€ä¸ç•å›°é›£', dark: 'å­¤ç¨ã€æ§åˆ¶ã€å®³æ€•å¤±æ•—ã€ä¸é¡˜æ±‚åŠ©', health: 'è…ã€è†€èƒ±ã€éª¨éª¼ã€è€³æœµ', oils: ['é›ªæ¾', 'å²©è˜­è‰', 'é»‘èƒ¡æ¤’'], soulLesson: 'å¾ã€Œæˆ‘è¦è­‰æ˜è‡ªå·±ã€åˆ°ã€Œæˆ‘æœ¬ä¾†å°±å¤ å¥½ã€', uniqueReading: '1è™Ÿäººæ˜¯å®‡å®™æ´¾ä¾†çš„å…ˆé‹’ï¼Œä½†æœ€å¤§çš„åŠŸèª²ä¸æ˜¯ã€Œæ›´ç¨ç«‹ã€ï¼Œè€Œæ˜¯ã€Œæ•¢æ–¼è„†å¼±ã€ã€‚ç•¶ä½ èƒ½èªªå‡ºã€Œæˆ‘éœ€è¦ä½ ã€ï¼Œæ‰æ˜¯çœŸæ­£çš„å¼·å¤§ã€‚', work: { type: 'é–‹å‰µè€…', desc: 'ã€Œè®“æˆ‘ä¾†å¸¶ã€', style: 'ç¨ç«‹æ±ºç­–ã€ä¸å–œæ­¡è¢«ç®¡ã€éœ€è¦è‡ªä¸»æ¬Š' }, intimacy: { type: 'å¾æœè€…', trait: 'ä¸»å°å‹ã€å–œæ­¡å¸¶é ˜ã€è¿½æ±‚éç¨‹æ¯”çµæœæ›´èˆˆå¥®', healthy: 'è‡ªä¿¡çš„è¡¨é”æ…¾æœ›ï¼Œèƒ½çµ¦äºˆä¹Ÿèƒ½æ¥å—', shadow: 'åªé¡§è‡ªå·±çš„æ»¿è¶³ï¼ŒæŠŠæ€§ç•¶æˆå¾æœ', tip: 'è®“ä»–æ„Ÿè¦ºè¢«éœ€è¦ï¼Œé©æ™‚è®“ä»–ä¸»å°' } },
            2: { title: 'èª¿å’Œè€…', essence: 'åˆä½œã€æ•æ„Ÿã€é€£çµ', meridian: 'å¿ƒç¶“ã€å¿ƒåŒ…ç¶“', emotionSpectrum: 'å­¤ç¨ â†â†’ é€£çµ', light: 'æ•æ„Ÿé«”è²¼ã€å–„æ–¼èª¿è§£ã€ç›´è¦ºå¼·ã€æ“…é•·å‚¾è½', dark: 'è¨å¥½ã€æ²’æœ‰ç•Œé™ã€å¤±å»è‡ªæˆ‘ã€è¢«å‹•æ”»æ“Š', health: 'å¿ƒã€å°è…¸ã€è¡€æ¶²å¾ªç’°', oils: ['ç«ç‘°', 'èŒ‰è‰', 'å¤©ç«ºè‘µ'], soulLesson: 'å¾ã€Œä½ é–‹å¿ƒæˆ‘å°±é–‹å¿ƒã€åˆ°ã€Œæˆ‘å€‘éƒ½å¯ä»¥é–‹å¿ƒã€', uniqueReading: '2è™Ÿäººèƒ½æ„Ÿå—åˆ°åˆ¥äººæ„Ÿå—ä¸åˆ°çš„æƒ…ç·’æš—æµï¼Œä½†æœ€å¤§çš„åŠŸèª²æ˜¯åˆ†æ¸…æ¥šã€Œå“ªäº›æ˜¯æˆ‘çš„æƒ…ç·’ï¼Œå“ªäº›æ˜¯åˆ¥äººçš„ã€ã€‚å­¸æœƒèªªã€Œä¸ã€ï¼Œä¸æœƒå¤±å»æ„›ã€‚', work: { type: 'å”èª¿è€…', desc: 'ã€Œè®“æˆ‘ä¾†é…åˆã€', style: 'é‡è¦–å’Œè«§ã€æ“…é•·åœ˜éšŠåˆä½œã€éœ€è¦è¢«èªå¯' }, intimacy: { type: 'é€£çµè€…', trait: 'é‡è¦–æƒ…æ„Ÿé€£çµã€éœ€è¦å‰æˆ²å’Œæ°›åœã€æ•æ„Ÿæ˜“å—å‚·', healthy: 'æ·±åº¦çš„èº«å¿ƒåˆä¸€é«”é©—ï¼Œæ¥µå¼·çš„æ„Ÿå—åŠ›', shadow: 'éåº¦è¨å¥½ï¼Œç”¨æ€§ä¾†æ›å–æ„›', tip: 'æƒ…æ„Ÿæ¯”æŠ€å·§é‡è¦ï¼Œäº‹å¾Œçš„æ“æŠ±è·Ÿéç¨‹ä¸€æ¨£é‡è¦' } },
            3: { title: 'å‰µé€ è€…', essence: 'å‰µæ„ã€è¡¨é”ã€æ¨‚è§€', meridian: 'è‚ç¶“ã€è†½ç¶“', emotionSpectrum: 'å£“æŠ‘ â†â†’ è¡¨é”', light: 'å‰µæ„ç„¡é™ã€è¡¨é”åŠ›å¼·ã€æœ‰æ„ŸæŸ“åŠ›ã€æ¨‚è§€é–‹æœ—', dark: 'è™é ­è›‡å°¾ã€è¡¨é¢è†šæ·ºã€é€ƒé¿æ·±å±¤å•é¡Œã€è‡ªæˆ‘æ‰¹è©•', health: 'è‚ã€è†½ã€çœ¼ç›ã€è‚Œè…±', oils: ['ä½›æ‰‹æŸ‘', 'ç”œæ©™', 'æª¸æª¬'], soulLesson: 'å¾ã€Œé–‹å§‹ä¸€ç™¾å€‹ã€åˆ°ã€Œå®Œæˆä¸€å€‹ã€', uniqueReading: '3è™Ÿäººæœ‰æ»¿è…¦å­çš„å¥½é»å­ï¼Œä½†æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œå®Œæˆã€ã€‚ä¸å®Œç¾çš„å®Œæˆï¼Œå‹éå®Œç¾çš„ç©ºæƒ³ã€‚åšå®Œå®ƒï¼Œç™¼å‡ºå»ï¼Œè®“ä¸–ç•Œçœ‹è¦‹ã€‚', work: { type: 'è¡¨é”è€…', desc: 'ã€Œè®“æˆ‘ä¾†èªªã€', style: 'å–œæ­¡è®ŠåŒ–ã€å‰µæ„ç™¼æƒ³ã€éœ€è¦è®šç¾å’Œèˆå°' }, intimacy: { type: 'è¡¨æ¼”è€…', trait: 'å–œæ­¡è®ŠåŒ–å’Œæ–°é®®æ„Ÿã€ç”¨è¨€èªèª¿æƒ…å¾ˆå²å®³ã€å–œæ­¡éŠæˆ²è§’è‰²æ‰®æ¼”', healthy: 'å……æ»¿å‰µæ„å’Œæ¨‚è¶£ï¼Œèƒ½è®“æ€§è®Šå¾—è¼•é¬†å¥½ç©', shadow: 'å¤ªåœ¨æ„è¡¨æ¼”ï¼Œç”¨æ€§ä¾†è­‰æ˜è‡ªå·±æœ‰é­…åŠ›', tip: 'ä¿æŒæ–°é®®æ„Ÿå¾ˆé‡è¦ï¼Œè®šç¾ä»–çš„å‰µæ„' } },
            4: { title: 'å»ºé€ è€…', essence: 'ç©©å®šã€å‹™å¯¦ã€å»ºè¨­', meridian: 'è‚ºç¶“ã€å¤§è…¸ç¶“', emotionSpectrum: 'åƒµåŒ– â†â†’ å½ˆæ€§', light: 'è…³è¸å¯¦åœ°ã€è² è²¬å¯é ã€çµ„ç¹”åŠ›å¼·ã€è€åŠ›é©šäºº', dark: 'å®³æ€•è®ŠåŒ–ã€æ”¾ä¸ä¸‹ã€å·¥ä½œç‹‚ã€å¤ªéåƒµåŒ–', health: 'è‚ºã€å¤§è…¸ã€çš®è†šã€éª¨éª¼', oils: ['å°¤åŠ åˆ©', 'çµ²æŸ', 'èŒ¶æ¨¹'], soulLesson: 'å¾ã€Œæ­»å®ˆä¸è®Šã€åˆ°ã€Œç©©ä¸­æ±‚è®Šã€', uniqueReading: '4è™Ÿäººè¢«ã€Œ4=æ­»ã€çš„è©›å’’å›°ä½å¤ªä¹…äº†ã€‚4ä¸æ˜¯æ­»äº¡ï¼Œæ˜¯é‡ç”Ÿã€‚èˆŠçš„ä¸å»ï¼Œæ–°çš„ä¸ä¾†ã€‚ä½ æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œå­¸æœƒå‘Šåˆ¥ã€ã€‚', work: { type: 'åŸ·è¡Œè€…', desc: 'ã€Œè®“æˆ‘ä¾†åšã€', style: 'æŒ‰éƒ¨å°±ç­ã€é‡è¦–æµç¨‹ã€éœ€è¦æ˜ç¢ºçš„çµæ§‹' }, intimacy: { type: 'ç©©å®šè€…', trait: 'å›ºå®šçš„ç¯€å¥å’Œæ¨¡å¼ã€é‡è¦–å®‰å…¨æ„Ÿå’Œä¿¡ä»»ã€éœ€è¦æ™‚é–“æš–æ©Ÿ', healthy: 'ç©©å®šã€æŒä¹…ã€å¯é ï¼Œæ·±åšçš„ä¿¡ä»»åŸºç¤', shadow: 'å¤ªåˆ¶å¼ï¼ŒæŠŠæ€§ç•¶æˆã€Œä¾‹è¡Œå…¬äº‹ã€', tip: 'ä¸è¦å¤ªå¤šé©šå–œï¼Œå»ºç«‹å›ºå®šçš„è¦ªå¯†å„€å¼' } },
            5: { title: 'è®Šé©è€…', essence: 'è‡ªç”±ã€è®ŠåŒ–ã€å†’éšª', meridian: 'èƒƒç¶“ã€è„¾ç¶“', emotionSpectrum: 'ç„¦æ…® â†â†’ è‡ªåœ¨', light: 'é©æ‡‰åŠ›å¼·ã€å–œæ­¡å†’éšªã€å¤šæ‰å¤šè—ã€ä¸æ€•æ”¹è®Š', dark: 'æ¼‚æ³Šä¸å®šã€ç„¡æ³•æ‰¿è«¾ã€éåº¦æ”¾ç¸±ã€ç„¦èºä¸å®‰', health: 'èƒƒã€è„¾ã€è‚Œè‚‰ã€æ¶ˆåŒ–ç³»çµ±', oils: ['è–‘', 'ç”œæ©™', 'è–„è·'], soulLesson: 'å¾ã€Œä¸€ç›´åœ¨é€ƒã€åˆ°ã€Œé¸æ“‡åœç•™ã€', uniqueReading: '5è™Ÿäººä»¥ç‚ºè‡ªç”±æ˜¯ã€Œä¸è¢«ç¶ä½ã€ï¼Œä½†çœŸæ­£çš„è‡ªç”±æ˜¯ã€Œé¸æ“‡ç•™ä¸‹ä¾†ã€ã€‚ç•¶ä½ èƒ½åœ¨ä¸€å€‹åœ°æ–¹æ·±è€•ï¼Œæ‰æœƒç™¼ç¾æœ€å¤§çš„å†’éšªåœ¨å…§å¿ƒã€‚', work: { type: 'å†’éšªè€…', desc: 'ã€Œè®“æˆ‘ä¾†è©¦ã€', style: 'å–œæ­¡è®ŠåŒ–ã€ä¸æ€•æŒ‘æˆ°ã€è¨å­è¢«æŸç¸›' }, intimacy: { type: 'å†’éšªè€…', trait: 'å–œæ­¡å†’éšªå’Œå˜—è©¦ã€å®¹æ˜“å­å€¦é‡è¤‡ã€è¿½æ±‚åˆºæ¿€å’Œè‡ªç”±', healthy: 'é–‹æ”¾ã€å¥½å¥‡ã€æœ‰å¯¦é©—ç²¾ç¥', shadow: 'ç”¨æ€§ä¾†é€ƒé¿æ‰¿è«¾ï¼Œæˆç™®å‚¾å‘', tip: 'ä¿æŒè®ŠåŒ–å’Œé©šå–œï¼Œä¸€èµ·æ¢ç´¢æ–°äº‹ç‰©' } },
            6: { title: 'ç…§é¡§è€…', essence: 'è²¬ä»»ã€æ„›ã€æœå‹™', meridian: 'è„¾ç¶“ã€å¿ƒç¶“', emotionSpectrum: 'æ§åˆ¶ â†â†’ ä¿¡ä»»', light: 'æœ‰æ„›å¿ƒã€è² è²¬ä»»ã€ç…§é¡§ä»–äººã€å‰µé€ å’Œè«§', dark: 'éåº¦ä»˜å‡ºã€æ§åˆ¶ã€çŠ§ç‰²è‡ªå·±ã€ç„¡æ³•æ¥å—å¹«åŠ©', health: 'å¿ƒè‡Ÿã€è„¾èƒƒã€ä¹³æˆ¿ã€å­å®®', oils: ['ç«ç‘°', 'ä¾è˜­', 'å¤©ç«ºè‘µ'], soulLesson: 'å¾ã€Œç…§é¡§æ‰€æœ‰äººã€åˆ°ã€Œä¹Ÿç…§é¡§è‡ªå·±ã€', uniqueReading: '6è™Ÿäººå¾ˆæœƒæ„›åˆ¥äººï¼Œå»å¾ˆé›£æ¥å—åˆ¥äººçš„æ„›ã€‚ä½ æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œè®“åˆ¥äººä¹Ÿç…§é¡§ä½ ã€ã€‚æ¥å—å¹«åŠ©ï¼Œä¸æ˜¯è»Ÿå¼±ï¼Œæ˜¯ä¿¡ä»»ã€‚', work: { type: 'ç…§é¡§è€…', desc: 'ã€Œè®“æˆ‘ä¾†é¡§ã€', style: 'é‡è¦–åœ˜éšŠå’Œè«§ã€æ¨‚æ–¼åŠ©äººã€éœ€è¦è¢«éœ€è¦' }, intimacy: { type: 'ç…§é¡§è€…', trait: 'é‡è¦–çµ¦äºˆå°æ–¹æ„‰æ‚…ã€å–œæ­¡ç…§é¡§å’Œè¢«éœ€è¦ã€é‡è¦–ç’°å¢ƒå’Œæ°›åœ', healthy: 'æº«æš–ã€é«”è²¼ã€ç´°è†©ï¼Œèƒ½è®“å°æ–¹æ„Ÿè¦ºè¢«æ„›', shadow: 'åªé¡§å°æ–¹ï¼Œç„¡æ³•äº«å—è‡ªå·±çš„æ„‰æ‚…', tip: 'ä¸»å‹•ç…§é¡§ä»–ï¼Œå‘Šè¨´ä»–ï¼šã€Œä½ çš„æ„‰æ‚…å°æˆ‘å¾ˆé‡è¦ã€' } },
            7: { title: 'æ¢ç´¢è€…', essence: 'å…§çœã€æ™ºæ…§ã€éˆæ€§', meridian: 'å¿ƒç¶“ã€è…ç¶“', emotionSpectrum: 'æ‡·ç–‘ â†â†’ ä¿¡ä»»', light: 'æ™ºæ…§æ·±åˆ»ã€ç›´è¦ºæ•éŠ³ã€å–„æ–¼åˆ†æã€éˆæ€§è¦ºé†’', dark: 'éåº¦æ‡·ç–‘ã€å­¤åƒ»ã€ä¸ä¿¡ä»»ã€å†·æ¼ ç–é›¢', health: 'å¿ƒã€è…ã€ç¥ç¶“ç³»çµ±ã€è…¦éƒ¨', oils: ['ä¹³é¦™', 'æª€é¦™', 'è–°è¡£è‰'], soulLesson: 'å¾ã€Œä¸æ–·åˆ†æã€åˆ°ã€Œå…è¨±ä¸çŸ¥é“ã€', uniqueReading: '7è™Ÿäººç”¨æ€è€ƒä¾†ä¿è­·è‡ªå·±ï¼Œä½†æœ‰äº›äº‹æ˜¯æƒ³ä¸é€šçš„ã€‚ä½ æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œå­¸æœƒä¿¡ä»»ã€â€”â€”ä¿¡ä»»ç›´è¦ºã€ä¿¡ä»»ä»–äººã€ä¿¡ä»»ç”Ÿå‘½ã€‚', work: { type: 'åˆ†æè€…', desc: 'ã€Œè®“æˆ‘ä¾†æƒ³ã€', style: 'ç¨ç«‹æ€è€ƒã€éœ€è¦ç¨è™•ç©ºé–“ã€ä¸å–œæ­¡è¢«æ‰“æ“¾' }, intimacy: { type: 'æ¢ç´¢è€…', trait: 'éœ€è¦å¿ƒéˆé€£çµæ‰èƒ½èº«é«”é€£çµã€å¯èƒ½å°èº«é«”ç–é›¢ã€å–œæ­¡ç ”ç©¶å’Œæ¢ç´¢', healthy: 'èº«å¿ƒéˆåˆä¸€çš„æ·±åº¦é«”é©—', shadow: 'å¤ªåœ¨è…¦è¢‹è£¡ï¼Œèº«é«”ä¸åœ¨', tip: 'å¿ƒéˆé€£çµæ˜¯å‰æï¼Œçµ¦ä»–æ™‚é–“ã€Œå›åˆ°èº«é«”ã€' } },
            8: { title: 'æŒæ¬Šè€…', essence: 'æ¬ŠåŠ›ã€è±ç››ã€å½±éŸ¿åŠ›', meridian: 'å°è…¸ç¶“ã€è†€èƒ±ç¶“', emotionSpectrum: 'è²ªå©ª â†â†’ æ…·æ…¨', light: 'é ˜å°åŠ›å¼·ã€æœ‰å•†æ¥­é ­è…¦ã€èƒ½èšé›†è³‡æºã€æœ‰å½±éŸ¿åŠ›', dark: 'æ§åˆ¶ã€è²ªå©ªã€å·¥ä½œç‹‚ã€ç‚ºé”ç›®çš„ä¸æ“‡æ‰‹æ®µ', health: 'å¾ªç’°ç³»çµ±ã€é—œç¯€ã€éª¨éª¼ã€è‚Œè‚‰', oils: ['æ²’è—¥', 'æª€é¦™', 'é›ªæ¾'], soulLesson: 'å¾ã€Œæ“æœ‰æ›´å¤šã€åˆ°ã€Œåˆ†äº«æ›´å¤šã€', uniqueReading: '8è™Ÿäººæœ‰èšé›†è³‡æºçš„å¤©è³¦ï¼Œä½†æ¬ŠåŠ›æ˜¯æ‹¿ä¾†æœå‹™çš„ã€‚ä½ æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œç”¨å½±éŸ¿åŠ›å¹«åŠ©åˆ¥äººã€ï¼Œè€Œä¸æ˜¯ã€Œç”¨å½±éŸ¿åŠ›æ§åˆ¶åˆ¥äººã€ã€‚', work: { type: 'æŒæ§è€…', desc: 'ã€Œè®“æˆ‘ä¾†ç®¡ã€', style: 'ç›®æ¨™å°å‘ã€é‡è¦–çµæœã€éœ€è¦æŒæ§æ„Ÿ' }, intimacy: { type: 'æŒæ§è€…', trait: 'å¼·çƒˆçš„èƒ½é‡å’Œè€åŠ›ã€å–œæ­¡æŒæ§æˆ–è¢«å¾¹åº•æŒæ§ã€è¿½æ±‚æ¥µè‡´é«”é©—', healthy: 'å¼·å¤§çš„æ€§èƒ½é‡ï¼Œèƒ½çµ¦äºˆå¼·çƒˆçš„é«”é©—', shadow: 'ç”¨æ€§ä¾†å±•ç¾æ¬ŠåŠ›ï¼Œæ§åˆ¶æ…¾éå¼·', tip: 'å¯ä»¥é©åº¦è®“ä»–æŒæ§ï¼Œå¼·åº¦è¦å¤ ' } },
            9: { title: 'æ™ºè€…', essence: 'æ…ˆæ‚²ã€æ™ºæ…§ã€å®Œæˆ', meridian: 'ä¸‰ç„¦ç¶“ã€å¿ƒåŒ…ç¶“', emotionSpectrum: 'åŸ·è‘— â†â†’ æ”¾ä¸‹', light: 'æ…ˆæ‚²å¤§æ„›ã€æ™ºæ…§æ·±é ã€æœå‹™äººé¡ã€æœ‰å¤§æ ¼å±€', dark: 'éåº¦ç†æƒ³åŒ–ã€èˆ‡ç¾å¯¦è„«ç¯€ã€æ®‰é“è€…æƒ…çµã€ç„¡æ³•æ¥åœ°', health: 'ä¸‰ç„¦ã€å…ç–«ç³»çµ±ã€æ•´é«”å¹³è¡¡', oils: ['ä¹³é¦™', 'èŠ±æ¢¨æœ¨', 'å»£è—¿é¦™'], soulLesson: 'å¾ã€Œæ‹¯æ•‘ä¸–ç•Œã€åˆ°ã€Œå…ˆç…§é¡§å¥½è‡ªå·±ã€', uniqueReading: '9è™Ÿäººå¤©ç”Ÿæœ‰å¤§æ„›ï¼Œä½†æœ€å¤§çš„åŠŸèª²æ˜¯ã€Œè½åœ°ã€ã€‚ä½ ä¸éœ€è¦æ‹¯æ•‘æ‰€æœ‰äººï¼Œå…ˆæŠŠè‡ªå·±çš„ç”Ÿæ´»éå¥½ã€‚æ¥åœ°çš„ç†æƒ³ï¼Œæ‰æœ‰åŠ›é‡ã€‚', work: { type: 'æœå‹™è€…', desc: 'ã€Œè®“æˆ‘ä¾†å¹«ã€', style: 'é‡è¦–æ„ç¾©ã€é¡˜æ™¯å°å‘ã€éœ€è¦é€£çµæ›´å¤§çš„ç›®æ¨™' }, intimacy: { type: 'å¥‰ç»è€…', trait: 'è¿½æ±‚èº«å¿ƒéˆåˆä¸€ã€å¯èƒ½è¦ºå¾—ã€Œæ€§å¤ªä½å±¤æ¬¡ã€ã€é‡è¦–æ„ç¾©å’Œé€£çµ', healthy: 'ç„¡æ¢ä»¶çš„æ„›èˆ‡æ¥ç´ï¼Œè¶…è¶Šè‚‰é«”çš„é€£çµ', shadow: 'é€ƒé¿èº«é«”ï¼Œåªæ´»åœ¨ç²¾ç¥å±¤é¢', tip: 'é€£çµåˆ°æ›´å¤§çš„æ„ç¾©ï¼Œå¹«åŠ©ä»–å›åˆ°èº«é«”' } },
            11: { title: 'éˆæ€§ç›´è¦ºè€…', essence: 'ç›´è¦ºã€éˆæ€§ã€å•Ÿç™¼', meridian: 'å¿ƒåŒ…ç¶“', emotionSpectrum: 'å°é–‰ â†â†’ é–‹æ”¾', light: 'æ¥µå¼·ç›´è¦ºåŠ›ã€éˆæ€§é€šé“ã€å¤©ç”Ÿç™‚ç™’è€…å’Œå¼•å°è€…', dark: 'éåº¦æ•æ„Ÿã€ç„¦æ…®ä¸å®‰ã€ç¥ç¶“è³ªã€èˆ‡ç¾å¯¦è„«ç¯€', health: 'ç¥ç¶“ç³»çµ±ã€å¿ƒåŒ…ã€æƒ…ç·’ç©©å®š', oils: ['ä¹³é¦™', 'æª€é¦™', 'è–°è¡£è‰', 'æ©™èŠ±'], soulLesson: 'æŠŠéˆæ€§è¨Šæ¯è½‰åŒ–ç‚ºå¯¦éš›è¡Œå‹•', uniqueReading: '11æ˜¯ã€ŒåŠ å¼·ç‰ˆçš„2ã€ï¼ŒåŒæ™‚æ“æœ‰1çš„ç¨ç«‹å’Œ2çš„æ•æ„Ÿã€‚ä½ èƒ½æ¥æ”¶åˆ°åˆ¥äººæ¥æ”¶ä¸åˆ°çš„è¨Šæ¯ï¼Œä½†ä¹Ÿå®¹æ˜“è¢«é€™äº›è¨Šæ¯æ·¹æ²’ã€‚', isMaster: true, masterMission: 'æˆç‚ºéˆæ€§èˆ‡ç¾å¯¦çš„æ©‹æ¨‘', work: { type: 'å•Ÿç™¼è€…', desc: 'ã€Œè®“æˆ‘ä¾†æ„Ÿæ‡‰ã€', style: 'ç›´è¦ºæ±ºç­–ã€éœ€è¦éˆæ„Ÿç©ºé–“ã€é©åˆé¡§å•è«®è©¢' }, intimacy: { type: 'éˆæ€§é€£çµè€…', trait: 'éœ€è¦æ·±åº¦éˆæ€§é€£çµã€æ¥µåº¦æ•æ„Ÿã€èƒ½æ„Ÿæ‡‰å°æ–¹çš„æƒ…ç·’', healthy: 'èº«å¿ƒéˆå®Œå…¨åˆä¸€çš„ç¥è–é«”é©—', shadow: 'å¤ªæ•æ„Ÿè€Œç„¡æ³•æ”¾é¬†äº«å—', tip: 'å‰µé€ ç¥è–çš„ç©ºé–“å’Œæ°›åœ' } },
            22: { title: 'å¤§å¸«å»ºé€ è€…', essence: 'é¡˜æ™¯ã€å»ºè¨­ã€å¯¦ç¾', meridian: 'å…¨ç¶“çµ¡æ•´åˆ', emotionSpectrum: 'å£“åŠ› â†â†’ æˆå°±', light: 'æŠŠå¤¢æƒ³è½åœ°ã€å»ºç«‹å¤§å‹ç³»çµ±ã€æœ‰é è¦‹ä¹Ÿæœ‰åŸ·è¡ŒåŠ›', dark: 'éåº¦å·¥ä½œã€å£“åŠ›æ¥µå¤§ã€å¿½ç•¥æƒ…æ„Ÿã€æ§åˆ¶éåº¦', health: 'å…¨èº«ç³»çµ±å¹³è¡¡ã€ç‰¹åˆ¥æ³¨æ„éå‹', oils: ['é›ªæ¾', 'æª€é¦™', 'æ²’è—¥', 'å²©è˜­è‰'], soulLesson: 'ä¸åªå»ºé€ ç‰©è³ªä¸–ç•Œï¼Œä¹Ÿè¦å»ºé€ éˆæ€§çš„æ©‹æ¨‘', uniqueReading: '22æ˜¯ã€ŒåŠ å¼·ç‰ˆçš„4ã€ï¼Œæœ‰æŠŠé¡˜æ™¯è½åœ°çš„è¶…å¼·èƒ½åŠ›ã€‚æœ€å‰å¤§çš„å»ºç¯‰ï¼Œæ˜¯è®“æ‰€æœ‰äººéƒ½èƒ½é€²å…¥çš„ã€‚', isMaster: true, masterMission: 'å»ºé€ æœå‹™çœ¾ç”Ÿçš„ç³»çµ±', work: { type: 'ç³»çµ±å»ºé€ è€…', desc: 'ã€Œè®“æˆ‘ä¾†å»ºæ§‹ã€', style: 'é•·é è¦åŠƒã€ç³»çµ±æ€ç¶­' }, intimacy: { type: 'æ·±åº¦å»ºé€ è€…', trait: 'è¿½æ±‚é•·æœŸç©©å®šã€æ·±åº¦æ‰¿è«¾', healthy: 'å»ºç«‹æ·±åšçš„è¦ªå¯†åŸºç¤', shadow: 'å¤ªå°ˆæ³¨äº‹æ¥­å¿½ç•¥è¦ªå¯†', tip: 'è¦ªå¯†é—œä¿‚ä¹Ÿæ˜¯é‡è¦çš„äººç”Ÿå»ºè¨­' } },
            33: { title: 'å¤§å¸«ç™‚ç™’è€…', essence: 'ç™‚ç™’ã€æ…ˆæ‚²ã€æœå‹™', meridian: 'å…¨ç¶“çµ¡æ•´åˆ', emotionSpectrum: 'çŠ§ç‰² â†â†’ æœå‹™', light: 'ç„¡æ¢ä»¶çš„æ„›ã€ç™‚ç™’ä»–äººæ·±å±¤å‰µå‚·ã€å¤©ç”Ÿå°å¸«', dark: 'çŠ§ç‰²éåº¦ã€ç„¡æ³•è¨­é™ã€ç‡ƒç‡’è‡ªå·±ã€å¤±å»è‡ªæˆ‘', health: 'å…¨èº«ç³»çµ±å¹³è¡¡ã€ç‰¹åˆ¥æ³¨æ„èƒ½é‡è€—ç«­', oils: ['ç«ç‘°', 'ä¹³é¦™', 'èŠ±æ¢¨æœ¨', 'æ©™èŠ±'], soulLesson: 'åœ¨æœå‹™ä»–äººçš„åŒæ™‚ï¼Œä¹Ÿè¦ç…§é¡§å¥½è‡ªå·±', uniqueReading: '33æ˜¯ã€ŒåŠ å¼·ç‰ˆçš„6ã€ï¼Œæ˜¯æœ€é«˜å±¤æ¬¡çš„ç™‚ç™’å’Œæœå‹™ã€‚å…ˆæŠŠè‡ªå·±çš„æ¯å­è£æ»¿ï¼Œæ‰èƒ½æŒçºŒçµ¦äºˆã€‚', isMaster: true, masterMission: 'æˆç‚ºç„¡æ¢ä»¶ä¹‹æ„›çš„ç®¡é“', work: { type: 'ç™‚ç™’å°å¸«', desc: 'ã€Œè®“æˆ‘ä¾†ç™‚ç™’ã€', style: 'æœå‹™å°å‘ã€éœ€è¦æ„ç¾©æ„Ÿ' }, intimacy: { type: 'ç™‚ç™’è€…', trait: 'çµ¦äºˆç„¡æ¢ä»¶çš„æ„›å’Œæ¥ç´', healthy: 'è®“å°æ–¹æ„Ÿå—åˆ°è¢«å®Œå…¨æ¥ç´', shadow: 'åªä»˜å‡ºä¸æ¥å—', tip: 'å…è¨±è‡ªå·±ä¹Ÿè¢«æ„›' } }
        };
        const getNumData = (num) => NUMBER_DATA[num] || NUMBER_DATA[reduceToSingle(num)] || NUMBER_DATA[1];

        const PALACE_DATA = {
            1: { name: 'å‹‡æ°£æ®¿', meridian: 'è†½ç¶“', time: '23:00-01:00', theme: 'æˆ‘æ•¢ä¸æ•¢åšè‡ªå·±ï¼Ÿ', darkEmotion: 'ææ‡¼ã€çŒ¶è±«ã€ä¸æ•¢è¡Œå‹•', lightEmotion: 'å‹‡æ°£ã€æ±ºæ–·ã€æ•¢æ–¼åšè‡ªå·±', stuckPattern: ['ç¸½æ˜¯åœ¨ç­‰ã€Œæº–å‚™å¥½ã€æ‰è¡Œå‹•', 'å®³æ€•åšéŒ¯æ±ºå®š'], soulQuestions: ['å¦‚æœä¸æ€•å¤±æ•—ï¼Œä½ æœƒåšä»€éº¼ï¼Ÿ'], oils: ['è–‘', 'é»‘èƒ¡æ¤’', 'æœæ¾æ¼¿æœ'] },
            2: { name: 'åŠ›é‡å»³', meridian: 'è‚ç¶“', time: '01:00-03:00', theme: 'æˆ‘çš„åŠ›é‡å¡åœ¨å“ªï¼Ÿ', darkEmotion: 'æ†¤æ€’ã€å£“æŠ‘ã€ç„¡åŠ›æ„Ÿ', lightEmotion: 'å‰µé€ åŠ›ã€ç”Ÿå‘½åŠ›ã€å‰é€²å‹•åŠ›', stuckPattern: ['è«åå…¶å¦™å°±ç”Ÿæ°£æˆ–ç…©èº', 'è¦ºå¾—è‡ªå·±çš„åŠ›é‡è¢«å£“åˆ¶'], soulQuestions: ['ä½ çš„æ†¤æ€’åœ¨å‘Šè¨´ä½ ä»€éº¼ï¼Ÿ'], oils: ['ä½›æ‰‹æŸ‘', 'è–„è·', 'ç¾…é¦¬æ´‹ç”˜èŠ'] },
            3: { name: 'å‘Šåˆ¥è‹‘', meridian: 'è‚ºç¶“', time: '03:00-05:00', theme: 'æˆ‘æ”¾ä¸ä¸‹ä»€éº¼ï¼Ÿ', darkEmotion: 'æ‚²å‚·ã€å“€æ‚¼ã€ç„¡æ³•æ”¾ä¸‹', lightEmotion: 'æ¥å—ã€å‘Šåˆ¥ã€é‡‹ç„¶', stuckPattern: ['åè¦†å›æƒ³éå»çš„äº‹', 'ç„¡æ³•å¥½å¥½èªªå†è¦‹'], soulQuestions: ['ä½ é‚„æ²’æœ‰å‘Šåˆ¥çš„æ˜¯ä»€éº¼ï¼Ÿ'], oils: ['çµ²æŸ', 'ä¹³é¦™', 'å°¤åŠ åˆ©'] },
            4: { name: 'æ·¨åŒ–å®¤', meridian: 'å¤§è…¸ç¶“', time: '05:00-07:00', theme: 'æˆ‘è©²ä¸Ÿæ‰ä»€éº¼ï¼Ÿ', darkEmotion: 'åŸ·è‘—ã€å›¤ç©ã€é»è†©', lightEmotion: 'æ·¨åŒ–ã€é‡‹æ”¾ã€æ¸…çˆ½', stuckPattern: ['å®¶è£¡å †æ»¿ç”¨ä¸åˆ°çš„æ±è¥¿', 'ç„¡æ³•çµæŸä¸é©åˆçš„é—œä¿‚'], soulQuestions: ['ä½ çš„äººç”Ÿæœ‰ä»€éº¼ã€Œå»¢ç‰©ã€éœ€è¦æ¸…ç†ï¼Ÿ'], oils: ['æª¸æª¬', 'è‘¡è„æŸš', 'èŒ¶æ¨¹'] },
            5: { name: 'æ¶ˆåŒ–é–£', meridian: 'èƒƒç¶“', time: '07:00-09:00', theme: 'æˆ‘æ¶ˆåŒ–ä¸äº†ä»€éº¼ï¼Ÿ', darkEmotion: 'ç„¦æ…®ã€æ“”æ†‚ã€ç„¡æ³•æ¥å—', lightEmotion: 'æ¥ç´ã€æ¶ˆåŒ–ã€è½‰åŒ–', stuckPattern: ['å°æœªä¾†å……æ»¿ç„¦æ…®', 'èƒƒéƒ¨ç¶“å¸¸ä¸èˆ’æœ'], soulQuestions: ['ä»€éº¼äº‹æƒ…è®“ä½ ã€Œåš¥ä¸ä¸‹å»ã€ï¼Ÿ'], oils: ['ç”œæ©™', 'è–‘', 'è±†è”»'] },
            6: { name: 'ä¿¡ä»»æ®¿', meridian: 'è„¾ç¶“', time: '09:00-11:00', theme: 'æˆ‘æƒ³å¤ªå¤šä»€éº¼ï¼Ÿ', darkEmotion: 'éåº¦æ€æ…®ã€æ“”æ†‚ã€æ§åˆ¶', lightEmotion: 'ä¿¡ä»»ã€è‡£æœã€äº¤è¨—', stuckPattern: ['ä»€éº¼äº‹éƒ½è¦æƒ³ä¸‰é', 'å¾ˆé›£ä¿¡ä»»åˆ¥äºº'], soulQuestions: ['ä½ ä¸ä¿¡ä»»çš„æ˜¯ä»€éº¼ï¼Ÿ'], oils: ['æª€é¦™', 'å²©è˜­è‰', 'å¿«æ¨‚é¼ å°¾è‰'] },
            7: { name: 'å¿ƒé–€å®®', meridian: 'å¿ƒç¶“', time: '11:00-13:00', theme: 'æˆ‘æ¸´æœ›ä»€éº¼æ„›ï¼Ÿ', darkEmotion: 'å­¤ç¨ã€éš”é›¢ã€å¿ƒç‰†', lightEmotion: 'é€£çµã€å–œæ‚…ã€æ•é–‹', stuckPattern: ['è¦ºå¾—æ²’æœ‰äººçœŸæ­£æ‡‚è‡ªå·±', 'æ¸´æœ›æ„›å»å®³æ€•å—å‚·'], soulQuestions: ['ä½ çš„å¿ƒç‰†åœ¨ä¿è­·ä»€éº¼ï¼Ÿ'], oils: ['ç«ç‘°', 'èŒ‰è‰', 'ä¾è˜­ä¾è˜­'] },
            8: { name: 'æ˜è¾¨å»³', meridian: 'å°è…¸ç¶“', time: '13:00-15:00', theme: 'æˆ‘åˆ†ä¸æ¸…ä»€éº¼ï¼Ÿ', darkEmotion: 'æ··äº‚ã€å›°æƒ‘ã€ç„¡æ³•åˆ¤æ–·', lightEmotion: 'æ˜è¾¨ã€æ¸…æ™°ã€æ™ºæ…§', stuckPattern: ['å¸¸å¸¸åœ¨é¸æ“‡ä¸­ç³¾çµ', 'åˆ†ä¸æ¸…èª°æ˜¯çœŸæœ‹å‹'], soulQuestions: ['ä½ å…§å¿ƒçš„è²éŸ³åœ¨èªªä»€éº¼ï¼Ÿ'], oils: ['è¿·è¿­é¦™', 'ç¾…å‹’', 'è–„è·'] },
            9: { name: 'å¸è¼‰è‹‘', meridian: 'è†€èƒ±ç¶“', time: '15:00-17:00', theme: 'æˆ‘æ‰›è‘—ä»€éº¼ï¼Ÿ', darkEmotion: 'å£“åŠ›ã€ç·Šç¹ƒã€æ‰¿æ“”éåº¦', lightEmotion: 'é‡‹æ”¾ã€è¼•é¬†ã€æµå‹•', stuckPattern: ['èƒŒéƒ¨å’Œè‚©é ¸ç¸½æ˜¯å¾ˆç·Š', 'è¦ºå¾—è‡ªå·±è¦æ‰›æ‰€æœ‰çš„äº‹'], soulQuestions: ['ä½ èƒŒä¸Šæ‰›çš„æ˜¯èª°çš„è²¬ä»»ï¼Ÿ'], oils: ['è–°è¡£è‰', 'ç”œé¦¬é¬±è˜­', 'è‹¦æ©™è‘‰'] },
            10: { name: 'å¿—æ°£æ®¿', meridian: 'è…ç¶“', time: '17:00-19:00', theme: 'æˆ‘å®³æ€•ä»€éº¼ï¼Ÿ', darkEmotion: 'ææ‡¼ã€ç„¡åŠ›ã€è¿·å¤±æ–¹å‘', lightEmotion: 'å¿—æ°£ã€æ–¹å‘ã€ç”Ÿå‘½åŠ›', stuckPattern: ['ä¸çŸ¥é“äººç”Ÿè¦å¾€å“ªè£¡å»', 'å®³æ€•å¤±æ•—æ‰€ä»¥ä¸æ•¢é–‹å§‹'], soulQuestions: ['å¦‚æœä¸å®³æ€•ï¼Œä½ æƒ³æˆç‚ºä»€éº¼ï¼Ÿ'], oils: ['é›ªæ¾', 'æª€é¦™', 'æ²’è—¥'] },
            11: { name: 'æ•é–‹é–£', meridian: 'å¿ƒåŒ…ç¶“', time: '19:00-21:00', theme: 'æˆ‘åœ¨ä¿è­·ä»€éº¼ï¼Ÿ', darkEmotion: 'å°é–‰ã€é˜²ç¦¦ã€å­¤ç«‹', lightEmotion: 'é–‹æ”¾ã€çœŸå¯¦ã€è¦ªå¯†', stuckPattern: ['è¡¨é¢é–‹æœ—ä½†å…¶å¯¦ä¸è®“äººé è¿‘', 'å®³æ€•çœŸæ­£çš„è¦ªå¯†'], soulQuestions: ['ä½ å®³æ€•è¢«çœ‹è¦‹ä»€éº¼ï¼Ÿ'], oils: ['ç«ç‘°è‰', 'æ©™èŠ±', 'å»£è—¿é¦™'] },
            12: { name: 'å¹³è¡¡å®¤', meridian: 'ä¸‰ç„¦ç¶“', time: '21:00-23:00', theme: 'æˆ‘å“ªè£¡ä¸å¹³è¡¡ï¼Ÿ', darkEmotion: 'å¤±è¡¡ã€åˆ†è£‚ã€ä¸å”èª¿', lightEmotion: 'æ•´åˆã€å¹³è¡¡ã€å’Œè«§', stuckPattern: ['ç”Ÿæ´»å„æ–¹é¢åš´é‡ä¸å¹³è¡¡', 'èº«å¿ƒéˆåˆ†é›¢çš„æ„Ÿè¦º'], soulQuestions: ['ä½ çš„ç”Ÿæ´»å“ªè£¡å¤±è¡¡äº†ï¼Ÿ'], oils: ['å¤©ç«ºè‘µ', 'ä¹³é¦™', 'èŠ±æ¢¨æœ¨'] }
        };

        const YEAR_THEMES = {
            1: { keyword: 'æ–°é–‹å§‹', theme: 'ç¨®å­èŒèŠ½', advice: 'å•Ÿå‹•æ–°è¨ˆç•«ã€å‹‡æ•¢åšæ±ºå®š', palace: '1å®®ï¼ˆå‹‡æ°£æ®¿ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æ•¢ä¸æ•¢åšè‡ªå·±ï¼Ÿã€' },
            2: { keyword: 'ç­‰å¾…', theme: 'è€å¿ƒè€•è€˜', advice: 'å»ºç«‹åˆä½œã€ç­‰å¾…æ™‚æ©Ÿ', palace: '2å®®ï¼ˆåŠ›é‡å»³ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ çš„åŠ›é‡å¡åœ¨å“ªï¼Ÿã€' },
            3: { keyword: 'è¡¨é”', theme: 'å‰µæ„ç¶»æ”¾', advice: 'è‡ªæˆ‘è¡¨é”ã€ç¤¾äº¤æ‹“å±•', palace: '3å®®ï¼ˆå‘Šåˆ¥è‹‘ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æ”¾ä¸ä¸‹ä»€éº¼ï¼Ÿã€' },
            4: { keyword: 'å»ºè¨­', theme: 'ç©©å›ºåŸºç¤', advice: 'æ‰“åœ°åŸºã€å»ºç«‹çµæ§‹', palace: '4å®®ï¼ˆæ·¨åŒ–å®¤ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ è©²ä¸Ÿæ‰ä»€éº¼ï¼Ÿã€' },
            5: { keyword: 'è®ŠåŒ–', theme: 'è½‰å‹çªç ´', advice: 'æ“æŠ±æ”¹è®Šã€å‹‡æ–¼å†’éšª', palace: '5å®®ï¼ˆæ¶ˆåŒ–é–£ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æ¶ˆåŒ–ä¸äº†ä»€éº¼ï¼Ÿã€' },
            6: { keyword: 'è²¬ä»»', theme: 'ç…§é¡§æ”¶æˆ', advice: 'å®¶åº­è²¬ä»»ã€æ”¶ç©«ä»˜å‡º', palace: '6å®®ï¼ˆä¿¡ä»»æ®¿ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æƒ³å¤ªå¤šä»€éº¼ï¼Ÿã€' },
            7: { keyword: 'æ²‰æ¾±', theme: 'å…§åœ¨æ¢ç´¢', advice: 'åæ€å­¸ç¿’ã€ç¨è™•å……é›»', palace: '7å®®ï¼ˆå¿ƒé–€å®®ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æ¸´æœ›ä»€éº¼æ„›ï¼Ÿã€' },
            8: { keyword: 'æ”¶ç©«', theme: 'è±ç››æˆå°±', advice: 'äº‹æ¥­æˆåŠŸã€è²¡å‹™è±æ”¶', palace: '8å®®ï¼ˆæ˜è¾¨å»³ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ åˆ†ä¸æ¸…ä»€éº¼ï¼Ÿã€' },
            9: { keyword: 'çµæŸ', theme: 'å®Œæˆé‡‹æ”¾', advice: 'æ”¾ä¸‹èˆŠæœ‰ã€æº–å‚™æ–°å¾ªç’°', palace: '9å®®ï¼ˆå¸è¼‰è‹‘ï¼‰', focus: 'é€™ä¸€å¹´å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ æ‰›è‘—ä»€éº¼ï¼Ÿã€' },
            11: { keyword: 'éˆæ€§è¦ºé†’', theme: 'ç›´è¦ºé–‹å•Ÿ', advice: 'ä¿¡ä»»ç›´è¦ºã€éˆæ€§æˆé•·', palace: '11å®®ï¼ˆæ•é–‹é–£ï¼‰', focus: 'å®‡å®™åœ¨å•ä½ ï¼šã€Œä½ åœ¨ä¿è­·ä»€éº¼ï¼Ÿã€' },
            22: { keyword: 'å¤§å¸«å»ºé€ ', theme: 'é¡˜æ™¯è½åœ°', advice: 'å»ºç«‹é•·é ç³»çµ±', palace: 'å…¨å®®ä½', focus: 'å»ºé€ æœå‹™çœ¾ç”Ÿçš„æ©‹æ¨‘' },
            33: { keyword: 'å¤§å¸«ç™‚ç™’', theme: 'ç„¡æ¢ä»¶çš„æ„›', advice: 'ç™‚ç™’è‡ªå·±èˆ‡ä»–äºº', palace: 'å…¨å®®ä½', focus: 'æˆç‚ºæ„›çš„ç®¡é“' }
        };

        const FORTUNE_THEMES = {
            1: { age: '1-10æ­²', name: 'ç«¥å¹´å°è¨˜', desc: 'ç”Ÿå‘½çš„ç¬¬ä¸€å€‹åå¹´ï¼Œå¥ å®šå®‰å…¨æ„Ÿèˆ‡è‡ªæˆ‘èªçŸ¥çš„åŸºç¤' },
            2: { age: '11-20æ­²', name: 'é’æ˜¥æ¢ç´¢', desc: 'æ¢ç´¢è‡ªæˆ‘ã€å»ºç«‹åƒ¹å€¼è§€ã€å°‹æ‰¾èªåŒ' },
            3: { age: '21-30æ­²', name: 'è‡ªæˆ‘å»ºç«‹', desc: 'è¸å…¥ç¤¾æœƒã€å»ºç«‹äº‹æ¥­å’Œé—œä¿‚çš„æ ¹åŸº' },
            4: { age: '31-40æ­²', name: 'æ ¹åŸºç©©å›º', desc: 'ç©©å›ºäº‹æ¥­ã€æ‰¿æ“”è²¬ä»»ã€å»ºç«‹å®¶åº­' },
            5: { age: '41-50æ­²', name: 'è½‰åŒ–è›»è®Š', desc: 'ä¸­å¹´è½‰å‹ã€é‡æ–°å®šç¾©è‡ªæˆ‘' },
            6: { age: '51-60æ­²', name: 'è²¬ä»»æ”¶æˆ', desc: 'æ”¶ç©«å‰åŠç”Ÿçš„åŠªåŠ›' },
            7: { age: '61-70æ­²', name: 'æ™ºæ…§åœ“æ»¿', desc: 'å…§åœ¨æ¢ç´¢ã€åˆ†äº«æ™ºæ…§' },
            8: { age: '71æ­²+', name: 'éˆæ€§æ˜‡è¯', desc: 'è¶…è¶Šç‰©è³ªã€éˆæ€§åœ“æ»¿' }
        };

        const isMasterNumber = (num) => num === 11 || num === 22 || num === 33;
        const reduceToSingle = (num) => { while (num > 9) num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0); return num; };
        const reduceNumber = (num) => { if (isMasterNumber(num)) return num; while (num > 9) { num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0); if (isMasterNumber(num)) return num; } return num; };
        const getBaseNum = (num) => NUMBER_DATA[num] ? num : reduceToSingle(num);

        const calculateHourLight = (data) => {
            const { year, month, day, lunarMonth, lunarDay, hourId } = data;
            const hourData = getHourData(hourId);
            const hourValue = hourData.num;
            let uNum = 0;
            if (hourValue > 0) { if (hourValue === 11) uNum = 11; else if (hourValue === 10) uNum = 1; else if (hourValue === 12) uNum = 3; else uNum = hourValue; }
            const hNum = reduceNumber(parseInt(lunarMonth) + parseInt(lunarDay));
            const oNumRaw = String(year) + String(month).padStart(2, '0') + String(day).padStart(2, '0');
            const oNum = reduceNumber(oNumRaw.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const rNum = uNum ? reduceNumber(hNum + oNum + uNum) : reduceNumber(hNum + oNum);
            const lNum = parseInt(lunarMonth) > 9 ? reduceNumber(parseInt(lunarMonth)) : parseInt(lunarMonth);
            const iNum = uNum || 5;
            const gNum = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const hEnergyNum = parseInt(lunarDay) > 9 ? reduceNumber(parseInt(lunarDay)) : parseInt(lunarDay);
            const tNum = reduceNumber(lNum + iNum + gNum + hEnergyNum);
            const yearStr = String(year);
            const lastTwo = parseInt(yearStr.slice(-2));
            const p2Num = reduceNumber(Math.floor(lastTwo / 10) + (lastTwo % 10));
            const p3Num = parseInt(month) === 11 ? 11 : reduceNumber(parseInt(month));
            const p4Num = [11, 22].includes(parseInt(day)) ? parseInt(day) : reduceNumber(parseInt(day));
            const p5Num = parseInt(lunarMonth) === 11 ? 11 : lNum;
            const p6Num = [11, 22].includes(parseInt(lunarDay)) ? parseInt(lunarDay) : hEnergyNum;
            const p9Num = parseInt(yearStr.charAt(yearStr.length - 3)) || 9;
            const palaces = { 1: getBaseNum(hNum), 2: p2Num, 3: p3Num, 4: p4Num, 5: p5Num, 6: p6Num, 7: getBaseNum(oNum), 8: gNum, 9: p9Num, 10: uNum || 5, 11: tNum, 12: getBaseNum(rNum) };
            const bridgeHO = Math.abs(getBaseNum(hNum) - getBaseNum(oNum));
            const bridgeOU = uNum ? Math.abs(getBaseNum(oNum) - uNum) : 0;
            const bridgeUR = uNum ? Math.abs(uNum - getBaseNum(rNum)) : 0;
            const balanceNum = Math.round((getBaseNum(hNum) + getBaseNum(oNum)) / 2);
            const numberCount = {};
            for (let i = 1; i <= 9; i++) numberCount[i] = 0;
            numberCount[11] = 0; numberCount[22] = 0; numberCount[33] = 0;
            [hNum, oNum, rNum].forEach(num => { if (isMasterNumber(num)) numberCount[num]++; else { const r = reduceToSingle(num); if (r >= 1 && r <= 9) numberCount[r]++; } });
            Object.values(palaces).forEach(num => { if (isMasterNumber(num)) numberCount[num]++; else { const r = reduceToSingle(num); if (r >= 1 && r <= 9) numberCount[r]++; } });
            const hasMasterNumbers = isMasterNumber(hNum) || isMasterNumber(oNum) || isMasterNumber(rNum) || isMasterNumber(uNum);
            const masterNumbersList = [hNum, oNum, uNum, rNum].filter(isMasterNumber);
            return { inputData: { year, month, day, lunarMonth, lunarDay, hourId, hourValue, hourData }, hour: { h: hNum, o: oNum, u: uNum, r: rNum }, light: { l: lNum, i: iNum, g: gNum, h: hEnergyNum, t: tNum }, palaces, bridges: { ho: bridgeHO, ou: bridgeOU, ur: bridgeUR }, balanceNum, analysis: { numberCount, missingNumbers: Object.entries(numberCount).filter(([n, c]) => c === 0 && parseInt(n) <= 9).map(([n]) => parseInt(n)), excessNumbers: Object.entries(numberCount).filter(([_, c]) => c >= 3).map(([n]) => parseInt(n)), hasMasterNumbers, masterNumbersList } };
        };

        const calculateYearFortune = (rNum, year) => {
            const universeYear = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const personalYear = reduceNumber(getBaseNum(rNum) + universeYear);
            return { universeYear, personalYear, ...(YEAR_THEMES[personalYear] || YEAR_THEMES[reduceToSingle(personalYear)]) };
        };

        const calculateLifeFortunes = (rNum, birthYear) => {
            const currentYear = new Date().getFullYear();
            const age = currentYear - birthYear;
            const fortunes = [];
            const baseR = getBaseNum(rNum);
            for (let i = 1; i <= 8; i++) {
                const startAge = (i - 1) * 10 + 1;
                const fortuneNum = reduceNumber(baseR + i);
                const isCurrent = age >= startAge && (i === 8 || age <= i * 10);
                const themeData = FORTUNE_THEMES[i];
                fortunes.push({ period: i, ageRange: themeData.age, startYear: birthYear + startAge - 1, endYear: i === 8 ? 'âˆ' : birthYear + i * 10 - 1, num: fortuneNum, theme: themeData.name, desc: themeData.desc, numMeaning: getNumData(fortuneNum)?.title || '', isCurrent, isMaster: isMasterNumber(fortuneNum) });
            }
            return fortunes;
        };

        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzlPM5yIuAlrQKbYa01bysqxYo3woLAfp1Tc0Ebk8-W4_3KiUfipUx9Li-10YTw2voIVA/exec';
        const logToSheet = (data) => { try { const params = new URLSearchParams({ birthday: data.year + '-' + data.month + '-' + data.day, lunarMonth: data.lunarMonth || '', lunarDay: data.lunarDay || '', hour: data.hourId || 'æœªå¡«', source: 'hourlight-v8.2' }); const img = new Image(); img.src = SHEET_URL + '?' + params.toString(); } catch (e) { console.log('è¨˜éŒ„å¤±æ•—', e); } };

        const MasterBadge = ({ num }) => { if (!isMasterNumber(num)) return null; const labels = { 11: 'âœ¨ ç›´è¦ºå¤§å¸«', 22: 'ğŸ›ï¸ å»ºé€ å¤§å¸«', 33: 'ğŸ’• ç™‚ç™’å¤§å¸«' }; return <span className="master-badge ml-2">{labels[num]}</span>; };

        const RadarChart = ({ data, isNight, labels, title }) => {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);
            useEffect(() => {
                if (!chartRef.current) return;
                if (chartInstance.current) chartInstance.current.destroy();
                const ctx = chartRef.current.getContext('2d');
                const color = isNight ? 'rgba(159, 95, 219, ' : 'rgba(212, 175, 55, ';
                const defaultLabels = labels || ['L æ„›ä¹‹åŠ›', 'I ç›´è¦ºåŠ›', 'G æ ¹åŸºåŠ›', 'H å’Œè«§åŠ›', 'T è›»è®ŠåŠ›'];
                const dataValues = Array.isArray(data) ? data : [data.l, data.i, data.g, data.h, data.t];
                chartInstance.current = new Chart(ctx, { type: 'radar', data: { labels: defaultLabels, datasets: [{ data: dataValues, backgroundColor: color + '0.25)', borderColor: color + '1)', pointBackgroundColor: color + '1)', borderWidth: 2, pointRadius: 5 }] }, options: { scales: { r: { suggestedMin: 0, suggestedMax: labels ? 5 : 9, ticks: { display: false } } }, plugins: { legend: { display: false } } } });
                return () => { if (chartInstance.current) chartInstance.current.destroy(); };
            }, [data, isNight, labels]);
            return <canvas ref={chartRef} />;
        };

        const InputForm = ({ onCalculate, title, showName = false, nameLabel = 'å§“å' }) => {
            const [formData, setFormData] = useState({ name: '', year: '', month: '1', day: '1', lunarMonth: '', lunarDay: '', hourId: '', autoLunar: true });
            const [autoLunarResult, setAutoLunarResult] = useState(null);
            useEffect(() => { if (formData.autoLunar && formData.year && formData.month && formData.day) { const result = solarToLunar(parseInt(formData.year), parseInt(formData.month), parseInt(formData.day)); if (result.lunarMonth > 0) { setAutoLunarResult(result); setFormData(prev => ({ ...prev, lunarMonth: String(result.lunarMonth), lunarDay: String(result.lunarDay) })); } } }, [formData.year, formData.month, formData.day, formData.autoLunar]);
            const handleSubmit = (e) => { e.preventDefault(); if (!formData.year || !formData.lunarMonth || !formData.lunarDay) { alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™'); return; } logToSheet(formData); onCalculate(formData); };
            const lunarMonthNames = ['æ­£','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å','åä¸€','åäºŒ'];
            const getLunarDayName = (d) => { if (d <= 10) return 'åˆ' + ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å'][d-1]; if (d < 20) return 'å' + ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][d-11]; if (d === 20) return 'äºŒå'; if (d < 30) return 'å»¿' + ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][d-21]; return 'ä¸‰å'; };
            return (
                <div className="card p-6 fade-in">
                    {title && <h3 className="text-xl font-bold gold-text mb-4 serif">{title}</h3>}
                    <form onSubmit={handleSubmit} className="space-y-4">
                        {showName && <input type="text" placeholder={nameLabel} className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} />}
                        <div className="grid grid-cols-3 gap-2">
                            <input type="number" placeholder="è¥¿å…ƒå¹´" className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.year} onChange={e => setFormData({...formData, year: e.target.value})} min="1940" max="2030" />
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.month} onChange={e => setFormData({...formData, month: e.target.value})}>{Array.from({length: 12}, (_, i) => <option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.day} onChange={e => setFormData({...formData, day: e.target.value})}>{Array.from({length: 31}, (_, i) => <option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        {autoLunarResult && formData.autoLunar && (<div className="p-3 rounded-lg bg-blue-50 text-blue-800 text-sm"><span>ğŸŒ™ ç³»çµ±è‡ªå‹•è½‰æ›ï¼šè¾²æ›† {lunarMonthNames[autoLunarResult.lunarMonth - 1]}æœˆ {getLunarDayName(autoLunarResult.lunarDay)}</span>{autoLunarResult.isApprox && <span className="text-red-500 text-xs ml-2">ï¼ˆè¿‘ä¼¼å€¼ï¼‰</span>}<button type="button" onClick={() => setFormData({...formData, autoLunar: false})} className="text-xs underline ml-2 opacity-70">æ‰‹å‹•ä¿®æ”¹</button></div>)}
                        {!formData.autoLunar && (<div className="grid grid-cols-2 gap-2"><select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarMonth} onChange={e => setFormData({...formData, lunarMonth: e.target.value})}><option value="">è¾²æ›†æœˆ</option>{lunarMonthNames.map((name, i) => <option key={i+1} value={i+1}>{name}æœˆ</option>)}</select><select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarDay} onChange={e => setFormData({...formData, lunarDay: e.target.value})}><option value="">è¾²æ›†æ—¥</option>{Array.from({length: 30}, (_, i) => <option key={i+1} value={i+1}>{getLunarDayName(i+1)}</option>)}</select><button type="button" onClick={() => setFormData({...formData, autoLunar: true})} className="col-span-2 text-xs underline opacity-70">ä½¿ç”¨è‡ªå‹•è½‰æ›</button></div>)}
                        <select className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.hourId} onChange={e => setFormData({...formData, hourId: e.target.value})}><option value="">æ™‚è¾°ï¼ˆé¸å¡«ï¼‰</option>{HOURS.slice(0, 12).map(h => <option key={h.id} value={h.id}>{h.name}</option>)}<option value="unknown">æ™‚è¾°ä¸è©³</option></select>
                        <button type="submit" className="w-full gold-btn py-3 rounded-lg">é–‹å§‹è¨ˆç®—</button>
                    </form>
                </div>
            );
        };

        const NumberDeepCard = ({ num, label, subLabel, isNight, showFull = false }) => {
            const [isOpen, setIsOpen] = useState(false);
            const data = getNumData(num);
            return (
                <div className={'card p-4 ' + (isMasterNumber(num) ? (isNight ? 'ring-2 ring-purple-400' : 'ring-2 ring-amber-400') : '')}>
                    <div className="flex justify-between items-start mb-2"><div><div className="text-xs opacity-60">{label}</div><div className="text-xs opacity-40">{subLabel}</div></div><div className="text-right"><div className="text-4xl font-bold gold-text">{num || 'â€”'}</div>{isMasterNumber(num) && <MasterBadge num={num} />}</div></div>
                    <div className="text-lg font-bold mb-1">{data.title}</div><div className="text-sm opacity-70 mb-2">{data.essence}</div>
                    {showFull && (<><button onClick={() => setIsOpen(!isOpen)} className="text-xs gold-text hover:underline">{isOpen ? 'æ”¶åˆ â–²' : 'å±•é–‹æ·±åº¦è§£è®€ â–¼'}</button><div className={'detail-panel ' + (isOpen ? 'open' : '')}><div className="mt-3 pt-3 border-t border-current/10 space-y-3 text-sm"><div><span className="font-bold text-green-600">âœ¨ å…‰æ˜é¢ï¼š</span><span className="opacity-80">{data.light}</span></div><div><span className="font-bold text-red-500">âš ï¸ é™°æš—é¢ï¼š</span><span className="opacity-80">{data.dark}</span></div><div><span className="font-bold gold-text">ğŸ¯ éˆé­‚åŠŸèª²ï¼š</span><span className="opacity-80">{data.soulLesson}</span></div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-purple-900/30' : 'bg-amber-50')}><div className="font-bold mb-1">ğŸ’ é¦¥éˆç¨å‰µè§£è®€</div><p className="opacity-80 italic">{data.uniqueReading}</p></div><div><span className="font-bold">ğŸŒ¿ èª¿é »ç²¾æ²¹ï¼š</span><span className="opacity-70">{data.oils?.join('ã€')}</span></div></div></div></>)}
                </div>
            );
        };

        const PalaceDeepCard = ({ palaceId, palaceNum, isNight }) => {
            const [isOpen, setIsOpen] = useState(false);
            const palace = PALACE_DATA[palaceId];
            if (!palace) return null;
            return (
                <div className="card p-4 hover:scale-[1.02] transition cursor-pointer" onClick={() => setIsOpen(!isOpen)}>
                    <div className="flex justify-between items-start mb-2"><div><div className="text-xs opacity-50">{palaceId}å®®ãƒ»{palace.meridian}</div><div className="text-xs opacity-40">{palace.time}</div></div><div className="text-2xl font-bold gold-text">{palaceNum}</div></div>
                    <div className="font-bold mb-1">{palace.name}</div><div className="text-xs opacity-70 mb-2">ã€Œ{palace.theme}ã€</div>
                    <div className={'detail-panel ' + (isOpen ? 'open' : '')}><div className="mt-3 pt-3 border-t border-current/10 space-y-2 text-xs"><div><span className="text-red-500">é™°æš—ï¼š</span>{palace.darkEmotion}</div><div><span className="text-green-500">å…‰æ˜ï¼š</span>{palace.lightEmotion}</div><div className="opacity-70"><div className="font-bold mb-1">å¡ä½çš„äººæœƒï¼š</div><ul className="list-disc list-inside">{palace.stuckPattern.map((p, i) => <li key={i}>{p}</li>)}</ul></div><div><span className="opacity-50">ğŸŒ¿ èª¿é »ç²¾æ²¹ï¼š</span>{palace.oils.join('ã€')}</div></div></div>
                    <div className="text-xs opacity-40 mt-1">{isOpen ? 'é»æ“Šæ”¶åˆ â–²' : 'é»æ“Šå±•é–‹ â–¼'}</div>
                </div>
            );
        };

        const TransformBridge = ({ isNight, onDrawCard }) => (
            <div className="bridge-section card p-8 text-center my-8 fade-in">
                <div className="text-4xl mb-4">ğŸ”®</div>
                <h3 className="text-xl font-bold gold-text serif mb-4">ä½ å·²ç¶“ã€Œçœ‹è¦‹ã€äº†ï¼Œä¸‹ä¸€æ­¥å‘¢ï¼Ÿ</h3>
                <p className={'mb-6 ' + (isNight ? 'text-gray-300' : 'text-gray-600')}>é¦¥éˆç§˜ç¢¼è®“ä½ çœ‹è¦‹è‡ªå·±çš„ç”Ÿå‘½å¯†ç¢¼ã€‚<br/>ä½†ã€Œçœ‹è¦‹ã€åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œã€Œè½‰åŒ–ã€æ‰æ˜¯çœŸæ­£çš„é–‹å§‹ã€‚</p>
                <div className="grid md:grid-cols-2 gap-4 max-w-2xl mx-auto">
                    <div className={'p-6 rounded-xl ' + (isNight ? 'bg-indigo-900/40' : 'bg-gradient-to-br from-amber-50 to-amber-100')}><div className="text-3xl mb-2">ğŸ´</div><h4 className="font-bold mb-2">æŠ½ä¸€å¼µé¦¥éˆä¹‹é‘°</h4><p className="text-sm opacity-80 mb-4">è®“æ¤ç‰©ç²¾éˆå‘Šè¨´ä½ ï¼š<br/>ç¾åœ¨çš„ä½ ï¼Œéœ€è¦ä»€éº¼ï¼Ÿ</p><button onClick={onDrawCard} className="key-btn w-full py-3 px-6 rounded-lg text-lg">ğŸ”‘ å…è²»æŠ½ç‰Œé«”é©—</button></div>
                    <div className={'p-6 rounded-xl ' + (isNight ? 'bg-purple-900/40' : 'bg-gradient-to-br from-purple-50 to-purple-100')}><div className="text-3xl mb-2">ğŸ“–</div><h4 className="font-bold mb-2">æ·±å…¥ç†è§£é€™å¥—ç³»çµ±</h4><p className="text-sm opacity-80 mb-4">ç‚ºä»€éº¼é€™å€‹æ•¸å­—ä»£è¡¨é€™å€‹æ„æ€ï¼Ÿ<br/>èƒŒå¾Œçš„æ™ºæ…§æ˜¯ä»€éº¼ï¼Ÿ</p><a href="#book" className="gold-btn block w-full py-3 px-6 rounded-lg text-center">ğŸ“š ã€Šé¦¥éˆç§˜ç¢¼ã€‹æ–°æ›¸</a></div>
                </div>
                <p className="text-xs opacity-50 mt-6">é¦¥éˆç§˜ç¢¼æ˜¯åœ°åœ–ï¼Œé¦¥éˆä¹‹é‘°æ˜¯é‚£å°è»Šã€‚åœ°åœ–è®“ä½ çŸ¥é“è·¯åœ¨å“ªï¼Œè»Šå­å¸¶ä½ çœŸæ­£æŠµé”ã€‚</p>
            </div>
        );

        const BasicPage = ({ result, setResult, isNight, onDrawCard }) => {
            if (!result) return (<div className="max-w-xl mx-auto"><div className="text-center mb-8"><h2 className="text-3xl font-bold gold-text serif">é–‹å•Ÿä½ çš„å…§åœ¨åŸå ¡</h2><p className="text-sm mt-2 opacity-60">è¼¸å…¥å‡ºç”Ÿè³‡æ–™ï¼Œæ‰¾åˆ°ä½ çš„ç”Ÿå‘½å¯†ç¢¼</p><p className="text-xs mt-1 opacity-40">ğŸ†• v8.2 æ”¯æ´è¥¿æ›†è‡ªå‹•è½‰è¾²æ›†</p></div><InputForm onCalculate={(data) => setResult(calculateHourLight(data))} /></div>);
            const { hour, light, palaces, bridges, balanceNum, analysis, inputData } = result;
            return (
                <div className="space-y-8 fade-in">
                    {analysis.hasMasterNumbers && (<section className={'card p-6 text-center ' + (isNight ? 'bg-gradient-to-r from-purple-900/50 to-pink-900/50' : 'bg-gradient-to-r from-amber-100 to-yellow-100')}><div className="text-4xl mb-3">âœ¨</div><h3 className="text-2xl font-bold gold-text serif mb-2">ä½ æ“æœ‰å¤§å¸«æ•¸ï¼</h3><p className="opacity-80 mb-3">é€™ä»£è¡¨ä½ èƒŒè² è‘—ç‰¹æ®Šçš„éˆæ€§ä½¿å‘½ï¼Œä½†ä¹Ÿé¢è‡¨æ›´å¤§çš„æŒ‘æˆ°ã€‚</p><div className="flex justify-center gap-3 flex-wrap">{analysis.masterNumbersList.map(n => <div key={n} className="px-4 py-2 rounded-lg bg-white/20"><span className="text-2xl font-bold gold-text">{n}</span><span className="ml-2">{getNumData(n)?.title}</span></div>)}</div></section>)}
                    <section><h3 className="text-2xl font-bold gold-text mb-4 pl-4 border-l-4 border-current serif">ğŸ”‘ H.O.U.R. å››ä¸»æ•¸</h3><div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><NumberDeepCard num={hour.h} label="H ç™’æ•¸" subLabel="å…§åœ¨éœ€æ±‚ãƒ»è¾²æ›†æœˆæ—¥" isNight={isNight} showFull={true} /><NumberDeepCard num={hour.o} label="O è­˜æ•¸" subLabel="å¤–åœ¨å‘ˆç¾ãƒ»è¥¿æ›†å…¨åŠ " isNight={isNight} showFull={true} /><NumberDeepCard num={hour.u} label="U è§£æ•¸" subLabel="éš±è—æ½›èƒ½ãƒ»æ™‚è¾°" isNight={isNight} showFull={true} /><NumberDeepCard num={hour.r} label="R è¡Œæ•¸" subLabel="äººç”Ÿä½¿å‘½ãƒ»H+O+U" isNight={isNight} showFull={true} /></div><div className="card p-4 mt-4 text-sm opacity-70"><div className="font-bold mb-2">ğŸ“Š è¨ˆç®—éç¨‹</div><div className="grid grid-cols-2 md:grid-cols-4 gap-2"><div>H = è¾²æ›†{inputData.lunarMonth}æœˆ+{inputData.lunarDay}æ—¥ = {hour.h}</div><div>O = {inputData.year}/{inputData.month}/{inputData.day} = {hour.o}</div><div>U = {inputData.hourData?.name?.split(' ')[0] || 'â€”'} = {hour.u || 'â€”'}</div><div>R = {hour.h}+{hour.o}+{hour.u || 0} = {hour.r}</div></div></div></section>
                    <section className="card p-6"><h4 className="font-bold gold-text mb-3">ğŸŒ‰ æ©‹æ¨‘æ•¸èˆ‡å¹³è¡¡æ•¸</h4><div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"><div><div className="text-xs opacity-50">H-Oæ©‹æ¨‘</div><div className="text-2xl font-bold gold-text">{bridges.ho}</div><div className="text-xs opacity-60">å…§å¤–æ•´åˆ</div></div><div><div className="text-xs opacity-50">O-Uæ©‹æ¨‘</div><div className="text-2xl font-bold gold-text">{bridges.ou || 'â€”'}</div><div className="text-xs opacity-60">é¡¯æ½›é€£çµ</div></div><div><div className="text-xs opacity-50">U-Ræ©‹æ¨‘</div><div className="text-2xl font-bold gold-text">{bridges.ur || 'â€”'}</div><div className="text-xs opacity-60">æ½›èƒ½å¯¦ç¾</div></div><div><div className="text-xs opacity-50">å¹³è¡¡æ•¸</div><div className="text-2xl font-bold gold-text">{balanceNum}</div><div className="text-xs opacity-60">å±æ©Ÿèª¿æ•´</div></div></div></section>
                    <section className="grid grid-cols-1 lg:grid-cols-2 gap-6"><div><h3 className="text-2xl font-bold gold-text mb-4 pl-4 border-l-4 border-current serif">âœ¨ L.I.G.H.T. äº”èƒ½é‡</h3><div className="card p-6"><div className="aspect-square max-w-xs mx-auto"><RadarChart data={light} isNight={isNight} /></div></div></div><div className="space-y-2">{[{ k: 'l', n: 'L æ„›ä¹‹åŠ›', d: 'è‡ªæˆ‘æ¥ç´ã€çµ¦äºˆèˆ‡æ¥å—æ„›çš„èƒ½åŠ›' }, { k: 'i', n: 'I ç›´è¦ºåŠ›', d: 'å…§åœ¨æ™ºæ…§ã€ç¬¬å…­æ„Ÿ' }, { k: 'g', n: 'G æ ¹åŸºåŠ›', d: 'å®‰å…¨æ„Ÿã€ç©©å®šã€ç´®æ ¹' }, { k: 'h', n: 'H å’Œè«§åŠ›', d: 'é—œä¿‚ã€é€£çµã€å…±æŒ¯' }, { k: 't', n: 'T è›»è®ŠåŠ›', d: 'è½‰åŒ–ã€æˆé•·ã€ç ´ç¹­' }].map(item => { const v = light[item.k]; const level = v <= 3 ? 'weak' : v <= 6 ? 'medium' : 'strong'; return (<div key={item.k} className={'card p-3 ' + (level === 'weak' ? (isNight ? 'bg-red-900/30' : 'bg-red-50') : level === 'medium' ? (isNight ? 'bg-yellow-900/30' : 'bg-yellow-50') : (isNight ? 'bg-green-900/30' : 'bg-green-50'))}><div className="flex justify-between items-center"><div><span className="font-bold">{item.n}</span><div className="text-xs opacity-60">{item.d}</div></div><div className="flex items-center gap-2"><span className="text-2xl font-bold gold-text">{v}</span><span className={'text-xs px-2 py-1 rounded ' + (level === 'weak' ? 'bg-red-200 text-red-700' : level === 'medium' ? 'bg-yellow-200 text-yellow-700' : 'bg-green-200 text-green-700')}>{level === 'weak' ? 'éœ€åŸ¹é¤Š' : level === 'medium' ? 'ä¸­ç­‰' : 'å¤©è³¦'}</span></div></div></div>); })}</div></section>
                    {(analysis.missingNumbers.length > 0 || analysis.excessNumbers.length > 0) && (<section className="grid grid-cols-1 md:grid-cols-2 gap-4">{analysis.missingNumbers.length > 0 && (<div className={'card p-6 ' + (isNight ? 'bg-red-900/20' : 'bg-red-50')}><h4 className="font-bold text-red-600 mb-3">âš ï¸ ç©ºç¼ºæ•¸å­— â€” éœ€è¦å­¸ç¿’çš„èª²é¡Œ</h4><div className="space-y-2">{analysis.missingNumbers.map(n => <div key={n} className="flex items-center gap-2"><span className="text-2xl font-bold text-red-500">{n}</span><span className="text-sm">{NUMBER_DATA[n]?.title} â€” {NUMBER_DATA[n]?.essence}</span></div>)}</div></div>)}{analysis.excessNumbers.length > 0 && (<div className={'card p-6 ' + (isNight ? 'bg-amber-900/20' : 'bg-amber-50')}><h4 className="font-bold text-amber-600 mb-3">âš¡ é‡è¤‡æ•¸å­— â€” å¼·åŒ–çš„èƒ½é‡</h4><div className="space-y-2">{analysis.excessNumbers.map(n => <div key={n} className="flex items-center gap-2"><span className="text-2xl font-bold text-amber-500">{n}</span><span className="text-sm">{NUMBER_DATA[n]?.title} â€” èƒ½é‡å¼·ä½†è¦æ³¨æ„éåº¦</span></div>)}</div></div>)}</section>)}
                    <TransformBridge isNight={isNight} onDrawCard={onDrawCard} />
                    <section><h3 className="text-2xl font-bold gold-text mb-4 pl-4 border-l-4 border-current serif">ğŸ° 12å®®ä½ãƒ»å…§åœ¨åŸå ¡</h3><p className="text-sm opacity-60 mb-4">é»æ“Šä»»ä¸€å®®ä½å¡ç‰‡å¯å±•é–‹è©³ç´°è§£è®€</p><div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">{Object.keys(PALACE_DATA).map(id => <PalaceDeepCard key={id} palaceId={parseInt(id)} palaceNum={palaces[id]} isNight={isNight} />)}</div></section>
                    <div className="text-center"><button onClick={() => { const text = 'ã€é¦¥éˆç§˜ç¢¼å®Œæ•´å ±å‘Šã€‘\n\nâ•â•â• H.O.U.R. å››ä¸»æ•¸ â•â•â•\nHæ•¸ï¼š' + hour.h + ' â€” ' + getNumData(hour.h)?.title + '\nOæ•¸ï¼š' + hour.o + ' â€” ' + getNumData(hour.o)?.title + '\nUæ•¸ï¼š' + (hour.u || 'â€”') + '\nRæ•¸ï¼š' + hour.r + ' â€” ' + getNumData(hour.r)?.title + '\n\nâ•â•â• L.I.G.H.T. äº”èƒ½é‡ â•â•â•\nLæ„›ä¹‹åŠ›ï¼š' + light.l + ' | Iç›´è¦ºåŠ›ï¼š' + light.i + ' | Gæ ¹åŸºåŠ›ï¼š' + light.g + '\nHå’Œè«§åŠ›ï¼š' + light.h + ' | Tè›»è®ŠåŠ›ï¼š' + light.t + '\n\nğŸ”‘ æƒ³è¦æ›´æ·±çš„è½‰åŒ–ï¼ŸLINE: judyanee\nâ€”â€” é¦¥éˆç§˜ç¢¼ v8.2 â€”â€”'; navigator.clipboard.writeText(text); alert('å®Œæ•´å ±å‘Šå·²è¤‡è£½ï¼'); }} className="gold-btn px-8 py-3 rounded-lg text-lg">ğŸ“‹ è¤‡è£½å®Œæ•´å ±å‘Š</button></div>
                </div>
            );
        };

        const YearFortunePage = ({ result, isNight }) => {
            const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
            const currentYear = new Date().getFullYear();
            if (!result) return <div className="text-center py-20 opacity-60">è«‹å…ˆåœ¨ã€ŒåŸºç¤å‘½ç›¤ã€è¨ˆç®—ä½ çš„æ•¸æ“š</div>;
            const fortune = calculateYearFortune(result.hour.r, selectedYear);
            const palaceData = PALACE_DATA[fortune.personalYear] || PALACE_DATA[reduceToSingle(fortune.personalYear)];
            return (
                <div className="max-w-2xl mx-auto space-y-6 fade-in">
                    <div className="card p-6"><h3 className="text-xl font-bold gold-text mb-4 serif">ğŸ—“ï¸ é¸æ“‡å¹´ä»½</h3><div className="flex gap-2 flex-wrap">{[currentYear - 1, currentYear, currentYear + 1, currentYear + 2].map(y => <button key={y} onClick={() => setSelectedYear(y)} className={'px-4 py-2 rounded-lg transition ' + (selectedYear === y ? 'gold-btn' : 'bg-gray-100 hover:bg-gray-200 text-gray-700')}>{y}å¹´</button>)}</div></div>
                    <div className={'card p-8 text-center ' + (isNight ? 'bg-gradient-to-br from-purple-900/50 to-pink-900/30' : 'bg-gradient-to-br from-amber-50 to-orange-50')}><div className="text-sm opacity-60">{selectedYear}å¹´ æµå¹´æ•¸</div><div className="text-7xl font-bold gold-text my-4">{fortune.personalYear}{isMasterNumber(fortune.personalYear) && <MasterBadge num={fortune.personalYear} />}</div><div className="text-3xl font-bold serif">{fortune.keyword}å¹´</div><div className="text-lg mt-2 opacity-80">{fortune.theme}</div></div>
                    <div className={'card p-6 ' + (isNight ? 'bg-gradient-to-r from-amber-900/30 to-orange-900/20' : 'bg-gradient-to-r from-amber-50 to-yellow-50')}><h4 className="font-bold gold-text text-lg mb-3">ğŸ¯ å¹´åº¦èšç„¦</h4><p className="text-lg italic opacity-80">{fortune.focus}</p></div>
                    <div className="card p-6"><h4 className="font-bold mb-3">ğŸ“ å¹´åº¦èšç„¦å®®ä½ï¼š{fortune.palace}</h4>{palaceData && <div className="space-y-2 text-sm"><p><span className="font-bold">ç¶“çµ¡ï¼š</span>{palaceData.meridian}ï¼ˆ{palaceData.time}ï¼‰</p><p><span className="font-bold">éˆé­‚æå•ï¼š</span>{palaceData.theme}</p><p><span className="text-red-500">é™°æš—é¢ï¼š</span>{palaceData.darkEmotion}</p><p><span className="text-green-500">å…‰æ˜é¢ï¼š</span>{palaceData.lightEmotion}</p></div>}</div>
                    <div className="card p-6"><h4 className="font-bold mb-3">ğŸ’¡ å¹´åº¦å»ºè­°</h4><p className="text-lg">{fortune.advice}</p><div className="mt-4 p-4 rounded-lg bg-gray-100"><p className="text-sm opacity-70">ğŸŒ¿ èª¿é »ç²¾æ²¹ï¼š{palaceData?.oils?.join('ã€') || getNumData(fortune.personalYear)?.oils?.join('ã€')}</p></div></div>
                </div>
            );
        };

        const LifeFortunePage = ({ result, isNight }) => {
            if (!result) return <div className="text-center py-20 opacity-60">è«‹å…ˆåœ¨ã€ŒåŸºç¤å‘½ç›¤ã€è¨ˆç®—ä½ çš„æ•¸æ“š</div>;
            const fortunes = calculateLifeFortunes(result.hour.r, parseInt(result.inputData.year));
            return (
                <div className="max-w-4xl mx-auto fade-in">
                    <div className="text-center mb-8"><h2 className="text-3xl font-bold gold-text serif">â³ äººç”Ÿå¤§é‹æ™‚é–“è»¸</h2><p className="text-sm mt-2 opacity-60">æ¯10å¹´ä¸€å€‹å¤§é‹é€±æœŸï¼Œçœ‹è¦‹äººç”Ÿçš„ç¯€å¥</p></div>
                    <div className="space-y-4">{fortunes.map((f, i) => { const numData = getNumData(f.num); return (<div key={i} className={'card p-6 ' + (f.isCurrent ? (isNight ? 'ring-2 ring-purple-500 bg-purple-900/20' : 'ring-2 ring-amber-500 bg-amber-50') : '')}><div className="flex flex-col md:flex-row md:items-center gap-4"><div className="text-center md:w-32"><div className="text-4xl font-bold gold-text">{f.num}{f.isMaster && <MasterBadge num={f.num} />}</div><div className="text-sm opacity-60">{f.numMeaning}</div></div><div className="flex-1"><div className="flex items-center gap-2 mb-1">{f.isCurrent && <span className="text-xs px-2 py-1 rounded-full bg-green-500 text-white">ç•¶å‰å¤§é‹</span>}<span className="font-bold text-lg">ç¬¬{f.period}å¤§é‹ãƒ»{f.theme}</span></div><div className="text-sm opacity-60 mb-2">{f.ageRange}ï¼ˆ{f.startYear}-{f.endYear}å¹´ï¼‰</div><p className="text-sm opacity-80">{f.desc}</p><p className="text-sm mt-2"><span className="font-bold">èƒ½é‡ç‰¹è³ªï¼š</span>{numData?.essence}</p></div></div></div>); })}</div>
                </div>
            );
        };

        const HRPage = ({ result, isNight }) => {
            const [hrResult, setHrResult] = useState(null);
            const hrData = { 1: { bestRoles: ['å‰µæ¥­è€…', 'éƒ¨é–€ä¸»ç®¡', 'å°ˆæ¡ˆè² è²¬äºº'], worstRoles: ['è¡Œæ”¿åŠ©ç†', 'éœ€é«˜åº¦é…åˆçš„è·ä½'], manageTip: 'çµ¦äºˆè‡ªä¸»æ¬Šï¼Œä¸è¦å¾®ç®¡ç†', motivate: 'æŒ‘æˆ°æ€§ä»»å‹™ã€ç¨ç«‹å®Œæˆçš„æˆå°±æ„Ÿ', warning: 'å¯èƒ½æ¶åŠŸã€ä¸æ˜“æ¥å—æ‰¹è©•' }, 2: { bestRoles: ['HR', 'å®¢æœ', 'ç§˜æ›¸åŠ©ç†'], worstRoles: ['é«˜å£“æ¥­å‹™', 'ç¨æ–·æ±ºç­–çš„ä¸»ç®¡'], manageTip: 'çµ¦äºˆæƒ…æ„Ÿæ”¯æŒå’Œåœ˜éšŠæ­¸å±¬æ„Ÿ', motivate: 'åœ˜éšŠå’Œè«§ã€è¢«éœ€è¦çš„æ„Ÿè¦º', warning: 'å¯èƒ½éåº¦æ‰¿æ“”ã€éš±è—çœŸå¯¦æƒ³æ³•' }, 3: { bestRoles: ['è¡ŒéŠ·ä¼åŠƒ', 'è¨­è¨ˆå¸«', 'è¬›å¸«'], worstRoles: ['æœƒè¨ˆ', 'å“ç®¡'], manageTip: 'çµ¦äºˆè¡¨é”èˆå°ï¼Œå®šæœŸè®šç¾', motivate: 'è®šç¾ã€æ–°é®®æ„Ÿã€è¢«çœ‹è¦‹çš„æ©Ÿæœƒ', warning: 'å¯èƒ½éåº¦æ‰¿è«¾ã€é€ƒé¿å›°é›£å°è©±' }, 4: { bestRoles: ['å°ˆæ¡ˆç¶“ç†', 'å“ç®¡', 'è²¡å‹™'], worstRoles: ['éœ€é«˜åº¦å‰µæ„', 'å¿«é€Ÿè®ŠåŒ–ç’°å¢ƒ'], manageTip: 'å»ºç«‹æ˜ç¢ºæµç¨‹çµæ§‹', motivate: 'ç©©å®šã€æ˜ç¢ºè¦å‰‡ã€è¢«ä¿¡ä»»', warning: 'å¯èƒ½æŠ—æ‹’è®ŠåŒ–ã€éåº¦å …æŒå·±è¦‹' }, 5: { bestRoles: ['æ¥­å‹™é–‹ç™¼', 'æ–°å‰µå…¬å¸', 'å±æ©Ÿè™•ç†'], worstRoles: ['å›ºå®šé‡è¤‡å·¥ä½œ'], manageTip: 'çµ¦äºˆå½ˆæ€§å’Œæ–°æŒ‘æˆ°', motivate: 'è‡ªç”±ã€æ–°æŒ‘æˆ°ã€è®ŠåŒ–', warning: 'å¯èƒ½çªç„¶é›¢è·ã€æ‰¿è«¾å¯é åº¦è¼ƒä½' }, 6: { bestRoles: ['HR', 'è­·ç†ç…§è­·', 'æ•™è‚²è¨“ç·´'], worstRoles: ['é«˜åº¦ç«¶çˆ­ç’°å¢ƒ'], manageTip: 'è®“ä»–æ„Ÿè¦ºè¢«éœ€è¦å’Œè¢«é‡è¦–', motivate: 'è¢«éœ€è¦ã€åœ˜éšŠå’Œè«§', warning: 'å¯èƒ½éåº¦ä»‹å…¥ã€æ§åˆ¶ä»–äºº' }, 7: { bestRoles: ['ç ”ç©¶å“¡', 'åˆ†æå¸«', 'é¡§å•'], worstRoles: ['å¤§é‡ç¤¾äº¤è·ä½'], manageTip: 'çµ¦äºˆç¨è™•ç©ºé–“ï¼Œå°Šé‡å°ˆæ¥­åˆ¤æ–·', motivate: 'å°ˆæ¥­æˆé•·ã€è¢«å°Šé‡å°ˆæ¥­', warning: 'å¯èƒ½éåº¦åˆ†æã€èˆ‡åœ˜éšŠè„«ç¯€' }, 8: { bestRoles: ['é«˜éšä¸»ç®¡', 'æ¥­å‹™ä¸»ç®¡', 'å‰µæ¥­å®¶'], worstRoles: ['éœ€æœå¾çš„è·ä½'], manageTip: 'çµ¦äºˆæ˜ç¢ºKPIå’Œå‡é·è·¯å¾‘', motivate: 'æ¬ŠåŠ›ã€æˆå°±ã€æŒæ§æ„Ÿ', warning: 'å¯èƒ½è¶Šæ¬Šã€åœ˜éšŠè¡çª' }, 9: { bestRoles: ['éç‡Ÿåˆ©çµ„ç¹”', 'æ•™è‚²åŸ¹è¨“', 'é¡§å•å°å¸«'], worstRoles: ['ç´”è¿½æ±‚åˆ©æ½¤ç’°å¢ƒ'], manageTip: 'é€£çµå·¥ä½œèˆ‡æ›´å¤§æ„ç¾©', motivate: 'æ„ç¾©æ„Ÿã€å¹«åŠ©ä»–äºº', warning: 'å¯èƒ½éåº¦çŠ§ç‰²ã€ä¸åˆ‡å¯¦éš›' } };
            const getRatings = (num) => { const ratings = { 1: { independence: 5, teamwork: 2, stress: 4, creativity: 4, stability: 3 }, 2: { independence: 2, teamwork: 5, stress: 3, creativity: 3, stability: 4 }, 3: { independence: 3, teamwork: 4, stress: 3, creativity: 5, stability: 2 }, 4: { independence: 3, teamwork: 4, stress: 4, creativity: 2, stability: 5 }, 5: { independence: 4, teamwork: 3, stress: 4, creativity: 4, stability: 2 }, 6: { independence: 3, teamwork: 5, stress: 3, creativity: 3, stability: 4 }, 7: { independence: 5, teamwork: 2, stress: 4, creativity: 4, stability: 4 }, 8: { independence: 5, teamwork: 3, stress: 5, creativity: 3, stability: 4 }, 9: { independence: 4, teamwork: 4, stress: 3, creativity: 4, stability: 3 } }; return ratings[getBaseNum(num)] || ratings[1]; };
            if (!hrResult) return (<div className="max-w-2xl mx-auto fade-in"><div className="text-center mb-6"><h2 className="text-3xl font-bold gold-text serif">ğŸ’¼ HRå¿«é€Ÿè­˜äººå ±å‘Š</h2><p className="text-sm mt-2 opacity-60">åŸºæ–¼é¦¥éˆç§˜ç¢¼H.O.U.R.ç³»çµ±çš„äººæ‰è©•ä¼°</p></div>{result && <button onClick={() => setHrResult(result)} className="w-full gold-btn py-4 rounded-lg text-lg mb-4">ä½¿ç”¨æˆ‘çš„å‘½ç›¤ç”Ÿæˆå ±å‘Š</button>}<InputForm title="è¼¸å…¥å“¡å·¥/æ‡‰å¾µè€…è³‡æ–™" showName={true} nameLabel="å§“åï¼ˆé¸å¡«ï¼‰" onCalculate={(data) => setHrResult(calculateHourLight(data))} /></div>);
            const { hour, bridges, analysis } = hrResult;
            const oData = getNumData(hour.o);
            const hr = hrData[getBaseNum(hour.o)] || hrData[1];
            const ratings = getRatings(hour.o);
            const ratingLabels = ['ç¨ç«‹æ€§', 'åœ˜éšŠåˆä½œ', 'æŠ—å£“æ€§', 'å‰µé€ åŠ›', 'ç©©å®šæ€§'];
            return (
                <div className="max-w-2xl mx-auto fade-in space-y-6">
                    <button onClick={() => setHrResult(null)} className="text-sm opacity-60 hover:opacity-100">â† é‡æ–°è¼¸å…¥</button>
                    <div className="card p-6 text-center"><div className="text-6xl font-bold gold-text">{hour.o}{isMasterNumber(hour.o) && <MasterBadge num={hour.o} />}</div><div className="text-2xl font-bold mt-2 serif">{oData?.work?.type}</div><div className="text-lg opacity-70">{oData?.work?.desc}</div><div className="text-sm opacity-50 mt-2">{oData?.work?.style}</div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-4">ğŸ”‘ H.O.U.R. å››ç¶­äººæ‰åˆ†æ</h4><div className="grid grid-cols-2 gap-3"><div className={'p-3 rounded-lg ' + (isNight ? 'bg-blue-900/30' : 'bg-blue-50')}><div className="flex justify-between"><span className="text-xs opacity-60">Hæ•¸ï¼ˆå…§åœ¨éœ€æ±‚ï¼‰</span><span className="text-xl font-bold gold-text">{hour.h}</span></div><p className="text-sm mt-1">{getNumData(hour.h)?.essence}</p><p className="text-xs opacity-50">é¢è©¦çœ‹ä¸åˆ°ï¼Œä½†æ±ºå®šä»–ç•™ä¸‹æˆ–é›¢é–‹</p></div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-green-900/30' : 'bg-green-50')}><div className="flex justify-between"><span className="text-xs opacity-60">Oæ•¸ï¼ˆå¤–åœ¨è¡¨ç¾ï¼‰</span><span className="text-xl font-bold gold-text">{hour.o}</span></div><p className="text-sm mt-1">{oData?.light}</p><p className="text-xs opacity-50">é¢è©¦æ™‚ä½ æœƒçœ‹åˆ°çš„æ¨£å­</p></div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-purple-900/30' : 'bg-purple-50')}><div className="flex justify-between"><span className="text-xs opacity-60">Uæ•¸ï¼ˆéš±è—æ½›èƒ½ï¼‰</span><span className="text-xl font-bold gold-text">{hour.u || 'â€”'}</span></div><p className="text-sm mt-1">{hour.u ? getNumData(hour.u)?.essence : 'éœ€æ·±å…¥äº†è§£'}</p><p className="text-xs opacity-50">é•·æœŸåŸ¹é¤Šå¾Œæœƒå±•ç¾</p></div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-amber-900/30' : 'bg-amber-50')}><div className="flex justify-between"><span className="text-xs opacity-60">Ræ•¸ï¼ˆäººç”Ÿæ–¹å‘ï¼‰</span><span className="text-xl font-bold gold-text">{hour.r}</span></div><p className="text-sm mt-1">{getNumData(hour.r)?.essence}</p><p className="text-xs opacity-50">æ±ºå®šé•·æœŸç™¼å±•å’Œè·æ¶¯è¦åŠƒ</p></div></div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸŒ‰ å…§å¤–æ•´åˆåº¦</h4><div className="grid grid-cols-3 gap-3 text-center"><div><div className="text-2xl font-bold gold-text">{bridges.ho}</div><div className="text-xs opacity-60">H-Oæ©‹æ¨‘</div><div className="text-xs">{bridges.ho <= 2 ? 'âœ“ å…§å¤–ä¸€è‡´' : bridges.ho <= 4 ? 'éœ€èª¿é©' : 'âš ï¸ è½å·®å¤§'}</div></div><div><div className="text-2xl font-bold gold-text">{bridges.ou || 'â€”'}</div><div className="text-xs opacity-60">O-Uæ©‹æ¨‘</div><div className="text-xs">{!bridges.ou ? 'â€”' : bridges.ou <= 2 ? 'æ½›èƒ½æ˜“ç™¼æ®' : 'éœ€åŸ¹é¤Š'}</div></div><div><div className="text-2xl font-bold gold-text">{bridges.ur || 'â€”'}</div><div className="text-xs opacity-60">U-Ræ©‹æ¨‘</div><div className="text-xs">{!bridges.ur ? 'â€”' : bridges.ur <= 2 ? 'æ–¹å‘æ˜ç¢º' : 'éœ€å¼•å°'}</div></div></div></div>
                    <div className="card p-6"><h4 className="font-bold mb-4">ğŸ“Š å·¥ä½œç‰¹è³ªäº”ç¶­è©•ä¼°</h4><div className="flex justify-center"><div style={{width: '280px', height: '280px'}}><RadarChart data={Object.values(ratings)} labels={ratingLabels} isNight={isNight} /></div></div><div className="grid grid-cols-5 gap-2 mt-4 text-center text-xs">{Object.entries(ratings).map(([key, value], i) => <div key={key}><div className="font-bold gold-text">{value}/5</div><div className="opacity-60">{ratingLabels[i]}</div></div>)}</div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸ’¼ è·ä½é©é…åº¦</h4><div className="grid grid-cols-2 gap-4"><div><h5 className="font-bold text-green-600 mb-2">ğŸ‘ é©åˆ</h5><ul className="text-sm space-y-1 opacity-80">{hr.bestRoles.map((r, i) => <li key={i}>â–º {r}</li>)}</ul></div><div><h5 className="font-bold text-red-600 mb-2">ğŸ‘ ä¸é©åˆ</h5><ul className="text-sm space-y-1 opacity-80">{hr.worstRoles.map((r, i) => <li key={i}>â–º {r}</li>)}</ul></div></div></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4"><div className={'card p-4 ' + (isNight ? 'bg-green-900/30' : 'bg-green-50')}><h4 className="font-bold text-green-600 mb-2">âœ… æ ¸å¿ƒå„ªå‹¢</h4><p className="text-sm opacity-80">{oData?.light}</p></div><div className={'card p-4 ' + (isNight ? 'bg-red-900/30' : 'bg-red-50')}><h4 className="font-bold text-red-600 mb-2">âš ï¸ æ½›åœ¨é¢¨éšª</h4><p className="text-sm opacity-80">{oData?.dark}</p></div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸ’¡ ç®¡ç†å»ºè­°</h4><div className="space-y-3 text-sm"><div className={'p-3 rounded-lg ' + (isNight ? 'bg-blue-900/20' : 'bg-blue-50')}><span className="font-bold">å¦‚ä½•ç®¡ç†ï¼š</span> {hr.manageTip}</div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-green-900/20' : 'bg-green-50')}><span className="font-bold">å¦‚ä½•æ¿€å‹µï¼š</span> {hr.motivate}</div><div className={'p-3 rounded-lg ' + (isNight ? 'bg-red-900/20' : 'bg-red-50')}><span className="font-bold">é¢¨éšªé è­¦ï¼š</span> {hr.warning}</div></div></div>
                    {analysis.missingNumbers.length > 0 && (<div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸ” å¯èƒ½ç›²é»ï¼ˆç©ºç¼ºæ•¸å­—ï¼‰</h4><div className="flex flex-wrap gap-2">{analysis.missingNumbers.map(n => <span key={n} className="px-3 py-1 rounded-full bg-red-100 text-red-700 text-sm">{n} {getNumData(n)?.title}</span>)}</div></div>)}
                    <div className={'card p-6 ' + (isNight ? 'bg-gradient-to-br from-purple-900/30 to-pink-900/20' : 'bg-gradient-to-br from-amber-50 to-yellow-50')}><h4 className="font-bold gold-text text-lg mb-3">ğŸ’ é¦¥éˆç¨å‰µæ´å¯Ÿ</h4><p className="opacity-80 italic">{oData?.uniqueReading}</p></div>
                </div>
            );
        };

        const IntimacyPage = ({ result, isNight }) => {
            const [intimacyResult, setIntimacyResult] = useState(null);
            const love7Data = { 1: { desire: 'å¾æœèˆ‡è¢«å¾æœçš„å¿«æ„Ÿ', issue: 'é›£ä»¥è‡£æœã€ç¸½æƒ³ä¸»å°', tip: 'è®“ä»–ç•¶è€å¤§ï¼Œä½†å¶çˆ¾ä¸»å‹•ã€Œåæ’²ã€æœƒè®“ä»–ç˜‹ç‹‚', inBed: 'å–œæ­¡ä¸»å°ç¯€å¥ï¼Œè¿½çš„éç¨‹æ¯”å¾—åˆ°æ›´èˆˆå¥®' }, 2: { desire: 'è¢«å®Œå…¨åŒ…è¦†çš„å®‰å…¨æ„Ÿ', issue: 'éåº¦ä¾è³´ã€ç”¨èº«é«”æ›æ„›', tip: 'å‰æˆ²è¦å¤ é•·ï¼Œäº‹å¾Œçš„æ“æŠ±è·Ÿéç¨‹ä¸€æ¨£é‡è¦', inBed: 'éœ€è¦å¤§é‡è‚¢é«”æ¥è§¸å’Œçœ¼ç¥äº¤æµï¼Œå–œæ­¡è¢«ç·Šç·ŠæŠ±è‘—' }, 3: { desire: 'æœ‰è¶£ã€å¥½ç©ã€ä¸ç„¡èŠ', issue: 'è¡¨æ¼”æ€§æ ¼ã€æ€•è¢«çœ‹ç©¿', tip: 'ä¿æŒæ–°é®®æ„Ÿï¼Œè®šç¾ä»–ã€Œä½ å¥½æœƒã€æ¯”ä»€éº¼éƒ½æœ‰æ•ˆ', inBed: 'å–œæ­¡è¨€èªæŒ‘é€—ã€æ›åœ°æ–¹æ›å§¿å‹¢ã€è§’è‰²æ‰®æ¼”' }, 4: { desire: 'ç©©å®šå®‰å…¨çš„ç¯€å¥', issue: 'å¤ªå›ºå®šè®Šç„¡èŠ', tip: 'å»ºç«‹å›ºå®šçš„ã€Œè¦ªå¯†å„€å¼ã€ï¼Œç†Ÿæ‚‰æ„Ÿè®“ä»–æ›´æ”¾é–‹', inBed: 'éœ€è¦æ™‚é–“æš–æ©Ÿï¼Œä¸€æ—¦é€²å…¥ç‹€æ…‹è€åŠ›é©šäºº' }, 5: { desire: 'åˆºæ¿€å†’éšªçš„æ–°é«”é©—', issue: 'æ€•è¢«ç¶ä½ã€æ€§æˆç™®å‚¾å‘', tip: 'ä¸€èµ·æ¢ç´¢æ–°ç©æ³•ï¼Œä½†ä¹Ÿè¦æœ‰è®“ä»–ã€Œå›ä¾†ã€çš„ç†ç”±', inBed: 'å–œæ­¡å˜—è©¦ã€ä¸æ€•ç”Ÿã€å°æ–°äº‹ç‰©å……æ»¿å¥½å¥‡' }, 6: { desire: 'è¢«éœ€è¦ã€è¢«ä¾è³´', issue: 'åªçµ¦ä¸æ”¶ã€å¿˜è¨˜è‡ªå·±', tip: 'ä¸»å‹•å‘Šè¨´ä»–ã€Œä½ çš„å¿«æ¨‚å°æˆ‘å¾ˆé‡è¦ã€', inBed: 'å°ˆæ³¨åœ¨è®“å°æ–¹èˆ’æœï¼Œå»å¸¸å¿˜è¨˜è‡ªå·±çš„æ„Ÿå—' }, 7: { desire: 'éˆé­‚çš„æ·±åº¦äº¤æµ', issue: 'å¤ªæ´»åœ¨è…¦è¢‹ã€èº«é«”ç–é›¢', tip: 'å…ˆæœ‰æ·±åº¦å°è©±ï¼Œèº«é«”æ‰æœƒè·Ÿä¸Š', inBed: 'å¿ƒæ²’åˆ°ï¼Œèº«é«”å°±åˆ°ä¸äº†ï¼›ä¸€æ—¦é€£ä¸Šï¼Œé«”é©—æ¥µæ·±' }, 8: { desire: 'æ¬ŠåŠ›èˆ‡è‡£æœçš„éŠæˆ²', issue: 'æ§åˆ¶æ…¾å¤ªå¼·', tip: 'å¯ä»¥ç©æŒæ§éŠæˆ²ï¼Œä½†è¦å»ºç«‹å®‰å…¨è©', inBed: 'å¼·åº¦è¦å¤ ï¼Œå–œæ­¡æŒæ§æˆ–è¢«å¾¹åº•å¾æœ' }, 9: { desire: 'è¶…è¶Šè‚‰é«”çš„éˆæ€§åˆä¸€', issue: 'è¦ºå¾—æ€§å¤ªã€Œä½ç´šã€', tip: 'è³¦äºˆæ„ç¾©æ„Ÿï¼Œè®“ä»–çŸ¥é“èº«é«”ä¹Ÿæ˜¯ç¥è–çš„', inBed: 'è¿½æ±‚èº«å¿ƒéˆå®Œå…¨åˆä¸€çš„ç‹€æ…‹' } };
            const fear10Data = { 1: { fear: 'å®³æ€•å¤±å»ä¸»æ§æ¬Š', inBed: 'ç„¡æ³•æ”¾é¬†äº«å—ï¼Œç¸½æƒ³æŒæ§ä¸€åˆ‡', heal: 'ç·´ç¿’æŠŠä¸»æ§æ¬Šäº¤çµ¦å°æ–¹', darkSecret: 'å…¶å¯¦å…§å¿ƒæ¸´æœ›æœ‰äººèƒ½ã€Œé¦´æœã€è‡ªå·±' }, 2: { fear: 'å®³æ€•è¢«æ‹‹æ£„', inBed: 'ç”¨èº«é«”æ›å–æ„›ï¼Œéåº¦è¨å¥½', heal: 'ä½ çš„å­˜åœ¨æœ¬èº«å°±å€¼å¾—è¢«æ„›', darkSecret: 'å®³æ€•èªªå‡ºçœŸæ­£çš„éœ€æ±‚æœƒåš‡è·‘å°æ–¹' }, 3: { fear: 'å®³æ€•ä¸å¤ æœ‰é­…åŠ›', inBed: 'éåº¦è¡¨æ¼”ï¼Œå¤ªåœ¨æ„å°æ–¹åæ‡‰', heal: 'çœŸå¯¦æ¯”å®Œç¾æ›´æ€§æ„Ÿ', darkSecret: 'æœ€æ€•çš„æ˜¯è¢«èªªã€Œæ²’æ„Ÿè¦ºã€' }, 4: { fear: 'å®³æ€•å¤±åºæ··äº‚', inBed: 'åªåœ¨ç†Ÿæ‚‰ç’°å¢ƒæ‰èƒ½æ”¾é–‹', heal: 'å…è¨±è‡ªå·±å¶çˆ¾ã€Œå¤±æ§ã€', darkSecret: 'å…¶å¯¦æ¸´æœ›è¢«å¸¶åˆ°èˆ’é©åœˆä¹‹å¤–' }, 5: { fear: 'å®³æ€•è¢«æŸç¸›å›°ä½', inBed: 'é€ƒé¿æ‰¿è«¾ï¼Œä¸€å®Œäº‹å°±æƒ³è·‘', heal: 'æ‰¿è«¾ä¹Ÿæ˜¯ä¸€ç¨®é¸æ“‡çš„è‡ªç”±', darkSecret: 'å®³æ€•ç•™ä¸‹ä¾†æœƒå¤±å»è‡ªå·±' }, 6: { fear: 'å®³æ€•ä¸è¢«éœ€è¦', inBed: 'åªé¡§å°æ–¹ï¼Œå®Œå…¨å¿½ç•¥è‡ªå·±', heal: 'ä½ çš„å¿«æ¨‚åŒæ¨£é‡è¦', darkSecret: 'ä¸æ•¢ç›¸ä¿¡æœ‰äººæ„›çš„æ˜¯è‡ªå·±è€Œä¸æ˜¯ä»˜å‡º' }, 7: { fear: 'å®³æ€•è¢«çœ‹ç©¿', inBed: 'èº«é«”åœ¨ä½†å¿ƒä¸åœ¨ï¼Œåƒçœ‹è‡ªå·±çš„ç´€éŒ„ç‰‡', heal: 'è®“è‡ªå·±çœŸæ­£ã€Œåœ¨å ´ã€', darkSecret: 'åˆ†æå¤ªå¤šåè€Œç„¡æ³•æ„Ÿå—' }, 8: { fear: 'å®³æ€•å¤±å»æ§åˆ¶æ¬Š', inBed: 'éœ€è¦æ§åˆ¶ä¸€åˆ‡æˆ–è¢«å®Œå…¨æŒæ§', heal: 'æ”¾ä¸‹æ§åˆ¶æœƒå¾—åˆ°æ›´å¤š', darkSecret: 'æ¥µåº¦å®³æ€•è„†å¼±çš„æ™‚åˆ»' }, 9: { fear: 'å®³æ€•å¤ªã€Œå‹•ç‰©æ€§ã€', inBed: 'é€ƒé¿ç´”ç²¹çš„èº«é«”æ„‰æ‚…', heal: 'èº«é«”çš„æ„‰æ‚…ä¹Ÿæ˜¯ç¥è–çš„', darkSecret: 'è¦ºå¾—äº«å—æ€§æ˜¯ä¸€ç¨®å¢®è½' } };
            const open11Data = { 1: { way: 'éœ€è¦æ„Ÿè¦ºã€Œæˆ‘æ±ºå®šã€æ‰èƒ½æ•é–‹', learn: 'è®“å°æ–¹ä¹Ÿæœ‰ä¸»å°æ¬Š', signal: 'ç•¶ä»–é–‹å§‹æ”¾æ…¢é€Ÿåº¦æ™‚ï¼Œå°±æ˜¯åœ¨æ•é–‹' }, 2: { way: 'å°æ–¹å…ˆçµ¦æ‰æ•¢çµ¦', learn: 'ç·´ç¿’ä¸»å‹•è¡¨é”', signal: 'ç•¶ä»–æ•¢æå‡ºè¦æ±‚æ™‚ï¼Œå°±æ˜¯çœŸçš„æ•é–‹äº†' }, 3: { way: 'ç”¨ç¬‘å’Œè¨€èªå¸¶é', learn: 'ä¹Ÿç”¨èº«é«”ç›´æ¥èªª', signal: 'ç•¶ä»–å®‰éœä¸‹ä¾†æ™‚ï¼Œæ˜¯æœ€æ•é–‹çš„æ™‚åˆ»' }, 4: { way: 'éœ€è¦æ™‚é–“å’Œä¿¡ä»»', learn: 'å¶çˆ¾å¯ä»¥åŠ é€Ÿ', signal: 'ç•¶ä»–é¡˜æ„æ‰“ç ´æ…£ä¾‹æ™‚ï¼Œæ˜¯æ¥µå¤§çš„ä¿¡ä»»' }, 5: { way: 'è‚‰é«”æ•é–‹ä½†å¿ƒä¸ä¸€å®š', learn: 'è©¦è‘—è®“å¿ƒä¹Ÿè·Ÿä¸Š', signal: 'ç•¶ä»–é¡˜æ„ã€Œç•™ä¸‹ä¾†ã€æ™‚ï¼Œå°±æ˜¯çœŸæ­£æ•é–‹' }, 6: { way: 'ç…§é¡§å°æ–¹æ™‚æ•é–‹', learn: 'ä¹Ÿè®“è‡ªå·±è¢«ç…§é¡§', signal: 'ç•¶ä»–é¡˜æ„ã€Œè¢«æœå‹™ã€æ™‚ï¼Œæ˜¯å¾ˆæ·±çš„ä¿¡ä»»' }, 7: { way: 'å¿ƒå…ˆé–‹èº«é«”æ‰é–‹', learn: 'æœ‰æ™‚èº«é«”å¯ä»¥å…ˆ', signal: 'ç•¶ä»–ä¸å†åˆ†ææ™‚ï¼Œå°±æ˜¯å®Œå…¨åœ¨å ´' }, 8: { way: 'åœ¨æŒæ§ä¸­æ„Ÿè¦ºå®‰å…¨', learn: 'å˜—è©¦äº¤å‡ºæ§åˆ¶', signal: 'ç•¶ä»–é¡˜æ„ã€ŒæŠ•é™ã€æ™‚ï¼Œæ˜¯æœ€å¤§çš„ä¿¡ä»»' }, 9: { way: 'æœ‰æ„ç¾©æ‰èƒ½æ•é–‹', learn: 'ç´”ç²¹çš„å¿«æ¨‚ä¹Ÿå€¼å¾—', signal: 'ç•¶ä»–ä¸å†ã€Œæ•™å°ã€è€Œæ˜¯ã€Œæ„Ÿå—ã€æ™‚' } };
            const turnOnOff = { 1: { on: ['è®“ä»–ä¸»å°', 'å´‡æ‹œçš„çœ¼ç¥', 'ã€Œä½ å¥½å²å®³ã€', 'é©åº¦æŒ‘æˆ°', 'å¾æœçš„å¿«æ„Ÿ'], off: ['æ‰¹è©•ä»–çš„è¡¨ç¾', 'æ¶ä¸»å°æ¬Š', 'å¤ªè¢«å‹•'] }, 2: { on: ['é•·å‰æˆ²', 'çœ¼ç¥äº¤æµ', 'ã€Œæˆ‘æ„›ä½ ã€', 'äº‹å¾Œæ“æŠ±', 'å…¨èº«æ’«æ‘¸'], off: ['å¤ªå¿«é€²å…¥', 'å®Œäº‹å°±èµ°', 'å†·æ¼ ç–é›¢'] }, 3: { on: ['è¨€èªæŒ‘é€—', 'è®šç¾å¤–è¡¨', 'æ–°é®®èŠ±æ¨£', 'è§’è‰²æ‰®æ¼”', 'æœ‰è¶£çš„å ´æ™¯'], off: ['ä¸€æˆä¸è®Š', 'å¤ªåš´è‚…', 'æ‰¹è©•å¤–è²Œ'] }, 4: { on: ['ç†Ÿæ‚‰çš„ç’°å¢ƒ', 'å›ºå®šå„€å¼', 'å……è¶³æ™‚é–“', 'å®‰å…¨æ„Ÿ'], off: ['å€‰ä¿ƒ', 'é™Œç”Ÿç’°å¢ƒ', 'å¤ªå¤šé©šå–œ'] }, 5: { on: ['æ–°åœ°é»', 'æ–°å˜—è©¦', 'è‡¨æ™‚èµ·æ„', 'å†’éšªæ„Ÿ'], off: ['ä¸€æˆä¸è®Š', 'å¤ªå¤šè¦å‰‡', 'è¢«æŸç¸›'] }, 6: { on: ['ã€Œæˆ‘éœ€è¦ä½ ã€', 'è®“ä»–ç…§é¡§', 'æ„Ÿè¬çš„è©±', 'è¢«ä¾è³´æ„Ÿ'], off: ['æ‹’çµ•ä»–çš„ä»˜å‡º', 'å†·æ·¡'] }, 7: { on: ['æ·±åº¦å°è©±', 'éˆé­‚é€£çµ', 'ä¸è¢«æ‰“æ“¾', 'è¢«ç†è§£'], off: ['è†šæ·ºäº’å‹•', 'è¢«å‚¬', 'å¤ªå¿«'] }, 8: { on: ['æ¬ŠåŠ›éŠæˆ²', 'å¼·åº¦', 'ã€Œä½ èªªäº†ç®—ã€', 'æŒæ§æˆ–è‡£æœ'], off: ['è»Ÿå¼±', 'æ²’å¼·åº¦', 'å¤ªæº«æŸ”'] }, 9: { on: ['éˆæ€§é€£çµ', 'å„€å¼æ„Ÿ', 'ã€Œæˆ‘å€‘åˆè€Œç‚ºä¸€ã€', 'æ·±åº¦æ„ç¾©'], off: ['ç´”ç²¹è‚‰é«”', 'å¤ªç²—ä¿—'] } };
            if (!intimacyResult) return (<div className="max-w-2xl mx-auto fade-in"><div className="text-center mb-6"><h2 className="text-3xl font-bold fire-text serif">ğŸ”¥ è¦ªå¯†é—œä¿‚æ·±åº¦æŒ‡å—</h2><p className="text-sm mt-2 opacity-60">æ·±å¤œæ¨¡å¼å°ˆå±¬ãƒ»æ¢ç´¢ä½ çš„æ…¾æœ›èˆ‡ææ‡¼</p></div>{result && <button onClick={() => setIntimacyResult(result)} className="w-full gold-btn py-4 rounded-lg text-lg mb-4">ä½¿ç”¨æˆ‘çš„å‘½ç›¤ç”Ÿæˆå ±å‘Š</button>}<InputForm title="è¼¸å…¥è³‡æ–™" onCalculate={(data) => setIntimacyResult(calculateHourLight(data))} /></div>);
            const { hour, palaces } = intimacyResult;
            const oData = getNumData(hour.o);
            const palace7 = palaces[7], palace10 = palaces[10], palace11 = palaces[11];
            const base = getBaseNum(hour.o);
            const love = love7Data[palace7] || love7Data[1];
            const fear = fear10Data[palace10] || fear10Data[1];
            const open = open11Data[palace11] || open11Data[1];
            const turnOn = turnOnOff[base]?.on || [];
            const turnOff = turnOnOff[base]?.off || [];
            return (
                <div className="max-w-2xl mx-auto fade-in space-y-6">
                    <button onClick={() => setIntimacyResult(null)} className="text-sm opacity-60 hover:opacity-100">â† é‡æ–°è¼¸å…¥</button>
                    <div className="card p-8 text-center bg-gradient-to-br from-pink-900/50 to-purple-900/60"><div className="text-6xl mb-4">ğŸ”¥</div><h3 className="text-3xl font-bold fire-text serif mb-2">è¦ªå¯†ç‰¹è³ªè§£ç¢¼</h3><div className="text-6xl font-bold gold-text mt-4">{hour.o}</div><div className="text-2xl font-bold mt-2">{oData?.intimacy?.type}</div><div className="opacity-70 mt-2">{oData?.intimacy?.trait}</div></div>
                    <div className="grid md:grid-cols-2 gap-4"><div className="card p-5 bg-gradient-to-br from-green-900/40 to-emerald-900/30"><h4 className="font-bold text-green-400 text-lg mb-3">âœ¨ é–‹æ©ŸæŒ‰éˆ•</h4><ul className="space-y-2">{turnOn.map((t, i) => <li key={i} className="flex items-center gap-2"><span className="text-green-400 text-xl">â™¥</span> {t}</li>)}</ul></div><div className="card p-5 bg-gradient-to-br from-red-900/40 to-rose-900/30"><h4 className="font-bold text-red-400 text-lg mb-3">âŒ é—œæ©ŸæŒ‰éˆ•</h4><ul className="space-y-2">{turnOff.map((t, i) => <li key={i} className="flex items-center gap-2"><span className="text-red-400 text-xl">âœ•</span> {t}</li>)}</ul></div></div>
                    <div className="grid md:grid-cols-2 gap-4"><div className="card p-5 bg-gradient-to-br from-green-900/30 to-emerald-900/20"><h4 className="font-bold text-green-400 text-lg mb-3">ğŸ’• å¥åº·ç‹€æ…‹</h4><p>{oData?.intimacy?.healthy}</p></div><div className="card p-5 bg-gradient-to-br from-red-900/30 to-rose-900/20"><h4 className="font-bold text-red-400 text-lg mb-3">âš ï¸ å¤±è¡¡è­¦è¨Š</h4><p>{oData?.intimacy?.shadow}</p></div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-xl mb-4">ğŸ’‹ 7å®®ãƒ»ä½ åœ¨åºŠä¸Šæ¸´æœ›ä»€éº¼ï¼Ÿ</h4><div className="flex items-start gap-4 mb-4"><span className="text-5xl font-bold gold-text">{palace7}</span><div><div className="text-xl font-bold text-pink-400">{love.desire}</div><div className="text-sm opacity-70 mt-1">æ½›åœ¨èª²é¡Œï¼š{love.issue}</div><div className="text-sm mt-2">åœ¨åºŠä¸Šï¼š{love.inBed}</div></div></div><div className="p-4 rounded-lg bg-pink-900/30"><span className="font-bold text-pink-400">ğŸ’¡ ä¼´ä¾¶æ”»ç•¥ï¼š</span> {love.tip}</div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-xl mb-4">ğŸ˜° 10å®®ãƒ»ä½ å°è¦ªå¯†çš„æ·±å±¤ææ‡¼</h4><div className="flex items-start gap-4 mb-4"><span className="text-5xl font-bold gold-text">{palace10}</span><div><div className="text-xl font-bold text-red-400">{fear.fear}</div><div className="text-sm mt-2">é€™æœƒè®“ä½ åœ¨åºŠä¸Šï¼š{fear.inBed}</div><div className="text-sm mt-2 p-2 rounded bg-purple-900/30">ğŸ”® ä¸èƒ½èªªçš„ç§˜å¯†ï¼š{fear.darkSecret}</div></div></div><div className="p-4 rounded-lg bg-purple-900/30"><span className="font-bold text-purple-400">ğŸ’œ ç™‚ç™’æ–¹å‘ï¼š</span> {fear.heal}</div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-xl mb-4">ğŸ’ 11å®®ãƒ»ä½ å¦‚ä½•çœŸæ­£æ•é–‹ï¼Ÿ</h4><div className="flex items-start gap-4 mb-4"><span className="text-5xl font-bold gold-text">{palace11}</span><div><div className="text-lg font-bold">{open.way}</div><div className="text-sm opacity-70 mt-1">éœ€è¦å­¸ç¿’ï¼š{open.learn}</div><div className="text-sm mt-2 p-2 rounded bg-amber-900/30">âœ¨ æ•é–‹çš„è¨Šè™Ÿï¼š{open.signal}</div></div></div></div>
                    <div className="card p-6 bg-gradient-to-br from-amber-900/30 to-orange-900/20"><h4 className="font-bold text-amber-400 text-lg mb-3">ğŸ’¡ çµ¦ä¼´ä¾¶çš„çµ‚æ¥µå»ºè­°</h4><p className="text-lg">{oData?.intimacy?.tip}</p></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸŒ¹ è¦ªå¯†èª¿é »ç²¾æ²¹è™•æ–¹</h4><div className="grid grid-cols-2 gap-3"><div className="p-3 rounded-lg bg-pink-900/30"><p className="font-bold text-pink-400 text-sm mb-1">ğŸ”¥ é»ç‡ƒæ…¾æœ›</p><p className="text-xs">ä¾è˜­3æ»´ + è–‘2æ»´ + é»‘èƒ¡æ¤’2æ»´</p></div><div className="p-3 rounded-lg bg-purple-900/30"><p className="font-bold text-purple-400 text-sm mb-1">ğŸ’œ æ·±åº¦é€£çµ</p><p className="text-xs">ç«ç‘°2æ»´ + æª€é¦™3æ»´ + èŒ‰è‰2æ»´</p></div><div className="p-3 rounded-lg bg-orange-900/30"><p className="font-bold text-orange-400 text-sm mb-1">ğŸ§¡ é‡‹æ”¾å£“æŠ‘</p><p className="text-xs">ä½›æ‰‹æŸ‘3æ»´ + è‹¦æ©™è‘‰2æ»´ + æ©™èŠ±2æ»´</p></div><div className="p-3 rounded-lg bg-blue-900/30"><p className="font-bold text-blue-400 text-sm mb-1">ğŸ’™ ç™‚ç™’å‰µå‚·</p><p className="text-xs">ä¹³é¦™3æ»´ + ç«ç‘°2æ»´ + å²©è˜­è‰2æ»´</p></div></div></div>
                    <div className="card p-6 text-center opacity-80"><p className="italic text-lg">ã€Œä½ çš„èº«é«”ä¸æ˜¯æ•µäººï¼Œæ˜¯éˆé­‚çš„æ®¿å ‚ã€‚<br/>æ…¾æœ›ä¸æ˜¯ç½ªæƒ¡ï¼Œæ˜¯ç”Ÿå‘½åŠ›çš„å±•ç¾ã€‚<br/>ç•¶ä½ èƒ½ä¸å¸¶ç¾æ¥åœ°æ„Ÿå—æ„‰æ‚…ï¼Œ<br/>ä¸å¸¶ææ‡¼åœ°æ•é–‹èº«é«”ï¼Œ<br/>é‚£ä¸€åˆ»ï¼Œä½ æ‰çœŸæ­£æ´»è‘—ã€‚ã€</p><p className="text-sm opacity-50 mt-4">â€” é¦¥éˆä¹‹é‘°ãƒ»è¦ªå¯†é—œä¿‚æŒ‡å—</p></div>
                </div>
            );
        };

        // åˆç›¤é ï¼ˆå®Œæ•´ç‰ˆï¼‰
        const CompatibilityPage = ({ result, isNight }) => {
            const [resultA, setResultA] = useState(result);
            const [resultB, setResultB] = useState(null);
            useEffect(() => { if (result && !resultA) setResultA(result); }, [result]);
            const analyzeCompatibility = (rA, rB) => {
                const hourA = rA.hour, hourB = rB.hour;
                let scores = { total: 0, details: [] };
                const oBaseA = getBaseNum(hourA.o), oBaseB = getBaseNum(hourB.o);
                const hBaseA = getBaseNum(hourA.h), hBaseB = getBaseNum(hourB.h);
                const rBaseA = getBaseNum(hourA.r), rBaseB = getBaseNum(hourB.r);
                const oDiff = Math.abs(oBaseA - oBaseB);
                const oScore = oDiff === 0 ? 20 : oDiff <= 2 ? 15 : oDiff <= 4 ? 10 : 5;
                scores.details.push({ name: 'Oæ•¸å¸å¼•åŠ›', score: oScore, max: 20, desc: oDiff === 0 ? 'å¤©ç”Ÿä¸€å°ï¼' : oDiff <= 2 ? 'è‡ªç„¶å¸å¼•' : 'éœ€è¦ç£¨åˆ' });
                const hDiff = Math.abs(hBaseA - hBaseB);
                const hScore = hDiff === 0 ? 20 : hDiff <= 2 ? 15 : hDiff <= 4 ? 10 : 5;
                scores.details.push({ name: 'Hæ•¸å¥‘åˆåº¦', score: hScore, max: 20, desc: hDiff === 0 ? 'å¿ƒéˆå¥‘åˆï¼' : hDiff <= 2 ? 'èƒ½äº’ç›¸ç†è§£' : 'éœ€è¦æºé€š' });
                const rDiff = Math.abs(rBaseA - rBaseB);
                const rScore = rDiff === 0 ? 20 : rDiff <= 2 ? 15 : rDiff <= 4 ? 10 : 5;
                scores.details.push({ name: 'Ræ•¸æ–¹å‘', score: rScore, max: 20, desc: rDiff === 0 ? 'åŒé“ä¸­äººï¼' : rDiff <= 2 ? 'æ–¹å‘æ¥è¿‘' : 'å¯èƒ½åˆ†æ­§' });
                const p7A = rA.palaces[7], p7B = rB.palaces[7];
                const p7Diff = Math.abs(p7A - p7B);
                const p7Score = p7Diff === 0 ? 20 : p7Diff <= 2 ? 15 : p7Diff <= 4 ? 10 : 5;
                scores.details.push({ name: '7å®®æ„›çš„èªè¨€', score: p7Score, max: 20, desc: p7Diff === 0 ? 'æ„›çš„èªè¨€ç›¸åŒï¼' : p7Diff <= 2 ? 'å®¹æ˜“æºé€š' : 'éœ€è¦å­¸ç¿’' });
                scores.total = scores.details.reduce((sum, d) => sum + d.score, 0);
                let level, advice;
                if (scores.total >= 70) { level = 'å¤©ä½œä¹‹åˆ ğŸ’•'; advice = 'ä½ å€‘æœ‰æ¥µé«˜çš„å¥‘åˆåº¦ï¼çæƒœé€™ä»½é›£å¾—çš„ç·£åˆ†ã€‚'; }
                else if (scores.total >= 55) { level = 'è‰¯å¥½é…å° âœ¨'; advice = 'åŸºç¤å¾ˆå¥½ï¼Œé€éç†è§£å’ŒåŒ…å®¹å¯ä»¥æ›´é€²ä¸€æ­¥ã€‚'; }
                else if (scores.total >= 40) { level = 'éœ€è¦åŠªåŠ› ğŸ’ª'; advice = 'æœ‰äº›å·®ç•°éœ€è¦ç£¨åˆï¼Œä½†å·®ç•°ä¹Ÿæ˜¯æˆé•·çš„æ©Ÿæœƒã€‚'; }
                else { level = 'æŒ‘æˆ°è¼ƒå¤§ ğŸŒ±'; advice = 'éœ€è¦æ›´å¤šè€å¿ƒå’Œæºé€šï¼Œè¨˜å¾—æ¬£è³å½¼æ­¤çš„ä¸åŒã€‚'; }
                return { ...scores, level, advice };
            };
            if (!resultA || !resultB) return (
                <div className="max-w-4xl mx-auto space-y-6 fade-in">
                    <div className="text-center mb-6"><h2 className="text-3xl font-bold gold-text serif">ğŸ’• é—œä¿‚åˆç›¤åˆ†æ</h2><p className="text-sm mt-2 opacity-60">äº†è§£å…©äººçš„èƒ½é‡äº’å‹•èˆ‡å¥‘åˆåº¦</p></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div><div className="text-center mb-2 font-bold gold-text">Aæ–¹{resultA ? ' âœ“' : ''}</div>{resultA ? (<div className="card p-4 text-center"><div className="text-sm opacity-60">å·²è¼‰å…¥</div><div className="text-2xl font-bold gold-text mt-2">H{resultA.hour.h} O{resultA.hour.o} R{resultA.hour.r}</div><button onClick={() => setResultA(null)} className="text-xs mt-2 opacity-50 hover:opacity-100">é‡æ–°è¼¸å…¥</button></div>) : (<InputForm title="Aæ–¹è³‡æ–™" onCalculate={(data) => setResultA(calculateHourLight(data))} />)}</div>
                        <div><div className="text-center mb-2 font-bold gold-text">Bæ–¹{resultB ? ' âœ“' : ''}</div>{resultB ? (<div className="card p-4 text-center"><div className="text-2xl font-bold gold-text">H{resultB.hour.h} O{resultB.hour.o} R{resultB.hour.r}</div><button onClick={() => setResultB(null)} className="text-xs mt-2 opacity-50 hover:opacity-100">é‡æ–°è¼¸å…¥</button></div>) : (<InputForm title="Bæ–¹è³‡æ–™" onCalculate={(data) => setResultB(calculateHourLight(data))} />)}</div>
                    </div>
                </div>
            );
            const analysis = analyzeCompatibility(resultA, resultB);
            return (
                <div className="max-w-4xl mx-auto space-y-6 fade-in">
                    <div className="text-center mb-6"><h2 className="text-3xl font-bold gold-text serif">ğŸ’• é—œä¿‚åˆç›¤åˆ†æ</h2></div>
                    <div className="grid grid-cols-2 gap-4"><div className="card p-4 text-center"><div className="text-sm opacity-60">Aæ–¹</div><div className="text-2xl font-bold gold-text">H{resultA.hour.h} O{resultA.hour.o} R{resultA.hour.r}</div></div><div className="card p-4 text-center"><div className="text-sm opacity-60">Bæ–¹</div><div className="text-2xl font-bold gold-text">H{resultB.hour.h} O{resultB.hour.o} R{resultB.hour.r}</div></div></div>
                    <div className={`card p-6 text-center ${analysis.total >= 55 ? (isNight ? 'bg-green-900/30' : 'bg-green-50') : (isNight ? 'bg-yellow-900/30' : 'bg-yellow-50')}`}><div className="text-6xl font-bold gold-text">{analysis.total}</div><div className="text-sm opacity-60">/ 80 åˆ†</div><div className="text-2xl font-bold mt-2 serif">{analysis.level}</div><p className="mt-2 opacity-80">{analysis.advice}</p></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-4">ğŸ“Š è©³ç´°è©•åˆ†</h4><div className="space-y-4">{analysis.details.map((d, i) => (<div key={i}><div className="flex justify-between text-sm mb-1"><span>{d.name}</span><span className="opacity-60">{d.score}/{d.max}</span></div><div className="score-bar bg-gray-200"><div className="score-fill" style={{ width: `${(d.score / d.max) * 100}%`, background: d.score / d.max >= 0.7 ? 'linear-gradient(90deg, #22C55E, #4ADE80)' : 'linear-gradient(90deg, #EAB308, #FDE047)' }}></div></div><div className="text-xs opacity-60 mt-1">{d.desc}</div></div>))}</div></div>
                    <div className="grid grid-cols-2 gap-4"><div className="card p-4"><h5 className="font-bold text-green-500 mb-2">âœ¨ Aæ–¹å¸¶çµ¦Bæ–¹</h5><p className="text-sm">{getNumData(resultA.hour.o)?.light}</p></div><div className="card p-4"><h5 className="font-bold text-blue-500 mb-2">âœ¨ Bæ–¹å¸¶çµ¦Aæ–¹</h5><p className="text-sm">{getNumData(resultB.hour.o)?.light}</p></div></div>
                    <div className="card p-6"><h4 className="font-bold gold-text text-lg mb-3">ğŸ’¡ ç›¸è™•å»ºè­°</h4><p>Aæ–¹ï¼ˆ{getNumData(resultA.hour.o)?.title}ï¼‰éœ€è¦ï¼š{getNumData(resultA.hour.h)?.essence}</p><p className="mt-2">Bæ–¹ï¼ˆ{getNumData(resultB.hour.o)?.title}ï¼‰éœ€è¦ï¼š{getNumData(resultB.hour.h)?.essence}</p></div>
                    <div className="text-center"><button onClick={() => { setResultA(null); setResultB(null); }} className="gold-btn px-6 py-2 rounded-lg">é‡æ–°æ¸¬è©¦</button></div>
                </div>
            );
        };

        /* ============================================
           ä¸»æ‡‰ç”¨
           ============================================ */
        const App = () => {
            const [result, setResult] = useState(null);
            const [isNight, setIsNight] = useState(false);
            const [activeTab, setActiveTab] = useState('basic');
            const [showAgeConfirm, setShowAgeConfirm] = useState(false);
            const [showCardModal, setShowCardModal] = useState(false);

            useEffect(() => { document.body.className = isNight ? 'night-mode' : 'day-mode'; }, [isNight]);

            const handleNightToggle = () => { if (!isNight) setShowAgeConfirm(true); else setIsNight(false); };
            const confirmAge = () => { setIsNight(true); setShowAgeConfirm(false); };

            const tabs = [
                { id: 'basic', label: 'ğŸ”‘ åŸºç¤å‘½ç›¤', icon: 'ğŸ”‘' },
                { id: 'year', label: 'ğŸ—“ï¸ æµå¹´é‹å‹¢', icon: 'ğŸ—“ï¸' },
                { id: 'fortune', label: 'â³ å¤§é‹æ™‚é–“è»¸', icon: 'â³' },
                { id: 'compat', label: 'ğŸ’• é—œä¿‚åˆç›¤', icon: 'ğŸ’•' },
                { id: 'hr', label: isNight ? 'ğŸ”¥ è¦ªå¯†æŒ‡å—' : 'ğŸ’¼ HRè­˜äºº', icon: isNight ? 'ğŸ”¥' : 'ğŸ’¼' }
            ];

            return (
                <div className="min-h-screen">
                    {showAgeConfirm && (
                        <div className="modal-overlay">
                            <div className="card modal-content max-w-md w-full mx-4 p-8 text-center">
                                <div className="text-5xl mb-4">ğŸ”¥</div>
                                <h3 className="text-2xl font-bold fire-text mb-4 serif">æ·±å¤œæ¨¡å¼</h3>
                                <p className="mb-4 opacity-80">æ·±å¤œæ¨¡å¼åŒ…å«ã€Œè¦ªå¯†é—œä¿‚æ·±åº¦æŒ‡å—ã€<br/>å…§å®¹è¼ƒç‚ºç›´ç™½ç«è¾£ ğŸŒ¶ï¸</p>
                                <p className="text-lg font-bold mb-6">è«‹å•ä½ å·²å¹´æ»¿18æ­²å—ï¼Ÿ</p>
                                <div className="flex gap-4 justify-center">
                                    <button onClick={() => setShowAgeConfirm(false)} className="px-8 py-3 rounded-lg bg-gray-200 text-gray-700 font-bold">æœªæ»¿18æ­²</button>
                                    <button onClick={confirmAge} className="gold-btn px-8 py-3 rounded-lg font-bold">æˆ‘å·²æ»¿18æ­² ğŸ”¥</button>
                                </div>
                            </div>
                        </div>
                    )}

                    <header className={`backdrop-blur-md shadow-sm sticky top-0 z-50 ${isNight ? 'bg-gray-900/90' : 'bg-white/90'}`}>
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex justify-between items-center mb-3">
                                <div><h1 className="text-2xl font-bold gold-text tracking-widest serif">é¦¥éˆç§˜ç¢¼</h1><p className="text-[10px] opacity-50">Hour Light v8.2 å®Œæ•´ç‰ˆ</p></div>
                                <div className="flex items-center gap-2">
                                    {result && <button onClick={() => setResult(null)} className="text-xs opacity-60 hover:opacity-100 px-3 py-1">é‡æ–°è¨ˆç®—</button>}
                                    <button onClick={handleNightToggle} className="gold-btn px-3 py-1 rounded-full text-xs">{isNight ? 'ğŸ”¥ æ·±å¤œ' : 'â˜€ï¸ ç™½å¤©'}</button>
                                </div>
                            </div>
                            <div className="flex gap-1 overflow-x-auto pb-1">{tabs.map(tab => <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`tab-btn px-3 py-2 text-sm whitespace-nowrap ${activeTab === tab.id ? 'active font-bold' : 'opacity-60'}`}><span className="hidden md:inline">{tab.label}</span><span className="md:hidden">{tab.icon}</span></button>)}</div>
                        </div>
                    </header>

                    <main className="container mx-auto px-4 py-8">
                        {activeTab === 'basic' && <BasicPage result={result} setResult={setResult} isNight={isNight} onDrawCard={() => setShowCardModal(true)} />}
                        {activeTab === 'year' && <YearFortunePage result={result} isNight={isNight} />}
                        {activeTab === 'fortune' && <LifeFortunePage result={result} isNight={isNight} />}
                        {activeTab === 'compat' && <CompatibilityPage result={result} isNight={isNight} />}
                        {activeTab === 'hr' && (isNight ? <IntimacyPage result={result} isNight={isNight} /> : <HRPage result={result} isNight={isNight} />)}
                    </main>

                    <div className="floating-card-btn"><button onClick={() => setShowCardModal(true)} className="key-btn px-5 py-3 rounded-2xl shadow-2xl flex items-center gap-2"><span className="text-xl">ğŸ´</span><div className="text-left"><div className="font-bold text-sm">æŠ½ä¸€å¼µç‰Œ</div><div className="text-xs opacity-80">é¦¥éˆä¹‹é‘°</div></div></button></div>

                    {showCardModal && (
                        <div className="modal-overlay" onClick={() => setShowCardModal(false)}>
                            <div className="card modal-content max-w-md w-full mx-4 p-8 text-center" onClick={e => e.stopPropagation()}>
                                <div className="text-6xl mb-4">ğŸ´</div>
                                <h3 className="text-2xl font-bold gold-text mb-4 serif">é¦¥éˆä¹‹é‘°ãƒ»æŠ½ç‰Œé«”é©—</h3>
                                <p className="mb-6 opacity-80">é¦¥éˆç§˜ç¢¼è®“ä½ ã€Œçœ‹è¦‹ã€è‡ªå·±çš„ç”Ÿå‘½å¯†ç¢¼<br/>é¦¥éˆä¹‹é‘°å¸¶ä½ ã€Œè½‰åŒ–ã€é‚£äº›å¡ä½çš„èƒ½é‡</p>
                                <div className={`p-4 rounded-lg mb-6 ${isNight ? 'bg-purple-900/30' : 'bg-amber-50'}`}>
                                    <p className="text-sm opacity-70">130å¼µç‰Œå¡ Ã— 12ç³»çµ±æ•´åˆ</p>
                                    <p className="text-sm opacity-70">æ¤ç‰©ç²¾éˆ Ã— æƒ…ç·’é »ç‡</p>
                                </div>
                                <a href="draw-hl.html" target="_blank" rel="noopener" className="key-btn block w-full py-4 rounded-lg text-xl mb-4">ğŸ”‘ LINEå…è²»æŠ½ç‰Œ</a>
                                <p className="text-xs opacity-50">LINE ID: judyanee</p>
                                <button onClick={() => setShowCardModal(false)} className="mt-4 text-sm opacity-50 hover:opacity-100">é—œé–‰</button>
                            </div>
                        </div>
                    )}

                    <footer className={`text-center py-8 mt-12 border-t ${isNight ? 'border-purple-800/50' : 'border-amber-200'}`}>
                        <p className="text-xl gold-text mb-2 serif">é¦¥éˆç§˜ç¢¼ Ã— é¦¥éˆä¹‹é‘°</p>
                        <p className="text-sm opacity-60">ã€Œçœ‹è¦‹ã€æ˜¯ç¬¬ä¸€æ­¥ï¼Œã€Œè½‰åŒ–ã€æ˜¯æ—…ç¨‹</p>
                        <p className="text-xs opacity-40 mt-4">Â© 2025 é¦¥éˆä¹‹é‘°åœ‹éš›æœ‰é™å…¬å¸ Hour Light International Co., Ltd.</p>
                        <p className="text-xs opacity-30 mt-1">v8.2 å®Œæ•´ç‰ˆ ï½œ LINE: judyanee</p>
                    </footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
