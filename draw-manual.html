<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<!-- Google Analytics 4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BXP7K53QG6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BXP7K53QG6');
</script>
<!-- Facebook Pixel -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1333106288588347');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1333106288588347&ev=PageView&noscript=1"
/></noscript>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é¦¥éˆä¹‹é‘°ï½œå¯¦é«”ç‰Œå¡è¨˜éŒ„</title>
  <meta name="description" content="é¦¥éˆä¹‹é‘°å¯¦é«”ç‰Œå¡è¨˜éŒ„å·¥å…·ï½œæ‰‹å‹•è¼¸å…¥æŠ½å‡ºçš„ç‰Œå¡ç·¨è™Ÿï¼Œè‡ªå‹•ç”¢ç”Ÿå®Œæ•´é‘°ç›¤çµæœï¼Œå¯è¤‡è£½è²¼ä¸Šçµ¦è¦ºå¯Ÿå¸«é€²è¡Œæ·±åº¦è§£è®€ã€‚" />
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="assets/css/hourlight-global.css">
  <link rel="stylesheet" href="assets/css/hl-cosmos.css">
  <link rel="stylesheet" href="assets/css/hl-footer-lite.css">
<style>
  :root {
    --dm-bg: #05030a;
    --dm-card: rgba(10,6,24,0.92);
    --dm-border: rgba(233,194,125,0.35);
    --dm-gold: #e9c27d;
    --dm-gold-deep: #cda86e;
    --dm-ink: #f7efe1;
    --dm-ink-soft: #c4b7a6;
    --dm-ink-muted: #988b7b;
    --dm-ease: cubic-bezier(0.4, 0, 0.2, 1);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    min-height: 100vh;
    font-family: "Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
    color: var(--dm-ink);
    line-height: 1.8;
    padding: 24px 16px 72px;
    background:
      radial-gradient(circle at 10% 0%, rgba(233,194,125,0.12) 0, transparent 55%),
      radial-gradient(circle at 80% 100%, rgba(132,112,255,0.15) 0, transparent 55%),
      var(--dm-bg);
  }

  .dm-wrap { max-width: 720px; margin: 0 auto; }

  .dm-glass {
    border-radius: 20px;
    padding: 28px 24px;
    margin-bottom: 20px;
    backdrop-filter: blur(18px) saturate(150%);
    background: radial-gradient(circle at top left, rgba(233,194,125,0.12), transparent 55%), var(--dm-card);
    border: 1px solid var(--dm-border);
    box-shadow: 0 20px 50px rgba(0,0,0,0.8), 0 0 20px rgba(233,194,125,0.1);
  }

  /* æ¨™é¡Œå€ */
  .dm-hero { text-align: center; padding: 20px 0 10px; }
  .dm-hero-title {
    font-size: clamp(1.6rem, 5vw, 2.2rem);
    font-weight: 900;
    letter-spacing: 0.06em;
    background: linear-gradient(135deg, #fbe6c2, #e9c27d 40%, #cda86e 80%, #fff9ea);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .dm-hero-sub {
    margin-top: 8px;
    font-size: 0.92rem;
    color: var(--dm-ink-soft);
    letter-spacing: 0.04em;
  }
  .dm-back {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: var(--dm-ink-muted);
    text-decoration: none;
    font-size: 0.85rem;
    margin-bottom: 12px;
    transition: color 0.2s;
  }
  .dm-back:hover { color: var(--dm-gold); }

  /* æ­¥é©Ÿæ¨™ç±¤ */
  .dm-step-label {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 14px;
    font-weight: 700;
    font-size: 1rem;
    color: var(--dm-gold);
    letter-spacing: 0.03em;
  }
  .dm-step-num {
    width: 28px; height: 28px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--dm-gold), var(--dm-gold-deep));
    color: #1a0e05;
    font-size: 0.85rem;
    font-weight: 900;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  /* å•é¡Œè¼¸å…¥ */
  .dm-question {
    width: 100%;
    min-height: 80px;
    padding: 14px 16px;
    border-radius: 12px;
    border: 1px solid var(--dm-border);
    background: rgba(255,255,255,0.05);
    color: var(--dm-ink);
    font-size: 1rem;
    font-family: inherit;
    line-height: 1.7;
    resize: vertical;
    transition: border-color 0.3s;
  }
  .dm-question::placeholder { color: rgba(255,255,255,0.3); }
  .dm-question:focus { outline: none; border-color: var(--dm-gold); }

  /* ç‰Œé™£é¸æ“‡ */
  .dm-spread-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
  }
  .dm-spread-btn {
    padding: 12px 6px;
    border-radius: 12px;
    border: 1px solid var(--dm-border);
    background: rgba(255,255,255,0.04);
    color: var(--dm-ink-soft);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    transition: all 0.25s var(--dm-ease);
    line-height: 1.4;
  }
  .dm-spread-btn:hover { border-color: var(--dm-gold); color: var(--dm-gold); }
  .dm-spread-btn.active {
    background: linear-gradient(135deg, rgba(233,194,125,0.25), rgba(205,168,110,0.15));
    border-color: var(--dm-gold);
    color: var(--dm-gold);
    box-shadow: 0 0 16px rgba(233,194,125,0.2);
  }
  .dm-spread-btn .num { display: block; font-size: 1.5rem; font-weight: 900; }

  /* ç‰Œå¡è¼¸å…¥åˆ— */
  .dm-card-list { display: flex; flex-direction: column; gap: 12px; }

  .dm-card-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    border-radius: 14px;
    border: 1px solid rgba(233,194,125,0.15);
    background: rgba(255,255,255,0.03);
    transition: all 0.3s;
    animation: fadeSlideIn 0.35s var(--dm-ease) both;
  }
  .dm-card-row:focus-within {
    border-color: var(--dm-gold);
    background: rgba(233,194,125,0.06);
  }

  @keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .dm-card-pos {
    flex-shrink: 0;
    min-width: 120px;
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--dm-gold);
    line-height: 1.4;
  }
  @media (max-width: 480px) {
    .dm-card-pos { min-width: 80px; font-size: 0.75rem; }
    .dm-card-row { flex-wrap: wrap; gap: 8px; }
  }

  .dm-card-input-wrap { flex: 1; display: flex; align-items: center; gap: 8px; min-width: 0; }

  .dm-card-input {
    width: 80px;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.15);
    background: rgba(0,0,0,0.3);
    color: var(--dm-ink);
    font-size: 1.1rem;
    font-weight: 700;
    font-family: "SF Mono","Fira Code",monospace;
    text-align: center;
    letter-spacing: 0.1em;
    transition: border-color 0.3s;
  }
  .dm-card-input::placeholder { color: rgba(255,255,255,0.2); font-weight: 400; font-size: 0.8rem; }
  .dm-card-input:focus { outline: none; border-color: var(--dm-gold); }
  .dm-card-input.valid { border-color: #4caf50; }
  .dm-card-input.invalid { border-color: #f44336; }

  .dm-card-name {
    font-size: 0.88rem;
    color: var(--dm-ink-soft);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 0;
    transition: opacity 0.3s;
  }

  .dm-card-thumb {
    width: 42px;
    height: 42px;
    border-radius: 6px;
    object-fit: cover;
    flex-shrink: 0;
    border: 1px solid rgba(233,194,125,0.2);
    display: none;
  }
  .dm-card-thumb.show { display: block; }

  /* çµæœå€ */
  .dm-result-area { margin-top: 8px; }
  .dm-result-box {
    background: rgba(0,0,0,0.3);
    border: 1px solid rgba(233,194,125,0.2);
    border-radius: 14px;
    padding: 20px;
    font-size: 0.9rem;
    line-height: 1.9;
    color: var(--dm-ink-soft);
    white-space: pre-wrap;
    word-break: break-all;
    max-height: 400px;
    overflow-y: auto;
  }

  /* æŒ‰éˆ• */
  .dm-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
  }

  .dm-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 14px 28px;
    border-radius: 50px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    border: none;
    transition: all 0.25s var(--dm-ease);
    text-decoration: none;
  }
  .dm-btn-gold {
    background: linear-gradient(135deg, var(--dm-gold), var(--dm-gold-deep));
    color: #1a0e05;
  }
  .dm-btn-gold:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(233,194,125,0.3); }
  .dm-btn-gold:disabled { opacity: 0.4; cursor: not-allowed; transform: none; box-shadow: none; }

  .dm-btn-ghost {
    background: transparent;
    color: var(--dm-ink-soft);
    border: 1px solid var(--dm-border);
  }
  .dm-btn-ghost:hover { border-color: var(--dm-gold); color: var(--dm-gold); }

  .dm-btn-line {
    background: #06c755;
    color: #fff;
  }
  .dm-btn-line:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(6,199,85,0.3); }

  /* Toast */
  .dm-toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: rgba(233,194,125,0.95);
    color: #1a0e05;
    padding: 12px 28px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.9rem;
    box-shadow: 0 8px 32px rgba(0,0,0,0.5);
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s var(--dm-ease);
    z-index: 9999;
  }
  .dm-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* æç¤º */
  .dm-hint {
    font-size: 0.82rem;
    color: var(--dm-ink-muted);
    line-height: 1.7;
    margin-top: 8px;
  }

  .dm-divider {
    border: none;
    border-top: 1px solid rgba(233,194,125,0.12);
    margin: 20px 0;
  }

  /* å®Œæˆçµ±è¨ˆ */
  .dm-fill-status {
    text-align: center;
    font-size: 0.85rem;
    color: var(--dm-ink-muted);
    margin-top: 12px;
  }
  .dm-fill-status .done { color: #4caf50; font-weight: 700; }
  .dm-fill-status .total { color: var(--dm-gold); font-weight: 700; }

  /* æå•ç¯„ä¾‹å°è† å›Š */
  .dm-tip {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    border: 1px solid rgba(233,194,125,0.2);
    background: rgba(233,194,125,0.06);
    color: var(--dm-ink-soft);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .dm-tip:hover, .dm-tip:active {
    border-color: var(--dm-gold);
    color: var(--dm-gold);
    background: rgba(233,194,125,0.12);
  }

  /* ç‰Œé™£å ´æ™¯å°å­— */
  .dm-spread-scene {
    display: block;
    font-size: 0.7rem;
    font-weight: 400;
    color: var(--dm-ink-muted);
    margin-top: 4px;
    line-height: 1.3;
  }
</style>
</head>

<body>
<!-- æ˜Ÿç©ºèƒŒæ™¯ -->
<div class="hl-cosmos">
  <div class="hl-stars-layer hl-stars-1"></div>
  <div class="hl-stars-layer hl-stars-2"></div>
  <div class="hl-stars-layer hl-stars-3"></div>
  <div class="hl-meteors"><div class="hl-meteor"></div><div class="hl-meteor"></div><div class="hl-meteor"></div></div>
  <div class="hl-aura hl-aura-1"></div>
  <div class="hl-aura hl-aura-2"></div>
</div>

<div class="dm-toast" id="toast"></div>

<div class="dm-wrap">

  <!-- æ¨™é¡Œ -->
  <div class="dm-glass dm-hero">
    <a href="draw-hl.html" class="dm-back">â† å›åˆ°ç·šä¸ŠæŠ½ç‰Œ</a>
    <h1 class="dm-hero-title">å¯¦é«”ç‰Œå¡è¨˜éŒ„</h1>
    <p class="dm-hero-sub">æ‰‹å‹•è¼¸å…¥æŠ½å‡ºçš„ç‰Œå¡ç·¨è™Ÿ<br>è‡ªå‹•ç”¢ç”Ÿå®Œæ•´é‘°ç›¤çµæœ</p>
  </div>

  <!-- Step 1ï¼šå¯«ä¸‹å•é¡Œ -->
  <div class="dm-glass" id="step1">
    <div class="dm-step-label"><span class="dm-step-num">1</span> å¯«ä¸‹ä½ çš„å•é¡Œ</div>
    <textarea class="dm-question" id="questionInput" placeholder="ä¾‹å¦‚ï¼šæˆ‘ç¾åœ¨æœ€éœ€è¦çŸ¥é“ä»€éº¼ï¼Ÿ&#10;ï¼ˆé¸å¡«ï¼Œä½†å¯«ä¸‹ä¾†è¦ºå¯Ÿå¸«æ›´å¥½å¹«ä½ è§£è®€ï¼‰"></textarea>
    <p class="dm-hint">ğŸ’¡ å•é¡Œå¡«å¯«å¾—è¶Šæ¸…æ¥šè¶Šå¥½ï¼Œæ›´èƒ½çœ‹åˆ°äº‹æƒ…çš„å…¨è²Œï¼Œä¹Ÿèƒ½å¾—åˆ°æ›´è²¼åˆ‡çš„å›è¦†</p>
    <div style="margin-top:8px;display:flex;flex-wrap:wrap;gap:8px;" id="questionTips">
      <span class="dm-tip">æˆ‘æœ€è¿‘å¡å¡çš„ï¼Œæ˜¯å“ªè£¡å‡ºäº†å•é¡Œï¼Ÿ</span>
      <span class="dm-tip">é€™æ®µé—œä¿‚ï¼Œæˆ‘è©²ç¹¼çºŒå—ï¼Ÿ</span>
      <span class="dm-tip">æˆ‘çš„è²¡å‹™ç‹€æ³ï¼Œä¸‹ä¸€æ­¥æ€éº¼èµ°ï¼Ÿ</span>
      <span class="dm-tip">æˆ‘ç¾åœ¨æœ€éœ€è¦çŸ¥é“ä»€éº¼ï¼Ÿ</span>
      <span class="dm-tip">å·¥ä½œè¦ä¸è¦æ›ï¼Ÿ</span>
    </div>
  </div>

  <!-- Step 2ï¼šé¸æ“‡ç‰Œé™£ -->
  <div class="dm-glass" id="step2">
    <div class="dm-step-label"><span class="dm-step-num">2</span> é¸æ“‡é‘°ç›¤ï¼ˆç‰Œé™£ï¼‰</div>
    <div class="dm-spread-grid" id="spreadGrid">
      <button class="dm-spread-btn" data-n="1"><span class="num">1</span>ä»Šæ—¥ä¸€èª<span class="dm-spread-scene">è©¦è©¦çœ‹ / å¿«é€Ÿæ±ºç­–</span></button>
      <button class="dm-spread-btn" data-n="3"><span class="num">3</span>ä¸‰å±¤è¦ºå¯Ÿ<span class="dm-spread-scene">æ„Ÿæƒ… / é¸æ“‡é¡Œ</span></button>
      <button class="dm-spread-btn" data-n="5"><span class="num">5</span>äº”åŠ›å·¡æˆ¿<span class="dm-spread-scene">æ•´é«”ç‹€æ…‹å¿«ç…§</span></button>
      <button class="dm-spread-btn" data-n="7"><span class="num">7</span>ä¸ƒå±¤æ¢ç´¢<span class="dm-spread-scene">æ·±å…¥å–®ä¸€è­°é¡Œ</span></button>
      <button class="dm-spread-btn" data-n="9"><span class="num">9</span>æ´›æ›¸ä¹å®®<span class="dm-spread-scene">å…¨é¢çœ‹æ¸…ä¸€ä»¶äº‹</span></button>
      <button class="dm-spread-btn" data-n="12"><span class="num">12</span>åäºŒå®®<span class="dm-spread-scene">å¹´åº¦è¦åŠƒ / å…¨è§€</span></button>
      <button class="dm-spread-btn" data-n="15"><span class="num">15</span>å¤©è³¦æ ¹æº<span class="dm-spread-scene">å¤©è³¦æ¢ç´¢ / æ·±å±¤</span></button>
      <button class="dm-spread-btn" data-n="21"><span class="num">21</span>å®Œæ•´çŸ©é™£<span class="dm-spread-scene">äººç”Ÿå…¨ç›¤æ ¡æº–</span></button>
    </div>
    <p class="dm-hint">é¸å¥½é‘°ç›¤å¾Œï¼Œä¸‹æ–¹æœƒå‡ºç¾å°æ‡‰çš„ç‰Œä½è¼¸å…¥æ¬„</p>
  </div>

  <!-- Step 3ï¼šè¼¸å…¥ç‰Œå¡ -->
  <div class="dm-glass" id="step3" style="display:none;">
    <div class="dm-step-label"><span class="dm-step-num">3</span> å¡«å…¥æŠ½å‡ºçš„ç‰Œå¡ç·¨è™Ÿ</div>
    <p class="dm-hint" style="margin-bottom:14px;">
      è¦ºå¯ŸæŒ‡å¼•ç‰Œï¼ˆåŸå‹å¡ï¼‰ï¼šA00 ~ A21<br>
      å–®æ–¹ç²¾æ²¹ç‰Œï¼š001 ~ 090<br>
      åŸºåº•æ²¹ç‰Œï¼š091 ~ 095<br>
      è¤‡æ–¹ç²¾æ²¹ç‰Œï¼š096 ~ 108
    </p>
    <div class="dm-card-list" id="cardList"></div>
    <div class="dm-fill-status" id="fillStatus"></div>
  </div>

  <!-- Step 4ï¼šçµæœé è¦½ + è¤‡è£½ -->
  <div class="dm-glass" id="step4" style="display:none;">
    <div class="dm-step-label"><span class="dm-step-num">4</span> é‘°ç›¤çµæœ</div>
    <div class="dm-result-area">
      <div class="dm-result-box" id="resultBox"></div>
    </div>
    <div class="dm-actions">
      <button class="dm-btn dm-btn-gold" id="copyBtn">ğŸ“‹ è¤‡è£½çµæœ</button>
      <a href="https://lin.ee/OQDB5t6" target="_blank" rel="noopener" class="dm-btn dm-btn-line">ğŸ’¬ LINE å‚³çµ¦è¦ºå¯Ÿå¸«</a>
    </div>
  </div>

  <!-- é‡æ–°é–‹å§‹ -->
  <div class="dm-actions" id="resetArea" style="display:none;">
    <button class="dm-btn dm-btn-ghost" id="resetBtn">ğŸ”„ é‡æ–°é–‹å§‹</button>
    <a href="draw-hl.html" class="dm-btn dm-btn-ghost">ğŸ”® æ”¹ç”¨ç·šä¸ŠæŠ½ç‰Œ</a>
  </div>

</div>

<!-- è¼‰å…¥ç‰Œå¡è³‡æ–™ -->
<script src="js/cardData-protected.js"></script>

<script>
// ========== ç‰Œä½åç¨± ==========
var layouts = {
  1: ["âœ¨ ä»Šæ—¥ä¸€èª"],
  3: ["â‘ æµ®å‡ºæ°´é¢", "â‘¡æ°´é¢ä¹‹ä¸‹", "â‘¢é‚£æŠŠé‘°åŒ™"],
  5: ["Lï½œè‡ªæˆ‘ç–¼æƒœç‹€æ…‹", "Iï½œå…§åœ¨æ™ºæ…§åœ¨èªªä»€éº¼", "Gï½œå®‰å…¨æ„Ÿæ ¹åŸº", "Hï½œé—œä¿‚å¹³è¡¡ç‹€æ…‹", "Tï½œæ­£åœ¨ç¶“æ­·çš„çªç ´"],
  7: ["â‘ å…¨æ™¯æƒæ", "â‘¡è¡¨å±¤æ•…äº‹", "â‘¢æš—æµæ¹§å‹•", "â‘£è¦–ç·šä¹‹å¤–", "â‘¤æ‰‹ä¸­ç‹ç‰Œ", "â‘¥å•Ÿå‹•æŒ‡ä»¤", "â‘¦æ·±è™•å¯†èª"],
  9: ["Hï½œèº«é«”åœ¨èªªä»€éº¼", "Oï½œé—œä¿‚ç…§å¦–é¡", "Uï½œè·ŸéŒ¢çš„çœŸå¯¦é—œä¿‚", "Rï½œä¾†é€™ä¸€è¶Ÿçš„ç›®çš„", "Lï½œæœ€æ·±è™•çš„æ ¹æº", "Iï½œä¸æ•¢é¢å°çš„ä¿¡å¿µ", "Gï½œé‡è¤‡ä¸Šæ¼”çš„æ¨¡å¼", "H*ï½œå‡è£æ²’çœ‹è¦‹çš„", "Tï½œé€™ä¸€åˆ‡çš„ç¦®ç‰©"],
  12: ["ç¬¬1é–€ï½œä½ ç«™åœ¨å“ªè£¡", "ç¬¬2é–€ï½œä»€éº¼åœ¨å¬å–šä½ ", "ç¬¬3é–€ï½œä½ åœ¨ä¿è­·ä»€éº¼", "ç¬¬4é–€ï½œèª°åœ¨æ’è‘—ä½ ", "ç¬¬5é–€ï½œä¸æ•¢è·¨çš„é‚£ä¸€æ­¥", "ç¬¬6é–€ï½œè€ƒé©—åœ¨æ•™ä½ ä»€éº¼", "ç¬¬7é–€ï½œé—œä¿‚æ˜ ç…§å‡ºçš„ä½ ", "ç¬¬8é–€ï½œæœ€æ·±çš„é‚£é“å", "ç¬¬9é–€ï½œçè³åœ¨å“ªè£¡ç­‰ä½ ", "ç¬¬10é–€ï½œå¸¶è‘—ä»€éº¼å›ä¾†", "ç¬¬11é–€ï½œè„«èƒæ›éª¨çš„å¥‘æ©Ÿ", "ç¬¬12é–€ï½œä½ æ‹¿åˆ°çš„å¯¶ç‰©"],
  15: ["A1ï½œå¤©ç”Ÿå°±æœƒçš„äº‹", "A2ï½œå¤©è³¦çš„è­‰æ“š", "A3ï½œå¤©è³¦çš„é‚Šç•Œ", "B1ï½œé‚„æ²’å•Ÿå‹•çš„æ½›èƒ½", "B2ï½œæ½›èƒ½çš„é¤Šåˆ†", "B3ï½œåŠ é€Ÿå•Ÿå‹•çš„æ·å¾‘", "C1ï½œä¸€åˆ‡çš„èµ·é»", "C2ï½œæ ¹æºæ­¸å› ", "C3ï½œä¸€ç›´è¿´é¿çš„çœŸç›¸", "D1ï½œå¡ä½ä½ çš„ä¿¡å¿µ", "D2ï½œä¸è‡ªè¦ºçš„ç¿’æ…£", "D3ï½œæ­£åœ¨ä»˜å‡ºçš„ä»£åƒ¹", "E1ï½œç ´å±€ç­–ç•¥", "E2ï½œç¾åœ¨å°±èƒ½åšçš„", "E3ï½œéœ€è¦çš„æ”¯æ´åŠ›é‡"],
  21: ["HÃ—Lï½œèº«å¿ƒæ ¹æº", "HÃ—Iï½œèº«å¿ƒä¿¡å¿µ", "HÃ—Gï½œèº«å¿ƒè¡Œç‚º", "HÃ—Hï½œèº«å¿ƒè¦ºå¯Ÿ", "HÃ—Tï½œèº«å¿ƒç¦®ç‰©", "OÃ—Lï½œé—œä¿‚æ ¹æº", "OÃ—Iï½œé—œä¿‚ä¿¡å¿µ", "OÃ—Gï½œé—œä¿‚è¡Œç‚º", "OÃ—Hï½œé—œä¿‚è¦ºå¯Ÿ", "OÃ—Tï½œé—œä¿‚ç¦®ç‰©", "UÃ—Lï½œè²¡å¯Œæ ¹æº", "UÃ—Iï½œè²¡å¯Œä¿¡å¿µ", "UÃ—Gï½œè²¡å¯Œè¡Œç‚º", "UÃ—Hï½œè²¡å¯Œè¦ºå¯Ÿ", "UÃ—Tï½œè²¡å¯Œç¦®ç‰©", "RÃ—Lï½œå¤©å‘½æ ¹æº", "RÃ—Iï½œå¤©å‘½ä¿¡å¿µ", "RÃ—Gï½œå¤©å‘½è¡Œç‚º", "RÃ—Hï½œå¤©å‘½è¦ºå¯Ÿ", "RÃ—Tï½œå¤©å‘½ç¦®ç‰©", "âœ¦ï½œæ ¸å¿ƒè¨Šæ¯"]
};

// ========== æœ‰æ•ˆå¡è™Ÿæ¸…å–® ==========
var validCodes = [];
// A00-A21
for (var i = 0; i <= 21; i++) validCodes.push('A' + String(i).padStart(2, '0'));
// 001-108
for (var i = 1; i <= 108; i++) validCodes.push(String(i).padStart(3, '0'));

var currentN = 0;
var cardInputs = [];

// ========== DOM ==========
var spreadGrid = document.getElementById('spreadGrid');
var cardList = document.getElementById('cardList');
var step3 = document.getElementById('step3');
var step4 = document.getElementById('step4');
var resetArea = document.getElementById('resetArea');
var resultBox = document.getElementById('resultBox');
var fillStatus = document.getElementById('fillStatus');
var copyBtn = document.getElementById('copyBtn');
var questionInput = document.getElementById('questionInput');

// ========== é¸æ“‡ç‰Œé™£ ==========
spreadGrid.addEventListener('click', function(e) {
  var btn = e.target.closest('.dm-spread-btn');
  if (!btn) return;

  // åˆ‡æ› active
  var allBtns = spreadGrid.querySelectorAll('.dm-spread-btn');
  allBtns.forEach(function(b) { b.classList.remove('active'); });
  btn.classList.add('active');

  currentN = parseInt(btn.dataset.n);
  buildCardInputs(currentN);
  step3.style.display = 'block';
  step4.style.display = 'none';
  resetArea.style.display = 'flex';

  // æ»¾å‹•åˆ° Step 3
  setTimeout(function() {
    step3.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 200);
});

// ========== å»ºç«‹è¼¸å…¥æ¬„ ==========
function buildCardInputs(n) {
  cardList.innerHTML = '';
  cardInputs = [];
  var labels = layouts[n] || [];

  for (var i = 0; i < n; i++) {
    var row = document.createElement('div');
    row.className = 'dm-card-row';
    row.style.animationDelay = (i * 0.06) + 's';

    var posLabel = labels[i] || ('ç¬¬ ' + (i + 1) + ' å¼µ');

    row.innerHTML =
      '<div class="dm-card-pos">' + posLabel + '</div>' +
      '<div class="dm-card-input-wrap">' +
        '<input class="dm-card-input" type="text" placeholder="å¡è™Ÿ" maxlength="3" data-idx="' + i + '" autocomplete="off" inputmode="text">' +
        '<img class="dm-card-thumb" src="" alt="">' +
        '<span class="dm-card-name"></span>' +
      '</div>';

    cardList.appendChild(row);

    var input = row.querySelector('.dm-card-input');
    cardInputs.push(input);

    // äº‹ä»¶
    input.addEventListener('input', handleCardInput);
    input.addEventListener('blur', handleCardInput);
  }

  updateFillStatus();
}

// ========== è™•ç†å¡è™Ÿè¼¸å…¥ ==========
function handleCardInput(e) {
  var input = e.target;
  var val = input.value.trim().toUpperCase();
  input.value = val;

  var row = input.closest('.dm-card-row');
  var nameEl = row.querySelector('.dm-card-name');
  var thumbEl = row.querySelector('.dm-card-thumb');

  if (!val) {
    input.className = 'dm-card-input';
    nameEl.textContent = '';
    thumbEl.classList.remove('show');
    updateFillStatus();
    updateResult();
    return;
  }

  // é©—è­‰
  if (validCodes.indexOf(val) !== -1) {
    input.className = 'dm-card-input valid';

    // é¡¯ç¤ºç‰Œå¡åç¨±
    var info = window.cardData ? window.cardData[val] : null;
    if (info) {
      nameEl.textContent = info.title || info.name || '';
    } else {
      nameEl.textContent = '';
    }

    // é¡¯ç¤ºç¸®åœ–
    thumbEl.src = 'cards/' + val + '.png';
    thumbEl.classList.add('show');
    thumbEl.onerror = function() { this.classList.remove('show'); };

    // è‡ªå‹•è·³åˆ°ä¸‹ä¸€æ ¼
    var idx = parseInt(input.dataset.idx);
    if (idx < cardInputs.length - 1 && val.length >= 3) {
      setTimeout(function() { cardInputs[idx + 1].focus(); }, 150);
    }
  } else {
    input.className = 'dm-card-input invalid';
    nameEl.textContent = 'ï¼Ÿ';
    thumbEl.classList.remove('show');
  }

  updateFillStatus();
  updateResult();
}

// ========== å¡«å…¥çµ±è¨ˆ ==========
function updateFillStatus() {
  var filled = 0;
  cardInputs.forEach(function(inp) {
    if (inp.classList.contains('valid')) filled++;
  });
  fillStatus.innerHTML = 'å·²å¡«å…¥ <span class="done">' + filled + '</span> / <span class="total">' + currentN + '</span> å¼µ';
}

// ========== å³æ™‚æ›´æ–°çµæœ ==========
function updateResult() {
  var filled = 0;
  cardInputs.forEach(function(inp) {
    if (inp.classList.contains('valid')) filled++;
  });

  if (filled === 0) {
    step4.style.display = 'none';
    return;
  }

  step4.style.display = 'block';
  var txt = generateResultText();
  resultBox.textContent = txt;
}

// ========== ç”¢ç”Ÿçµæœæ–‡å­— ==========
function generateResultText() {
  var labels = layouts[currentN] || [];
  var question = questionInput.value.trim();

  var txt = 'ã€é¦¥éˆä¹‹é‘°ï½œå…§åœ¨GPS é‘°ç›¤çµæœã€‘\n';
  txt += 'é‘°ç›¤ï¼š' + currentN + ' å¼µ\n';
  if (question) txt += 'æå•ï¼š' + question + '\n';
  txt += '\n';

  cardInputs.forEach(function(inp, i) {
    var val = inp.value.trim().toUpperCase();
    var posLabel = labels[i] || ('ç¬¬ ' + (i + 1) + ' å¼µ');

    if (validCodes.indexOf(val) !== -1) {
      var info = window.cardData ? window.cardData[val] : {};
      txt += 'â–¸ ' + posLabel + 'ï¼š' + val + ' ' + (info.title || '') + '\n';

      // 1å¼µç‰Œå…è²»ï¼šç›´æ¥é™„ä¸Šè¦ºå¯Ÿèˆ‡è¡Œå‹•æŒ‡å¼•
      if (currentN === 1) {
        var sense = info.sense || info['è¦ºå¯Ÿ'] || '';
        var action = info.action || info['è¡Œå‹•æŒ‡å¼•'] || '';
        if (sense) txt += '\nğŸ’­ è¦ºå¯Ÿï¼š\n' + sense + '\n';
        if (action) txt += '\nâœ¨ è¡Œå‹•æŒ‡å¼•ï¼š\n' + action + '\n';
      }
    } else if (val) {
      txt += 'â–¸ ' + posLabel + 'ï¼š' + val + 'ï¼ˆæœªè¾¨è­˜ï¼‰\n';
    } else {
      txt += 'â–¸ ' + posLabel + 'ï¼šï¼ˆå°šæœªå¡«å…¥ï¼‰\n';
    }
  });

  if (currentN === 1) {
    txt += '\nğŸ’« é€™å¼µç‰Œé»å‡ºäº†ä½ ç¾åœ¨çš„ç‹€æ…‹ï¼Œä½†æ•…äº‹é‚„æ²’èªªå®Œ...\n';
    txt += 'æƒ³çœ‹è¦‹æ›´å®Œæ•´çš„è„ˆçµ¡ï¼Ÿè©¦è©¦ 3 å¼µä»¥ä¸Šçš„é‘°ç›¤\n';
    txt += 'é ç´„é¦¥éˆè¦ºå¯Ÿå¸«æ·±åº¦è§£è®€ ğŸ‘‰ https://lin.ee/OQDB5t6';
  } else {
    txt += '\nğŸ’« æƒ³äº†è§£ç‰Œå¡çš„æ·±å±¤è¨Šæ¯ï¼Ÿ\n';
    txt += 'é ç´„é¦¥éˆè¦ºå¯Ÿå¸«ç‚ºä½ å®Œæ•´è§£è®€ ğŸ‘‰ https://lin.ee/OQDB5t6';
  }

  return txt;
}

// ========== è¤‡è£½ ==========
copyBtn.addEventListener('click', function() {
  var txt = generateResultText();
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt).then(function() {
      showToast('å·²è¤‡è£½ï¼å¯ç›´æ¥è²¼åˆ° LINE çµ¦è¦ºå¯Ÿå¸«');
    });
  } else {
    // fallback
    var ta = document.createElement('textarea');
    ta.value = txt;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    showToast('å·²è¤‡è£½ï¼');
  }
});

// ========== é‡ç½® ==========
document.getElementById('resetBtn').addEventListener('click', function() {
  currentN = 0;
  cardInputs = [];
  cardList.innerHTML = '';
  step3.style.display = 'none';
  step4.style.display = 'none';
  resetArea.style.display = 'none';
  questionInput.value = '';
  fillStatus.innerHTML = '';

  var allBtns = spreadGrid.querySelectorAll('.dm-spread-btn');
  allBtns.forEach(function(b) { b.classList.remove('active'); });

  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// ========== Toast ==========
function showToast(msg) {
  var el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(function() { el.classList.remove('show'); }, 2500);
}

// å•é¡Œè¼¸å…¥ä¹Ÿå³æ™‚æ›´æ–°çµæœ
questionInput.addEventListener('input', updateResult);

// æå•ç¯„ä¾‹é»æ“Šè‡ªå‹•å¡«å…¥
document.getElementById('questionTips').addEventListener('click', function(e) {
  var tip = e.target.closest('.dm-tip');
  if (!tip) return;
  questionInput.value = tip.textContent;
  questionInput.focus();
  updateResult();
});
</script>

<!-- Footer -->
<footer class="hl-footer-lite" style="margin-top:60px;">
  <div class="hl-footer-brand">
    <span class="hl-footer-logo">é¦¥éˆä¹‹é‘°â„¢</span>
    <span class="hl-footer-tagline">Hour Light International</span>
  </div>
  <nav class="hl-footer-links">
    <a href="privacy.html">éš±ç§æ¬Šæ”¿ç­–</a>
    <a href="terms.html">æœå‹™æ¢æ¬¾</a>
    <a href="hourlight-sitemap.html">ç¶²ç«™åœ°åœ–</a>
    <a href="https://lin.ee/OQDB5t6" target="_blank" rel="noopener">LINE è«®è©¢</a>
  </nav>
  <div class="hl-footer-copy">
    Â© 2026 é¦¥éˆä¹‹é‘°åœ‹éš›æœ‰é™å…¬å¸ Hour Light International Co., Ltd. All Rights Reserved.
  </div>
</footer>

</body>
</html>
