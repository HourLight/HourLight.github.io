<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¥éˆç§˜ç¢¼ Master v7.5 - ä¼æ¥­æˆ°ç•¥èˆ‡è¦ªå¯†è§£ç¢¼ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --gold-light: #F5E6A3;
            --night-bg: #1A1A2E;
            --purple: #9F5FDB;
        }
        body { font-family: 'Noto Sans TC', sans-serif; }
        .serif { font-family: 'Noto Serif TC', serif; }
        
        body.day-mode { background: linear-gradient(135deg, #FDF8E8 0%, #F5E6A3 50%, #FDF8E8 100%); color: #4A3728; }
        body.night-mode { background: linear-gradient(135deg, #1A1A2E 0%, #16213E 50%, #0F0F23 100%); color: #E0D4FC; }
        
        .gold-text { color: var(--gold); }
        .night-mode .gold-text { color: #FFD700; text-shadow: 0 0 15px rgba(255,215,0,0.3); }

        .gold-btn {
            background: linear-gradient(135deg, #D4AF37 0%, #F5E6A3 50%, #D4AF37 100%);
            color: #2D1B0E; font-weight: 600; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); transition: all 0.3s;
        }
        .gold-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4); }
        .night-mode .gold-btn { background: linear-gradient(135deg, #6B2C91 0%, #9F5FDB 50%, #6B2C91 100%); color: #fff; }

        .card { backdrop-filter: blur(10px); border-radius: 1rem; transition: all 0.3s; }
        .day-mode .card { background: rgba(255, 255, 255, 0.9); border: 1px solid rgba(212, 175, 55, 0.2); box-shadow: 0 4px 20px rgba(139, 115, 85, 0.1); }
        .night-mode .card { background: rgba(22, 33, 62, 0.9); border: 1px solid rgba(159, 95, 219, 0.3); }

        .tab-btn { transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { border-bottom-color: var(--gold); }
        .night-mode .tab-btn.active { border-bottom-color: var(--purple); }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .timeline-line { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; transform: translateX(-50%); }
        .day-mode .timeline-line { background: linear-gradient(to bottom, #D4AF37, #8B7355); }
        .night-mode .timeline-line { background: linear-gradient(to bottom, #9F5FDB, #4A2C7C); }

        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 100; }
        .master-badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; animation: glow 2s infinite alternate; }
        .day-mode .master-badge { background: linear-gradient(135deg, #D4AF37, #F5E6A3); color: #4A3728; }
        .night-mode .master-badge { background: linear-gradient(135deg, #9F5FDB, #E066FF); color: #1A1A2E; }
        @keyframes glow { from { box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); } to { box-shadow: 0 0 15px rgba(212, 175, 55, 0.8); } }
    </style>
</head>
<body class="day-mode">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // æ ¸å¿ƒè³‡æ–™åº« (The Master Database)
        // ==========================================
        
        const HOURS = [
            { id: 'zi', name: 'å­æ™‚ (23-01)', num: 1 }, { id: 'chou', name: 'ä¸‘æ™‚ (01-03)', num: 2 },
            { id: 'yin', name: 'å¯…æ™‚ (03-05)', num: 3 }, { id: 'mao', name: 'å¯æ™‚ (05-07)', num: 4 },
            { id: 'chen', name: 'è¾°æ™‚ (07-09)', num: 5 }, { id: 'si', name: 'å·³æ™‚ (09-11)', num: 6 },
            { id: 'wu', name: 'åˆæ™‚ (11-13)', num: 7 }, { id: 'wei', name: 'æœªæ™‚ (13-15)', num: 8 },
            { id: 'shen', name: 'ç”³æ™‚ (15-17)', num: 9 }, { id: 'you', name: 'é…‰æ™‚ (17-19)', num: 1 },
            { id: 'xu', name: 'æˆŒæ™‚ (19-21)', num: 11 }, { id: 'hai', name: 'äº¥æ™‚ (21-23)', num: 3 },
            { id: 'unknown', name: 'æ™‚è¾°ä¸è©³', num: 0 }
        ];

        const MASTER_DATA = {
            1: {
                title: 'é ˜èˆªè€…', slogan: 'æˆ‘å‰µé€ ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œä¾è³´ã€èˆ‡ã€ŒæŸ”è»Ÿã€ã€‚çœŸæ­£çš„å¼·è€…æ˜¯æ•¢æ–¼ç¤ºå¼±çš„äººã€‚', wealth: 'é–‹å‰µå‹è²¡é‹ã€‚é©åˆå‰µæ¥­æˆ–æ¥­å‹™ï¼Œæ­£è²¡ç‚ºä¸»ã€‚éŒ¢æ˜¯è³ºå‡ºä¾†çš„ï¼Œä¸æ˜¯å­˜å‡ºä¾†çš„ã€‚', health: 'é ­éƒ¨ã€å¿ƒè‡Ÿã€è¡€å£“ã€‚å£“åŠ›å¤§æ™‚æ˜“åé ­ç—›ã€‚' },
                hr: { archetype: 'é–‹å‰µå…ˆé‹’', slogan: 'ç ´å±€è€…', strengths: ['æ±ºç­–æœæ–·', 'æŠ—å£“æ€§å¼·', 'ç›®æ¨™å°å‘'], weaknesses: ['ç¨æ–·ç¨è¡Œ', 'å¿½ç•¥ç´°ç¯€', 'ç¼ºä¹è€å¿ƒ'], management: 'çµ¦äºˆç›®æ¨™èˆ‡èˆå°ï¼Œå‹¿å¾®è§€ç®¡ç†ã€‚', radar: [5, 5, 2, 3, 2] },
                intimacy: { 
                    type: 'å¾æœå‹æƒ…äºº', 
                    desire: 'æ¸´æœ›è¢«å´‡æ‹œã€è¢«éœ€è¦ï¼Œäº«å—ã€Œè´ã€çš„æ„Ÿè¦ºã€‚', 
                    turnoff: 'å°æ–¹å¤ªå¼·å‹¢ç¡¬ç¢°ç¡¬ï¼Œæˆ–æ˜¯å¤ªé»äººæ²’ä¸»è¦‹ã€‚',
                    manual: 'æ»¿è¶³ä»–çš„è‹±é›„ä¸»ç¾©ã€‚åœ¨å¤–é¢çµ¦è¶³é¢å­ï¼Œå›å®¶ä»–å°±æœƒè®Šå°è²“ã€‚é©æ™‚è®“ä»–ä¸»å°ï¼Œä½†åœ¨é—œéµæ™‚åˆ»è¦å±•ç¾ä½ çš„ç¨ç«‹æ€§ã€‚',
                    secret: 'å¤–è¡¨å¼·å‹¢ï¼Œå…§å¿ƒå…¶å¯¦æ¥µåº¦å®³æ€•è¢«å¦å®šã€‚'
                }
            },
            2: {
                title: 'èª¿å’Œè€…', slogan: 'æˆ‘æ„Ÿå—ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€ŒåŠƒæ¸…ç•Œç·šã€ã€‚ä¸è¦ç‚ºäº†å’Œè«§è€ŒçŠ§ç‰²è‡ªå·±ã€‚', wealth: 'åˆä½œå‹è²¡é‹ã€‚é©åˆåˆå¤¥ã€ä»²ä»‹ã€æœå‹™æ¥­ã€‚é ã€Œäººè„ˆã€é€£çµè³ºéŒ¢ã€‚', health: 'æ¶ˆåŒ–ç³»çµ±ã€æ·‹å·´ã€‚æ˜“å› éåº¦æ•æ„Ÿå°è‡´è…¸èƒƒä¸é©ã€‚' },
                hr: { archetype: 'æ•´åˆè»å¸«', slogan: 'è¶…ç´šè† æ°´', strengths: ['ç´°è†©æ•æ„Ÿ', 'å¼·å¤§å”ä½œ', 'å¯Ÿè¨€è§€è‰²'], weaknesses: ['æ±ºç­–çŒ¶è±«', 'æƒ…ç·’å…§è€—', 'ä¾è³´æ€§å¼·'], management: 'çµ¦äºˆå®‰å…¨æ„Ÿèˆ‡æ­¸å±¬æ„Ÿï¼Œç§ä¸‹è¡¨æšã€‚', radar: [2, 4, 5, 4, 3] },
                intimacy: { 
                    type: 'ä¾è³´å‹æƒ…äºº', 
                    desire: 'æ·±åº¦çš„æƒ…æ„Ÿé€£çµï¼Œç„¡æ™‚ç„¡åˆ»çš„é™ªä¼´èˆ‡åˆ†äº«ã€‚', 
                    turnoff: 'å†·æš´åŠ›ã€å·²è®€ä¸å›ã€å¤§è²å¼å«ã€‚',
                    manual: 'æƒ…æ„Ÿæ¯”æŠ€å·§é‡è¦ã€‚å‰æˆ²è¦é•·ï¼Œå¾Œæˆ²ï¼ˆæ“æŠ±ï¼‰è¦æ›´é•·ã€‚å¤šå•ã€Œä½ çš„æ„Ÿè¦ºå‘¢ï¼Ÿã€ï¼Œè®“ä»–è¦ºå¾—è¢«é‡è¦–ã€‚',
                    secret: 'é›–ç„¶çœ‹èµ·ä¾†å¾ˆé…åˆï¼Œä½†å¿ƒè£¡æœ‰ä¸€æœ¬è©³ç´°çš„ã€Œå§”å±ˆè¨˜å¸³æœ¬ã€ã€‚'
                }
            },
            3: {
                title: 'å‰µé€ è€…', slogan: 'æˆ‘è¡¨é”ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œå°ˆæ³¨ã€èˆ‡ã€Œæ·±å…¥ã€ã€‚ä¸è¦åªåœç•™åœ¨è¡¨é¢çš„å¿«æ¨‚ã€‚', wealth: 'æ‰è¯å‹è²¡é‹ã€‚é å£æ‰ã€å‰µæ„ã€è¡¨æ¼”è³ºéŒ¢ã€‚æ˜“è¡å‹•æ¶ˆè²»ã€‚', health: 'å–‰åš¨ã€å‘¼å¸é“ã€çš®è†šã€‚å£“åŠ›å¤§æ™‚æ˜“éæ•ã€‚' },
                hr: { archetype: 'å‰µæ„ç‡ƒç‡’è€…', slogan: 'æ°£æ°›æ“”ç•¶', strengths: ['å‰µæ„ç„¡é™', 'è¡¨é”åŠ›ä½³', 'é©æ‡‰åŠ›å¼·'], weaknesses: ['è™é ­è›‡å°¾', 'ç¼ºä¹ç´€å¾‹', 'æƒ…ç·’åŒ–'], management: 'çµ¦äºˆèˆå°èˆ‡æŒè²ï¼ŒåŒ…å®¹å…¶å°ä»»æ€§ã€‚', radar: [4, 3, 5, 2, 3] },
                intimacy: { 
                    type: 'éŠæˆ²å‹æƒ…äºº', 
                    desire: 'æ–°é®®æ„Ÿã€é©šå–œã€å¥½ç©ã€‚è¨å­ä¸€æˆä¸è®Šçš„ä¾‹è¡Œå…¬äº‹ã€‚', 
                    turnoff: 'å¤ªåš´è‚…ã€èªªæ•™ã€æ°£æ°›æ²‰é‡ã€‚',
                    manual: 'ä¿æŒå¹½é»˜æ„Ÿã€‚èª¿æƒ…è¦ç”¨ã€Œè¨€èªã€æŒ‘é€—ã€‚ä¸è¦é€¼ä»–çµ¦æ‰¿è«¾ï¼Œè·Ÿä»–ä¸€èµ·ã€Œç©ã€ä»–å°±é›¢ä¸é–‹ä½ ã€‚',
                    secret: 'çœ‹èµ·ä¾†èŠ±å¿ƒï¼Œå…¶å¯¦æ˜¯å› ç‚ºå®³æ€•ç„¡èŠå’Œæ·±å…¥å¾Œçš„è²¬ä»»ã€‚'
                }
            },
            4: {
                title: 'å»ºé€ è€…', slogan: 'æˆ‘å»ºè¨­ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œå½ˆæ€§ã€èˆ‡ã€Œå†’éšªã€ã€‚å®‰å…¨æ„Ÿæ˜¯è‡ªå·±çµ¦çš„ã€‚', wealth: 'ç´¯ç©å‹è²¡é‹ã€‚é©åˆæˆ¿ç”¢ã€å„²è“„ã€‚éŒ¢æ˜¯ä¸€ç£šä¸€ç“¦ç–Šå‡ºä¾†çš„ã€‚', health: 'éª¨éª¼ã€ç‰™é½’ã€é—œç¯€ã€‚æ˜“å› åƒµåŒ–å°è‡´è…°ç— èƒŒç—›ã€‚' },
                hr: { archetype: 'çµæ§‹å®ˆé–€å“¡', slogan: 'ç³»çµ±å»ºé€ è€…', strengths: ['é‚è¼¯åš´è¬¹', 'åŸ·è¡ŒåŠ›å¼·', 'å¿ èª åº¦é«˜'], weaknesses: ['ä¸çŸ¥è®Šé€š', 'æŠ—æ‹’æ”¹è®Š', 'éæ–¼åš´è‚…'], management: 'çµ¦äºˆæ˜ç¢ºè¦å‰‡èˆ‡SOPï¼Œé¿å…æœä»¤å¤•æ”¹ã€‚', radar: [2, 5, 2, 5, 4] },
                intimacy: { 
                    type: 'ç©©å®šå‹æƒ…äºº', 
                    desire: 'æ¥µè‡´çš„å®‰å…¨æ„Ÿï¼Œç¢ºå®šçš„é—œä¿‚ï¼Œå¯¦è³ªçš„æ‰¿è«¾ã€‚', 
                    turnoff: 'æƒ…ç·’åŒ–ã€è®Šä¾†è®Šå»ã€ä¸åˆ‡å¯¦éš›çš„å¹»æƒ³ã€‚',
                    manual: 'ä¸è¦å¤ªå¤šé©šå–œï¼ˆæœƒè®Šæˆé©šåš‡ï¼‰ã€‚å»ºç«‹å›ºå®šçš„è¦ªå¯†å„€å¼ã€‚èª å¯¦æ˜¯æœ€é«˜æŒ‡å°åŸå‰‡ï¼Œèªªè¬Šä¸€æ¬¡å°±å‡ºå±€ã€‚',
                    secret: 'åœ¨åºŠä¸Šæ„å¤–åœ°æŒä¹…ä¸”é‡è¦–æŠ€è¡“æµï¼Œé›–ç„¶ç¼ºä¹æµªæ¼«ä½†å¾ˆå¯¦ç”¨ã€‚'
                }
            },
            5: {
                title: 'è®Šé©è€…', slogan: 'æˆ‘æ¢ç´¢ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œæ‰¿è«¾ã€èˆ‡ã€Œæ‰æ ¹ã€ã€‚åœ¨é™åˆ¶ä¸­æ‰¾åˆ°è‡ªç”±ã€‚', wealth: 'æ©Ÿæœƒå‹è²¡é‹ã€‚é©åˆè²¿æ˜“ã€æ¥­å‹™ã€æŠ•è³‡ã€‚éŒ¢ä¾†å¾—å¿«å»å¾—å¿«ã€‚', health: 'ç¥ç¶“ç³»çµ±ã€è‚ºéƒ¨ã€‚æ˜“å› éåº¦åˆºæ¿€å°è‡´å¤±çœ ã€‚' },
                hr: { archetype: 'è‡ªç”±ç‰¹ç¨®å…µ', slogan: 'å†’éšªå®¶', strengths: ['å±æ©Ÿè™•ç†', 'è«‡åˆ¤éŠ·å”®', 'å¿«é€Ÿå­¸ç¿’'], weaknesses: ['ä¸å—æ§', 'å®¹æ˜“å­å€¦', 'æ‰¿è«¾è·³ç¥¨'], management: 'çµ¦äºˆå½ˆæ€§èˆ‡æŒ‘æˆ°ï¼Œä»¥çµæœç‚ºå°å‘ã€‚', radar: [4, 4, 5, 1, 5] },
                intimacy: { 
                    type: 'æ„Ÿå®˜å‹æƒ…äºº', 
                    desire: 'è‡ªç”±ã€ç©ºé–“ã€å¼·çƒˆçš„æ„Ÿå®˜åˆºæ¿€ã€‚', 
                    turnoff: 'è¢«æ§åˆ¶ã€è¢«æŸ¥å‹¤ã€åƒç¯‡ä¸€å¾‹ã€‚',
                    manual: 'æ”¾é¢¨ç®ç†è«–ï¼šç·šæŠ“åœ¨æ‰‹è£¡ï¼Œè®“ä»–é£›ã€‚å˜—è©¦æ–°å§¿å‹¢ã€æ–°åœ°é»ã€‚ç•¶æœ‹å‹æ¯”ç•¶æƒ…äººæ›´èƒ½ç•™ä½ä»–ã€‚',
                    secret: 'ç”¨æ€§ä¾†é€ƒé¿è¦ªå¯†é—œä¿‚ä¸­çš„è²¬ä»»èˆ‡æŸç¸›ã€‚'
                }
            },
            6: {
                title: 'ç…§é¡§è€…', slogan: 'æˆ‘æ„›ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œæ”¾æ‰‹ã€èˆ‡ã€Œæ„›è‡ªå·±ã€ã€‚å…ˆæ‹¯æ•‘ä½ è‡ªå·±ã€‚', wealth: 'æœå‹™å‹è²¡é‹ã€‚é©åˆé†«ç™‚ã€æ•™è‚²ã€‚éŒ¢æ˜¯ä¼´éš¨æ„›è€Œä¾†çš„å›å ±ã€‚', health: 'å¿ƒè‡Ÿã€è‚©é ¸ã€‚æ˜“å› éåº¦æ‰¿æ“”å°è‡´è‚©è†€æ²‰é‡ã€‚' },
                hr: { archetype: 'å®Œç¾å®ˆè­·è€…', slogan: 'è²¬ä»»æ“”ç•¶', strengths: ['è²¬ä»»æ„Ÿå¼·', 'è§£æ±ºå•é¡Œ', 'é«˜å“è³ªè¦æ±‚'], weaknesses: ['éåº¦æ‰¿æ“”', 'é“å¾·ç¶æ¶', 'å®Œç¾ä¸»ç¾©'], management: 'è‚¯å®šå…¶ä»˜å‡ºï¼Œå¼•å°å…¶é©åº¦æ”¾æ‰‹ã€‚', radar: [3, 4, 4, 4, 3] },
                intimacy: { 
                    type: 'å¥‰ç»å‹æƒ…äºº', 
                    desire: 'è¢«éœ€è¦ã€è¢«æ„Ÿè¬ã€æº«é¦¨çš„å®¶åº­æ„Ÿã€‚', 
                    turnoff: 'æŒ‘å‰”ä»–çš„ä»˜å‡ºã€é«’äº‚çš„ç’°å¢ƒã€ä¸è² è²¬ä»»ã€‚',
                    manual: 'å¤§åŠ›è®šç¾ä»–çš„æœå‹™ã€‚ä¸»å‹•ç‚ºä»–åšé»å°äº‹ï¼ˆä»–æœƒæ„Ÿå‹•å“­ï¼‰ã€‚åœ¨åºŠä¸Šå¤šé—œæ³¨ä»–çš„æ„Ÿå—ï¼Œåˆ¥è®“ä»–åªé¡§è‘—æœå‹™ä½ ã€‚',
                    secret: 'å¦‚æœä½ æ²’æœ‰é”åˆ°ä»–çš„å®Œç¾æ¨™æº–ï¼Œä»–æœƒåœ¨å¿ƒè£¡é»˜é»˜æ‰£åˆ†æ‰£åˆ°é›¶ã€‚'
                }
            },
            7: {
                title: 'æ¢ç´¢è€…', slogan: 'æˆ‘æ€è€ƒï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œä¿¡ä»»ã€èˆ‡ã€Œé–‹æ”¾ã€ã€‚å­¤ç¨ä¸æ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚', wealth: 'å°ˆæ¥­å‹è²¡é‹ã€‚é çŸ¥è­˜ã€æŠ€è¡“ã€é¡§å•è³ºéŒ¢ã€‚é‡è¦–æ™ºæ…§è²¡ç”¢ã€‚', health: 'è…¦ç¥ç¶“ã€è…¿éƒ¨ã€‚æ˜“å› æƒ³å¤ªå¤šå°è‡´ç¥ç¶“ç·Šç¹ƒã€‚' },
                hr: { archetype: 'æˆ°ç•¥åˆ†æå¸«', slogan: 'å†·éœæ™ºå›Š', strengths: ['æ·±åº¦åˆ†æ', 'é‚è¼¯æ¨ç†', 'ç›´è¦ºæ•éŠ³'], weaknesses: ['äººéš›ç–é›¢', 'å¤šç–‘çŒœå¿Œ', 'åˆ†æç™±ç˜“'], management: 'å°Šé‡å°ˆæ¥­èˆ‡éš±ç§ï¼Œçµ¦äºˆç¨è™•ç©ºé–“ã€‚', radar: [3, 3, 2, 4, 5] },
                intimacy: { 
                    type: 'éˆé­‚å‹æƒ…äºº', 
                    desire: 'ç²¾ç¥å…±é³´ï¼Œæ™ºæ€§æˆ€ï¼ˆSapiosexualï¼‰ï¼Œç§å¯†ç©ºé–“ã€‚', 
                    turnoff: 'ç¬¨è›‹ã€è†šæ·ºçš„è©±é¡Œã€éåº¦é»è†©çš„è‚¢é«”æ¥è§¸ã€‚',
                    manual: 'å…ˆæœ‰è…¦äº¤ï¼Œæ‰æœ‰æ€§äº¤ã€‚çµ¦ä»–ç¨è™•çš„æ™‚é–“æ´ç©´ã€‚ä¸è¦é€¼å•ä»–åœ¨æƒ³ä»€éº¼ï¼Œç­‰ä»–æƒ³èªªè‡ªç„¶æœƒèªªã€‚',
                    secret: 'å¤–è¡¨å†·æ¼ ï¼Œå…§å¿ƒå…¶å¯¦æ¸´æœ›é‡åˆ°ä¸€å€‹æ‡‚ä»–æ€ªç™–çš„éˆé­‚ä¼´ä¾¶ã€‚'
                }
            },
            8: {
                title: 'æŒæ¬Šè€…', slogan: 'æˆ‘æŒæ§ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œèª å¯¦ã€èˆ‡ã€Œæ”¾ä¸‹ã€ã€‚æ”¾ä¸‹å°æ§åˆ¶çš„åŸ·è‘—ã€‚', wealth: 'ä¼æ¥­å‹è²¡é‹ã€‚é©åˆé‡‘èã€æŠ•è³‡ã€‚å¤©ç”Ÿå°éŒ¢æ•éŠ³ã€‚', health: 'æ¶ˆåŒ–ç³»çµ±ã€è‚è‡Ÿã€‚æ˜“å› æ‡‰é…¬æˆ–å£“åŠ›éå¤§å°è‡´éå‹ã€‚' },
                hr: { archetype: 'æ¬ŠåŠ›åŸ·è¡Œå®˜', slogan: 'å•†æ¥­æ“ç›¤æ‰‹', strengths: ['è³‡æºæ•´åˆ', 'å®è§€è¦–é‡', 'ç›®æ¨™é”æˆ'], weaknesses: ['æ§åˆ¶ç‹‚', 'åŠŸåˆ©ä¸»ç¾©', 'å¿½ç•¥äººæ€§'], management: 'è«‡åˆ©ç›Šèˆ‡ROIï¼Œçµ¦äºˆæ¬ŠåŠ›èˆ‡é ­éŠœã€‚', radar: [5, 5, 3, 3, 5] },
                intimacy: { 
                    type: 'æŒæ§å‹æƒ…äºº', 
                    desire: 'å¾æœæ„Ÿã€é«˜è³ªé‡çš„æ€§ã€æ¬ŠåŠ›äº¤æ›ã€‚', 
                    turnoff: 'è»Ÿå¼±ã€å„ªæŸ”å¯¡æ–·ã€åœ¨åºŠä¸Šåƒæ­»é­šã€‚',
                    manual: 'å¼·åº¦è¦å¤ ã€‚å¶çˆ¾è®“ä»–å¾¹åº•æŒæ§ï¼Œå¶çˆ¾å±•ç¾ä½ çš„å¼·å‹¢è®“ä»–å¾æœã€‚ä¸è¦è·Ÿä»–ç©çŒœå¿ƒéŠæˆ²ï¼Œç›´æ¥èªªä½ è¦ä»€éº¼ã€‚',
                    secret: 'ç”¨ç‰©è³ªå’Œæ€§ä¾†æ©é£¾è‡ªå·±å…§å¿ƒå°ã€Œå¤±æ§ã€çš„ææ‡¼ã€‚'
                }
            },
            9: {
                title: 'æ™ºè€…', slogan: 'æˆ‘å¥‰ç»ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œè½åœ°ã€èˆ‡ã€Œå°ˆæ³¨ã€ã€‚å¤¢æƒ³è¦æœ‰æ ¹ã€‚', wealth: 'è²æœ›å‹è²¡é‹ã€‚é åè²ã€å…¬ç›Šè³ºéŒ¢ã€‚éš¨ç·£è€Œä¾†ã€‚', health: 'å…¨èº«ç³»çµ±ã€‚æ˜“å—ç’°å¢ƒèƒ½é‡å½±éŸ¿ã€‚' },
                hr: { archetype: 'é¡˜æ™¯å°å¸«', slogan: 'ç²¾ç¥é ˜è¢–', strengths: ['åŒ…å®¹åŠ›å¼·', 'è·¨ç•Œæ€è€ƒ', 'é è¦‹è¦åŠƒ'], weaknesses: ['ä¸åˆ‡å¯¦éš›', 'æƒ…ç·’å‹’ç´¢', 'åŸ·è¡ŒåŠ›å¼±'], management: 'è«‡é¡˜æ™¯èˆ‡æ„ç¾©ï¼Œé€£çµç¤¾æœƒåƒ¹å€¼ã€‚', radar: [4, 2, 5, 3, 4] },
                intimacy: { 
                    type: 'è¶…è„«å‹æƒ…äºº', 
                    desire: 'èº«å¿ƒéˆåˆä¸€ï¼Œèƒ½å¤ ä¸€èµ·æå‡çš„ä¼´ä¾¶ã€‚', 
                    turnoff: 'å¤ªå¸‚å„ˆã€å¤ªè¨ˆè¼ƒã€åªè«‡æŸ´ç±³æ²¹é¹½ã€‚',
                    manual: 'å‰µé€ ç¥è–çš„æ°›åœï¼ˆç²¾æ²¹ã€éŸ³æ¨‚ï¼‰ã€‚ä¸è¦åªæŠŠä»–ç•¶è‚‰é«”ï¼Œè¦é€£çµä»–çš„éˆé­‚ã€‚æ”¯æŒä»–çš„å¤¢æƒ³ã€‚',
                    secret: 'å®¹æ˜“åœ¨é—œä¿‚ä¸­ã€Œè§£é›¢ã€ï¼Œäººåœ¨é€™è£¡ï¼Œå¿ƒä¸çŸ¥é“é£›å»å“ªäº†ã€‚'
                }
            },
            11: {
                title: 'éˆæ€§ç›´è¦ºè€…', slogan: 'æˆ‘æ˜¯é€šé“', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œæ¥åœ°ã€ã€‚å°‡é«˜ç¶­è¨Šæ¯è½‰åŒ–ç‚ºåœ°çƒèªè¨€ã€‚', wealth: 'éˆæ€§è²¡é‹ã€‚é ç›´è¦ºæŠ•è³‡ã€‚', health: 'ç¥ç¶“ç³»çµ±æ¥µåº¦æ•æ„Ÿã€‚' },
                hr: { archetype: 'éˆæ€§å…ˆçŸ¥', slogan: 'ç›´è¦ºé€šé“', strengths: ['è¶…å¼·ç›´è¦º', 'å•Ÿç™¼äººå¿ƒ'], weaknesses: ['ç¥ç¶“è³ª', 'æƒ…ç·’å´©æ½°'], management: 'ä¿è­·é«˜æ•æ„Ÿç‰¹è³ªã€‚', radar: [5, 3, 5, 2, 5] },
                intimacy: { type: 'é›™ç”Ÿç«ç„°å‹', desire: 'éˆé­‚çš„é¡åƒï¼Œçµ•å°çš„ç†è§£ã€‚', turnoff: 'ä½é »èƒ½é‡ã€èªªè¬Šã€‚', manual: 'èª å¯¦æ˜¯å”¯ä¸€è§£ã€‚å‰µé€ æ¥µåº¦å®‰å…¨çš„ç©ºé–“ã€‚', secret: 'ç›´è¦ºæº–åˆ°å¯æ€•ï¼Œåˆ¥æƒ³é¨™ä»–ã€‚' }
            },
            22: {
                title: 'å¤§å¸«å»ºé€ è€…', slogan: 'æˆ‘æ˜¯åŸºçŸ³', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œå¹³è¡¡ã€ã€‚åœ¨å·¨å¤§å£“åŠ›ä¸­æ‰¾åˆ°ç”Ÿæ´»ã€‚', wealth: 'å·¨å¯Œå‹è²¡é‹ã€‚é©åˆè·¨åœ‹ä¼æ¥­ã€‚', health: 'å®¹æ˜“éå‹æ­»ã€‚è‚©é ¸èƒŒéƒ¨å£“åŠ›å¤§ã€‚' },
                hr: { archetype: 'ç¯‰å¤¢å·¨äºº', slogan: 'ç¸½å·¥ç¨‹å¸«', strengths: ['è¶…å¤§æ ¼å±€', 'å‹™å¯¦åŸ·è¡Œ'], weaknesses: ['å£“åŠ›éå‹', 'ç¨è£'], management: 'çµ¦äºˆè¶…å¤§å‹å°ˆæ¡ˆã€‚', radar: [5, 5, 3, 5, 5] },
                intimacy: { type: 'å¸åœ‹å‹æƒ…äºº', desire: 'å»ºç«‹å…±åŒçš„ç‹æœã€‚', turnoff: 'ç›®å…‰çŸ­æ·ºã€‚', manual: 'åšä»–æœ€å¼·çš„å¾Œç›¾ã€‚', secret: 'å·¥ä½œå°±æ˜¯ä»–çš„æ„›äººã€‚' }
            },
            33: {
                title: 'å¤§å¸«ç™‚ç™’è€…', slogan: 'æˆ‘æ˜¯æ„›', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œä¸åŸ·è‘—ã€ã€‚æ„›æ˜¯æµå‹•çš„ã€‚', wealth: 'ç¦å ±å‹è²¡é‹ã€‚', health: 'å¿ƒè‡Ÿè² è·å¤§ã€‚' },
                hr: { archetype: 'å¤§æ„›ç™‚ç™’å¸«', slogan: 'è¶…ç´šå°å¸«', strengths: ['æ¥µè‡´åˆ©ä»–', 'å‡èšåœ˜éšŠ'], weaknesses: ['çƒˆå£«æƒ…çµ', 'æ¯«ç„¡ç•Œç·š'], management: 'å¼·åˆ¶ä¼‘æ¯ã€‚', radar: [3, 4, 5, 4, 3] },
                intimacy: { type: 'è–æ¯å‹æƒ…äºº', desire: 'ç„¡æ¢ä»¶çš„æ„›èˆ‡æ¥ç´ã€‚', turnoff: 'è‡ªç§è‡ªåˆ©ã€‚', manual: 'æ•™æœƒä»–æ¥å—æ„›ï¼Œè€Œä¸åªæ˜¯çµ¦äºˆã€‚', secret: 'ç‚ºäº†æ„›å¯ä»¥çŠ§ç‰²ä¸€åˆ‡ï¼ŒåŒ…å«è‡ªå·±ã€‚' }
            }
        };

        const YEAR_STRATEGY = {
            1: { keyword: 'æ’­ç¨®', action: 'å•Ÿå‹•æ–°è¨ˆç•«ã€å‹‡æ•¢å†’éšªã€ç¨ç«‹ä½œæ¥­', caution: 'çŒ¶è±«ä¸æ±ºã€ä¾è³´ä»–äºº', okr: 'è¨­å®šæœªä¾†9å¹´å¤§ç›®æ¨™' },
            2: { keyword: 'é€£çµ', action: 'å»ºç«‹åˆä½œã€è€å¿ƒç­‰å¾…ã€ç´°ç¯€å„ªåŒ–', caution: 'è¡å‹•æ±ºç­–ã€å–®æ‰“ç¨é¬¥', okr: 'æ“´å±•æ ¸å¿ƒäººè„ˆåœˆ' },
            3: { keyword: 'ç¶»æ”¾', action: 'ç¤¾äº¤å…¬é—œã€å‰µæ„ç™¼è¡¨ã€å±•ç¾è‡ªæˆ‘', caution: 'æƒ…ç·’å¤±æ§ã€è™é ­è›‡å°¾', okr: 'æå‡å€‹äººå“ç‰Œèƒ½è¦‹åº¦' },
            4: { keyword: 'æ‰æ ¹', action: 'å»ºç«‹åˆ¶åº¦ã€è²¡å‹™è¦åŠƒã€å­¸ç¿’é€²ä¿®', caution: 'æŠ•æ©Ÿå–å·§ã€é »ç¹è®Šå‹•', okr: 'å»ºæ§‹ç©©å®šè¢«å‹•æ”¶å…¥ç³»çµ±' },
            5: { keyword: 'è½‰æŠ˜', action: 'è·¨ç•Œå˜—è©¦ã€è¡ŒéŠ·æ¨å»£ã€é©æ‡‰è®ŠåŒ–', caution: 'éåº¦æ‰¿è«¾ã€æ²ˆè¿·ç©æ¨‚', okr: 'é–‹æ‹“å…¨æ–°å¸‚å ´æˆ–æŠ€èƒ½' },
            6: { keyword: 'æ‰¿æ“”', action: 'æœå‹™å®¢æˆ¶ã€ç…§é¡§å®¶åº­ã€è§£æ±ºå•é¡Œ', caution: 'æŒ‘å‰”å®Œç¾ã€æŠ±æ€¨çŠ§ç‰²', okr: 'å„ªåŒ–å®¢æˆ¶/å®¶åº­æ»¿æ„åº¦' },
            7: { keyword: 'å…§çœ', action: 'ç¨è™•æ€è€ƒã€å°ˆæ¥­æ·±é€ ã€ç­–ç•¥ä½ˆå±€', caution: 'å¼·è¡Œå¤–æ±‚ã€ç›²ç›®ç¤¾äº¤', okr: 'å–å¾—å°ˆæ¥­èªè­‰æˆ–æ·±åº¦æ´å¯Ÿ' },
            8: { keyword: 'è±æ”¶', action: 'å•†æ¥­è«‡åˆ¤ã€è³‡æºæ•´åˆã€çµæœå°å‘', caution: 'è²ªå©ªæ§åˆ¶ã€é•æ³•é‚Šç·£', okr: 'ç‡Ÿæ”¶èˆ‡è³‡ç”¢æœ€å¤§åŒ–' },
            9: { keyword: 'æ–·æ¨é›¢', action: 'æ¸…ç†èˆŠç‰©ã€çµæŸé—œä¿‚ã€èº«å¿ƒæ’æ¯’', caution: 'åŸ·è‘—éå»ã€é–‹å•Ÿæ–°å±€', okr: 'å®Œæˆæœªç«Ÿäº‹å‹™ï¼Œæ¸…ç©ºæ­¸é›¶' },
            11: { keyword: 'è¦ºé†’', action: 'è·Ÿéš¨ç›´è¦ºã€éˆæ€§å­¸ç¿’', caution: 'ç¥ç¶“ç·Šå¼µ', okr: 'éˆæ€§å±¤æ¬¡èºå‡' },
            22: { keyword: 'ç¯‰å¤¢', action: 'è½å¯¦å¤§é¡˜æ™¯', caution: 'å£“åŠ›å´©æ½°', okr: 'å®Œæˆä¸å¯èƒ½çš„ä»»å‹™' },
            33: { keyword: 'å¥‰ç»', action: 'ç™‚ç™’çœ¾ç”Ÿ', caution: 'è‡ªæˆ‘çŠ§ç‰²', okr: 'æˆç‚ºä»–äººçš„å…‰' }
        };

        const PALACE_DATA = {
            1: { name: 'å‹‡æ°£æ®¿', meridian: 'è†½ç¶“', theme: 'æˆ‘æ•¢ä¸æ•¢åšè‡ªå·±ï¼Ÿ', oils: ['è–‘', 'é»‘èƒ¡æ¤’'] },
            2: { name: 'åŠ›é‡å»³', meridian: 'è‚ç¶“', theme: 'æˆ‘çš„åŠ›é‡å¡åœ¨å“ªï¼Ÿ', oils: ['ä½›æ‰‹æŸ‘', 'è–„è·'] },
            3: { name: 'å‘Šåˆ¥è‹‘', meridian: 'è‚ºç¶“', theme: 'æˆ‘æ”¾ä¸ä¸‹ä»€éº¼ï¼Ÿ', oils: ['çµ²æŸ', 'ä¹³é¦™'] },
            4: { name: 'æ·¨åŒ–å®¤', meridian: 'å¤§è…¸ç¶“', theme: 'æˆ‘è©²ä¸Ÿæ‰ä»€éº¼ï¼Ÿ', oils: ['æª¸æª¬', 'èŒ¶æ¨¹'] },
            5: { name: 'æ¶ˆåŒ–é–£', meridian: 'èƒƒç¶“', theme: 'æˆ‘æ¶ˆåŒ–ä¸äº†ä»€éº¼ï¼Ÿ', oils: ['ç”œæ©™', 'è–‘'] },
            6: { name: 'ä¿¡ä»»æ®¿', meridian: 'è„¾ç¶“', theme: 'æˆ‘æƒ³å¤ªå¤šä»€éº¼ï¼Ÿ', oils: ['æª€é¦™', 'å²©è˜­è‰'] },
            7: { name: 'å¿ƒé–€å®®', meridian: 'å¿ƒç¶“', theme: 'æˆ‘æ¸´æœ›ä»€éº¼æ„›ï¼Ÿ', oils: ['ç«ç‘°', 'ä¾è˜­'] },
            8: { name: 'æ˜è¾¨å»³', meridian: 'å°è…¸ç¶“', theme: 'æˆ‘åˆ†ä¸æ¸…ä»€éº¼ï¼Ÿ', oils: ['è¿·è¿­é¦™', 'ç¾…å‹’'] },
            9: { name: 'å¸è¼‰è‹‘', meridian: 'è†€èƒ±ç¶“', theme: 'æˆ‘æ‰›è‘—ä»€éº¼ï¼Ÿ', oils: ['è–°è¡£è‰', 'é¦¬é¬±è˜­'] },
            10: { name: 'å¿—æ°£æ®¿', meridian: 'è…ç¶“', theme: 'æˆ‘å®³æ€•ä»€éº¼ï¼Ÿ', oils: ['é›ªæ¾', 'æ²’è—¥'] },
            11: { name: 'æ•é–‹é–£', meridian: 'å¿ƒåŒ…ç¶“', theme: 'æˆ‘åœ¨ä¿è­·ä»€éº¼ï¼Ÿ', oils: ['ç«ç‘°è‰', 'æ©™èŠ±'] },
            12: { name: 'å¹³è¡¡å®¤', meridian: 'ä¸‰ç„¦ç¶“', theme: 'æˆ‘å“ªè£¡ä¸å¹³è¡¡ï¼Ÿ', oils: ['å¤©ç«ºè‘µ', 'èŠ±æ¢¨æœ¨'] }
        };

        // ==========================================
        // é‚è¼¯å±¤ (Logic Layer)
        // ==========================================

        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzlPM5yIuAlrQKbYa01bysqxYo3woLAfp1Tc0Ebk8-W4_3KiUfipUx9Li-10YTw2voIVA/exec';
        
        const logToSheet = (data) => {
            try {
                const img = new Image();
                img.src = `${SHEET_URL}?birthday=${data.year}-${data.month}-${data.day}&hour=${data.hourId}&source=MasterV7.5`;
            } catch(e) { console.error('Log failed'); }
        };

        const reduceToSingle = (num) => {
            while (num > 9) num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            return num;
        };
        const reduceNumber = (num) => {
            if ([11, 22, 33].includes(num)) return num;
            while (num > 9) {
                num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                if ([11, 22, 33].includes(num)) return num;
            }
            return num;
        };
        const getBaseNum = (num) => MASTER_DATA[num] ? num : reduceToSingle(num);
        const getData = (num) => MASTER_DATA[num] || MASTER_DATA[reduceToSingle(num)] || MASTER_DATA[1];

        const calculateHourLight = (data) => {
            logToSheet(data); // è‡ªå‹•è¨˜éŒ„
            const { year, month, day, lunarMonth, lunarDay, hourId } = data;
            const hourValue = HOURS.find(h => h.id === hourId)?.num || 0;
            
            const hNum = reduceNumber(parseInt(lunarMonth) + parseInt(lunarDay));
            const oNumRaw = String(year) + String(month).padStart(2, '0') + String(day).padStart(2, '0');
            const oNum = reduceNumber(oNumRaw.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const uNum = hourValue || 0;
            const rNum = uNum ? reduceNumber(hNum + oNum + uNum) : reduceNumber(hNum + oNum);

            const lNum = parseInt(lunarMonth) > 9 ? reduceNumber(parseInt(lunarMonth)) : parseInt(lunarMonth);
            const gNum = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const hEnergyNum = parseInt(lunarDay) > 9 ? reduceNumber(parseInt(lunarDay)) : parseInt(lunarDay);
            const tNum = reduceNumber(lNum + (uNum || 5) + gNum + hEnergyNum);

            const yearStr = String(year);
            const lastTwo = parseInt(yearStr.slice(-2));
            const p2Num = reduceNumber(Math.floor(lastTwo / 10) + (lastTwo % 10));
            
            const palaces = {
                1: getBaseNum(hNum), 2: p2Num, 3: parseInt(month) > 9 ? reduceNumber(parseInt(month)) : parseInt(month), 
                4: parseInt(day) > 9 ? reduceNumber(parseInt(day)) : parseInt(day),
                5: lNum, 6: hEnergyNum, 7: getBaseNum(oNum), 8: gNum,
                9: parseInt(yearStr.charAt(yearStr.length - 3)) || 9, 10: uNum || 5, 11: tNum, 12: getBaseNum(rNum)
            };

            return { inputData: { ...data, hourValue }, hour: { h: hNum, o: oNum, u: uNum, r: rNum }, palaces };
        };

        const calculateYearFortune = (rNum, year) => {
            const universeYear = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const personalYear = reduceNumber(getBaseNum(rNum) + universeYear);
            const data = YEAR_STRATEGY[personalYear] || YEAR_STRATEGY[reduceToSingle(personalYear)];
            return { universeYear, personalYear, ...data };
        };

        // ==========================================
        // UI çµ„ä»¶
        // ==========================================

        const MasterBadge = ({ num }) => {
            if (![11, 22, 33].includes(num)) return null;
            return <span className="master-badge ml-2">{num === 11 ? 'âœ¨ ç›´è¦ºå¤§å¸«' : num === 22 ? 'ğŸ›ï¸ å»ºé€ å¤§å¸«' : 'ğŸ’• ç™‚ç™’å¤§å¸«'}</span>;
        };

        const RadarChart = ({ data, labels, isNight, title }) => {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);
            useEffect(() => {
                if (!chartRef.current) return;
                if (chartInstance.current) chartInstance.current.destroy();
                const ctx = chartRef.current.getContext('2d');
                const color = isNight ? 'rgba(159, 95, 219, ' : 'rgba(212, 175, 55, ';
                chartInstance.current = new Chart(ctx, {
                    type: 'radar',
                    data: { labels, datasets: [{ label: title, data, backgroundColor: color + '0.25)', borderColor: color + '1)', pointBackgroundColor: color + '1)', borderWidth: 2, pointRadius: 4 }] },
                    options: { scales: { r: { suggestedMin: 0, suggestedMax: 5, ticks: { display: false } } }, plugins: { legend: { display: false } }, maintainAspectRatio: false }
                });
            }, [data, labels, isNight]);
            return <div className="w-full h-64"><canvas ref={chartRef} /></div>;
        };

        const InputForm = ({ onCalculate }) => {
            const [formData, setFormData] = useState({ name: '', year: '', month: '1', day: '1', lunarMonth: '', lunarDay: '', hourId: '' });
            return (
                <div className="card p-6 fade-in max-w-xl mx-auto">
                    <h3 className="text-xl font-bold gold-text mb-4 serif text-center">é–‹å•Ÿä½ çš„å…§åœ¨åŸå ¡</h3>
                    <div className="space-y-4">
                        <input type="text" placeholder="å§“åï¼ˆé¸å¡«ï¼‰" className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.name} onChange={e=>setFormData({...formData, name:e.target.value})} />
                        <div className="grid grid-cols-3 gap-2">
                            <input type="number" placeholder="è¥¿å…ƒå¹´" className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.year} onChange={e=>setFormData({...formData, year:e.target.value})} />
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.month} onChange={e=>setFormData({...formData, month:e.target.value})}>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.day} onChange={e=>setFormData({...formData, day:e.target.value})}>{Array.from({length:31},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <div className="grid grid-cols-2 gap-2">
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarMonth} onChange={e=>setFormData({...formData, lunarMonth:e.target.value})}><option value="">è¾²æ›†æœˆ</option>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarDay} onChange={e=>setFormData({...formData, lunarDay:e.target.value})}><option value="">è¾²æ›†æ—¥</option>{Array.from({length:30},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <select className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.hourId} onChange={e=>setFormData({...formData, hourId:e.target.value})}><option value="">æ™‚è¾°ï¼ˆé¸å¡«ï¼‰</option>{HOURS.map(h=><option key={h.id} value={h.id}>{h.name}</option>)}</select>
                        <button onClick={()=>formData.year&&formData.lunarMonth&&formData.lunarDay?onCalculate(formData):alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™')} className="w-full gold-btn py-3 rounded-lg font-bold">é–‹å§‹è§£ç¢¼</button>
                    </div>
                </div>
            );
        };

        // é é¢ 1: åŸºç¤ç›¤ (éˆé­‚è—åœ–)
        const BasicDeepPage = ({ result, isNight }) => {
            const { hour, palaces } = result;
            const core = getData(hour.h);
            const outer = getData(hour.o);
            
            const copyBasicReport = () => {
                const text = `ã€é¦¥éˆç§˜ç¢¼ v7.5 éˆé­‚è—åœ–å ±å‘Šã€‘\n` +
                    `å§“åï¼š${result.inputData.name || 'è«®è©¢è€…'}\n` +
                    `H.O.U.R. å¯†ç¢¼ï¼š\n` +
                    `H${hour.h} (éˆé­‚æœ¬è³ª) - ${core.title}\n` +
                    `O${hour.o} (å¤–åœ¨å±•ç¾) - ${outer.title}\n` +
                    `U${hour.u} (å…§åœ¨é©…å‹•)\n` +
                    `R${hour.r} (äººéš›è§’è‰²)\n\n` +
                    `ã€éˆé­‚èª²é¡Œã€‘\n${core.basic.lesson}\n\n` +
                    `ã€é‡‘éŒ¢è§€ã€‘\n${core.basic.wealth}\n\n` +
                    `ã€å¥åº·å¼±é»ã€‘\n${core.basic.health}\n\n` +
                    `ã€12å®®èƒ½é‡åˆ†ä½ˆã€‘\n` +
                    Object.entries(palaces).map(([p, n]) => `${p}å®®:${n}`).join(', ') +
                    `\n\næ­¤å ±å‘Šç”± é¦¥éˆç§˜ç¢¼ Hour Light ç³»çµ±ç”Ÿæˆ`;
                navigator.clipboard.writeText(text);
                alert('éˆé­‚è—åœ–å ±å‘Šå·²è¤‡è£½ï¼');
            };

            return (
                <div className="space-y-8 fade-in">
                    <div className={`card p-8 text-center relative overflow-hidden ${isNight ? 'bg-gradient-to-r from-purple-900/50 to-indigo-900/50' : 'bg-gradient-to-r from-amber-50 to-orange-50'}`}>
                        <div className="relative z-10">
                            <div className="inline-block px-3 py-1 rounded-full bg-amber-500 text-white text-xs mb-2 tracking-widest">SOUL BLUEPRINT</div>
                            <h2 className="text-4xl font-bold gold-text serif mb-2">éˆé­‚ä½¿ç”¨èªªæ˜æ›¸</h2>
                            <p className="opacity-70 mb-6">H{hour.h} . O{hour.o} . U{hour.u} . R{hour.r}</p>
                            <div className="grid grid-cols-2 gap-4 text-left bg-white/10 p-6 rounded-xl backdrop-blur-sm">
                                <div><div className="text-xs opacity-50 mb-1">éˆé­‚æœ¬è³ª (H{hour.h})</div><div className="font-bold text-lg">{core.title}</div><div className="text-sm opacity-80">{core.slogan}</div></div>
                                <div><div className="text-xs opacity-50 mb-1">å¤–åœ¨å±•ç¾ (O{hour.o})</div><div className="font-bold text-lg">{outer.title}</div><div className="text-sm opacity-80">{outer.slogan}</div></div>
                            </div>
                        </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-6 border-l-4 border-amber-500"><h3 className="text-xl font-bold gold-text mb-4 serif">ğŸ“ äººç”Ÿèª²é¡Œ</h3><p className="text-lg font-bold mb-2">{core.basic.lesson}</p><p className="opacity-70 text-sm">é€™æ˜¯ä½ éˆé­‚é¸æ“‡ä¾†åœ°çƒé«”é©—çš„å¿…ä¿®èª²ã€‚</p></div>
                        <div className="card p-6 border-l-4 border-green-500"><h3 className="text-xl font-bold text-green-600 mb-4 serif">ğŸ’° é‡‘éŒ¢è§€</h3><p className="text-md leading-relaxed">{core.basic.wealth}</p></div>
                        <div className="card p-6 border-l-4 border-red-500"><h3 className="text-xl font-bold text-red-500 mb-4 serif">â¤ï¸â€ğŸ©¹ å¥åº·å¼±é»</h3><p className="text-md leading-relaxed">{core.basic.health}</p></div>
                        <div className="card p-6 border-l-4 border-purple-500"><h3 className="text-xl font-bold text-purple-500 mb-4 serif">ğŸ° 12å®®ä½èƒ½é‡</h3><div className="grid grid-cols-3 gap-2 text-center text-xs">{Object.entries(palaces).map(([id, num]) => (<div key={id} className="p-2 bg-gray-100 dark:bg-gray-800 rounded"><div className="opacity-50">{id}å®®</div><div className="font-bold text-lg gold-text">{num}</div></div>))}</div></div>
                    </div>
                    <button onClick={copyBasicReport} className="w-full py-4 rounded-xl gold-btn text-lg shadow-lg flex items-center justify-center gap-2">ğŸ“‹ è¤‡è£½éˆé­‚è—åœ–å ±å‘Š</button>
                </div>
            );
        };

        // é é¢ 2: HR æˆ°ç•¥ç‰ˆ
        const HRDeepPage = ({ result, isNight }) => {
            const { h, o, u, r } = result.hour;
            const hr = getData(o).hr;
            const consistency = getBaseNum(o) === getBaseNum(u) ? "è¡¨è£¡å¦‚ä¸€ï¼Œç©©å®šæ€§é«˜ã€‚" : `å…§å¤–æ‹‰æ‰¯ï¼Œå¤–é¡¯${o}ä½†å…§åœ¨${u}ï¼Œéœ€çµ¦äºˆå¿ƒç†è£œå„Ÿã€‚`;
            const copyReport = () => {
                const text = `ã€é¦¥éˆç§˜ç¢¼ HR æˆ°ç•¥å ±å‘Šã€‘\nå§“åï¼š${result.inputData.name}\nä»£ç¢¼ï¼šH${h}.O${o}.U${u}.R${r}\nåŸå‹ï¼š${hr.archetype}\n\nã€æˆ°åŠ›ã€‘\nå„ªå‹¢ï¼š${hr.strengths.join('ã€')}\né¢¨éšªï¼š${hr.weaknesses.join('ã€')}\n\nã€ç®¡ç†ã€‘\næ¿€å‹µï¼š${hr.management}\næ´å¯Ÿï¼š${consistency}`;
                navigator.clipboard.writeText(text); alert('å ±å‘Šå·²è¤‡è£½ï¼');
            };
            return (
                <div className="space-y-8 fade-in">
                    <div className="card p-8 text-center bg-blue-50 dark:bg-blue-900/20"><h2 className="text-3xl font-bold gold-text serif">{hr.archetype}</h2><p className="opacity-80 mt-2">ã€Œ{hr.slogan}ã€</p></div>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="space-y-6">
                            <div className="card p-6"><h4 className="font-bold mb-4">ğŸ“Š æˆ°åŠ›é›·é”</h4><RadarChart data={hr.radar} labels={['é–‹å‰µ', 'åŸ·è¡Œ', 'æºé€š', 'ç©©å®š', 'è¬€ç•¥']} isNight={isNight} title="è·å ´æˆ°åŠ›" /></div>
                            <div className="card p-6"><h4 className="font-bold text-green-600 mb-2">âœ… å„ªå‹¢</h4><div className="flex flex-wrap gap-2">{hr.strengths.map(s=><span key={s} className="px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm">âœ“ {s}</span>)}</div></div>
                        </div>
                        <div className="space-y-6">
                            <div className="card p-6 border-l-4 border-gold"><h3 className="text-xl font-bold mb-4">ğŸ“– ç®¡ç†æ‰‹å†Š</h3><p className="mb-4">{hr.management}</p><div className="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded text-sm text-yellow-800 dark:text-yellow-200">ğŸ’¡ äº¤å‰æ´å¯Ÿï¼š{consistency}</div></div>
                            <button onClick={copyReport} className="w-full py-4 rounded-xl gold-btn text-lg shadow-lg">ğŸ“‹ è¤‡è£½å°ˆæ¥­å ±å‘Š</button>
                        </div>
                    </div>
                </div>
            );
        };

        // é é¢ 3: è¦ªå¯†æŒ‡å— (é‡ç£…å›æ­¸ç‰ˆ)
        const IntimacyDeepPage = ({ result }) => {
            const data = getData(result.hour.o).intimacy;
            return (
                <div className="space-y-8 fade-in max-w-2xl mx-auto">
                    <div className="card p-8 text-center bg-gradient-to-br from-pink-900/80 to-purple-900/80 border border-pink-500/30 shadow-[0_0_30px_rgba(236,72,153,0.3)]">
                        <div className="text-6xl mb-4 animate-pulse">ğŸ’‹</div>
                        <h2 className="text-3xl font-bold text-pink-300 serif mb-2">æ·±å¤œè¦ªå¯†æŒ‡å—</h2>
                        <p className="text-pink-100/70">è§£é– Oæ•¸ {result.hour.o} çš„æ„›æ…¾å¯†ç¢¼</p>
                    </div>
                    
                    <div className="card p-6 border-l-4 border-pink-500 bg-pink-900/20">
                        <h4 className="text-xl font-bold text-pink-400 mb-3">ğŸ­ æ„›æƒ…åŸå‹ï¼š{data.type}</h4>
                        <p className="text-gray-300 leading-relaxed">{data.desire}</p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="card p-6 bg-red-900/20 border-t-4 border-red-500">
                            <h4 className="font-bold text-red-400 mb-2">ğŸš« çµ•å°åœ°é›· (Turn-offs)</h4>
                            <p className="text-gray-400 text-sm">{data.turnoff}</p>
                        </div>
                        <div className="card p-6 bg-purple-900/20 border-t-4 border-purple-500">
                            <h4 className="font-bold text-purple-400 mb-2">ğŸ¤« å…§å¿ƒç§˜å¯† (Secret)</h4>
                            <p className="text-gray-400 text-sm">{data.secret}</p>
                        </div>
                    </div>

                    <div className="card p-6 border-2 border-gold bg-gradient-to-r from-gray-900 to-black">
                        <h4 className="text-xl font-bold text-gold mb-4 text-center serif">ğŸ”¥ èª¿æ•™èˆ‡ä½¿ç”¨æ‰‹å†Š</h4>
                        <p className="text-gray-300 leading-loose text-justify">{data.manual}</p>
                    </div>
                </div>
            );
        };

        // é é¢ 4: æµå¹´æˆ°ç•¥
        const YearDeepPage = ({ result, isNight }) => {
            const [year, setYear] = useState(new Date().getFullYear());
            const fortune = calculateYearFortune(result.hour.r, year);
            return (
                <div className="max-w-2xl mx-auto space-y-6 fade-in">
                    <div className="card p-6 flex justify-center gap-4">{[year-1, year, year+1].map(y=><button key={y} onClick={()=>setYear(y)} className={`px-4 py-2 rounded ${year===y?'gold-btn':'bg-gray-200 text-gray-700'}`}>{y}</button>)}</div>
                    <div className={`card p-8 text-center ${isNight ? 'bg-purple-900/30' : 'bg-orange-50'}`}><div className="text-7xl font-bold gold-text my-4">{fortune.personalYear}</div><div className="text-3xl font-bold serif">{fortune.keyword}å¹´</div></div>
                    <div className="card p-6 border-l-4 border-blue-500"><h4 className="font-bold text-blue-600 mb-2">ğŸ¯ å¹´åº¦æˆ°ç•¥ OKR</h4><p className="font-bold text-lg">{fortune.okr}</p></div>
                    <div className="grid grid-cols-2 gap-4"><div className="card p-4"><h4 className="font-bold text-green-600">âœ… Do's</h4><p className="text-sm">{fortune.action}</p></div><div className="card p-4"><h4 className="font-bold text-red-600">ğŸš« Don'ts</h4><p className="text-sm">{fortune.caution}</p></div></div>
                </div>
            );
        };

        // é é¢ 5: åˆç›¤
        const CompatPage = ({ result }) => {
            const [resB, setResB] = useState(null);
            return (
                <div className="max-w-4xl mx-auto space-y-6 fade-in">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-4 text-center"><div className="mb-2 gold-text">Aæ–¹ (ä½ )</div><div className="text-xl font-bold">H{result.hour.h} O{result.hour.o}</div></div>
                        <div><div className="text-center mb-2 gold-text">Bæ–¹ (å°æ–¹)</div>{resB ? <div className="card p-4 text-center"><div className="text-xl font-bold">H{resB.hour.h} O{resB.hour.o}</div><button onClick={()=>setResB(null)} className="text-xs opacity-50 mt-2">é‡è¨­</button></div> : <div className="card p-4"><input type="number" placeholder="Bæ–¹è¥¿å…ƒå¹´" className="w-full p-2 border mb-2 rounded" id="b-year" /><button onClick={()=>{ const y=document.getElementById('b-year').value; if(y) setResB(calculateHourLight({year:y, month:1, day:1, lunarMonth:1, lunarDay:1, hourId:'zi'})) }} className="w-full gold-btn py-2 rounded text-sm">å¿«é€Ÿè¨ˆç®— (ç°¡æ˜“ç‰ˆ)</button></div>}</div>
                    </div>
                    {resB && <div className="card p-8 text-center"><h3 className="text-2xl font-bold mb-4">é—œä¿‚åŒ–å­¸åæ‡‰</h3><p className="text-lg">Oæ•¸ {result.hour.o} vs {resB.hour.o}</p><p className="mt-4 text-sm opacity-70">Aæ–¹éœ€æ±‚ï¼š{getData(result.hour.o).intimacy.desire}<br/>Bæ–¹éœ€æ±‚ï¼š{getData(resB.hour.o).intimacy.desire}</p></div>}
                </div>
            );
        };

        const App = () => {
            const [result, setResult] = useState(null);
            const [isNight, setIsNight] = useState(false);
            const [activeTab, setActiveTab] = useState('basic');
            const [showAgeConfirm, setShowAgeConfirm] = useState(false);

            useEffect(() => { document.body.className = isNight ? 'night-mode' : 'day-mode'; }, [isNight]);
            const handleNightToggle = () => { if (!isNight) setShowAgeConfirm(true); else setIsNight(false); };

            const tabs = [
                { id: 'basic', label: 'ğŸ”® éˆé­‚è—åœ–' },
                { id: 'year', label: 'ğŸ—“ï¸ å¹´åº¦æˆ°ç•¥' },
                { id: 'hr', label: 'ğŸ’¼ HR è­˜äºº' },
                { id: 'compat', label: 'ğŸ’• é—œä¿‚åˆç›¤' },
                { id: 'intimacy', label: 'ğŸ’‹ è¦ªå¯†æŒ‡å—', hidden: !isNight }
            ];

            return (
                <div className="min-h-screen pb-20">
                    {showAgeConfirm && <div className="modal-overlay"><div className="card modal-content max-w-md w-full mx-4 p-8 text-center"><h3 className="text-2xl font-bold gold-text mb-4 serif">æ·±å¤œæ¨¡å¼</h3><p className="mb-6 opacity-80">é€²å…¥è¦ªå¯†æŒ‡å—é ˜åŸŸï¼Œéœ€å¹´æ»¿18æ­²ã€‚</p><div className="flex gap-4 justify-center"><button onClick={()=>setShowAgeConfirm(false)} className="px-6 py-2 bg-gray-200 text-gray-800 rounded">æœªæ»¿</button><button onClick={()=>{setIsNight(true);setShowAgeConfirm(false)}} className="gold-btn px-6 py-2 rounded">é€²å…¥</button></div></div></div>}
                    
                    <header className={`backdrop-blur-md shadow-sm sticky top-0 z-50 ${isNight ? 'bg-gray-900/90' : 'bg-white/90'}`}>
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex justify-between items-center mb-3">
                                <div><h1 className="text-2xl font-bold gold-text tracking-widest serif">é¦¥éˆç§˜ç¢¼</h1><p className="text-[10px] opacity-50">Master v7.5</p></div>
                                <div className="flex gap-2">{result && <button onClick={()=>setResult(null)} className="text-xs px-3">é‡æ–°è§£ç¢¼</button>}<button onClick={handleNightToggle} className="gold-btn px-3 py-1 rounded-full text-xs">{isNight ? 'ğŸŒ™' : 'â˜€ï¸'}</button></div>
                            </div>
                            <div className="flex gap-1 overflow-x-auto pb-1">{tabs.filter(t=>!t.hidden).map(t=><button key={t.id} onClick={()=>setActiveTab(t.id)} className={`tab-btn px-3 py-2 text-sm whitespace-nowrap ${activeTab===t.id?'active font-bold':'opacity-60'}`}>{t.label}</button>)}</div>
                        </div>
                    </header>

                    <main className="container mx-auto px-4 py-8">
                        {!result ? (
                            <div className="max-w-xl mx-auto text-center">
                                <h2 className="text-3xl font-bold gold-text serif mb-4">è¼¸å…¥ç”Ÿæ—¥ï¼Œè§£é–äººç”Ÿæ”»ç•¥</h2>
                                <p className="opacity-60 mb-8">çµåˆ æ±æ–¹æ™‚è¾° Ã— è¥¿æ–¹éˆæ•¸ Ã— ç¾ä»£æˆ°ç•¥</p>
                                <InputForm onCalculate={setResult} />
                            </div>
                        ) : (
                            <>
                                {activeTab === 'basic' && <BasicDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'year' && <YearDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'hr' && <HRDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'compat' && <CompatPage result={result} />}
                                {activeTab === 'intimacy' && <IntimacyDeepPage result={result} />}
                            </>
                        )}
                    </main>
                    <footer className="text-center py-8 opacity-40 text-xs"><p>Â© 2026 é¦¥éˆç§˜ç¢¼ Hour Light v7.5</p><p>å‰µå§‹äººï¼šç‹é€¸å›</p></footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
