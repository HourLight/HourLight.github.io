<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¥éˆç§˜ç¢¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #D4AF37; --gold-light: #F5E6A3; --purple: #9F5FDB; }
        body { font-family: 'Noto Sans TC', sans-serif; }
        .serif { font-family: 'Noto Serif TC', serif; }
        body.day-mode { background: linear-gradient(135deg, #FDF8E8 0%, #F5E6A3 50%, #FDF8E8 100%); color: #4A3728; }
        body.night-mode { background: linear-gradient(135deg, #0F0c29 0%, #302b63 50%, #24243e 100%); color: #E0D4FC; }
        .gold-text { color: var(--gold); }
        .night-mode .gold-text { color: #FFD700; text-shadow: 0 0 15px rgba(255,215,0,0.3); }
        .gold-btn { background: linear-gradient(135deg, #D4AF37 0%, #F5E6A3 50%, #D4AF37 100%); color: #2D1B0E; font-weight: 600; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); transition: all 0.3s; }
        .gold-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4); }
        .night-mode .gold-btn { background: linear-gradient(135deg, #ff00cc 0%, #333399 100%); color: #fff; box-shadow: 0 4px 15px rgba(255, 0, 204, 0.4); }
        .card { backdrop-filter: blur(10px); border-radius: 1rem; transition: all 0.3s; }
        .day-mode .card { background: rgba(255, 255, 255, 0.9); border: 1px solid rgba(212, 175, 55, 0.2); box-shadow: 0 4px 20px rgba(139, 115, 85, 0.1); }
        .night-mode .card { background: rgba(20, 20, 30, 0.8); border: 1px solid rgba(159, 95, 219, 0.3); }
        .tab-btn { transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { border-bottom-color: var(--gold); }
        .night-mode .tab-btn.active { border-bottom-color: #ff00cc; }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: center; z-index: 100; }
        .master-badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; animation: glow 2s infinite alternate; }
        .day-mode .master-badge { background: linear-gradient(135deg, #D4AF37, #F5E6A3); color: #4A3728; }
        .night-mode .master-badge { background: linear-gradient(135deg, #9F5FDB, #E066FF); color: #1A1A2E; }
        @keyframes glow { from { box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); } to { box-shadow: 0 0 15px rgba(212, 175, 55, 0.8); } }
        .erotic-text { font-family: 'Noto Serif TC', serif; letter-spacing: 0.05em; }
    </style>
</head>
<body class="day-mode">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // å…¨å±€éŒ¯èª¤æ””æˆª
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Global Error:", message, error);
            // alert("ç³»çµ±åµæ¸¬åˆ°éŒ¯èª¤ï¼Œè«‹é‡æ–°æ•´ç†ç¶²é ã€‚"); 
        };

        const HOURS = [
            { id: 'zi', name: 'å­æ™‚ (23-01)', num: 1 }, { id: 'chou', name: 'ä¸‘æ™‚ (01-03)', num: 2 },
            { id: 'yin', name: 'å¯…æ™‚ (03-05)', num: 3 }, { id: 'mao', name: 'å¯æ™‚ (05-07)', num: 4 },
            { id: 'chen', name: 'è¾°æ™‚ (07-09)', num: 5 }, { id: 'si', name: 'å·³æ™‚ (09-11)', num: 6 },
            { id: 'wu', name: 'åˆæ™‚ (11-13)', num: 7 }, { id: 'wei', name: 'æœªæ™‚ (13-15)', num: 8 },
            { id: 'shen', name: 'ç”³æ™‚ (15-17)', num: 9 }, { id: 'you', name: 'é…‰æ™‚ (17-19)', num: 1 },
            { id: 'xu', name: 'æˆŒæ™‚ (19-21)', num: 11 }, { id: 'hai', name: 'äº¥æ™‚ (21-23)', num: 3 },
            { id: 'unknown', name: 'æ™‚è¾°ä¸è©³', num: 0 }
        ];

        // è³‡æ–™åº« (å®Œæ•´ä¿ç•™)
        const MASTER_DATA = {
            1: {
                title: 'é ˜èˆªè€…', slogan: 'æˆ‘å‰µé€ ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œä¾è³´ã€èˆ‡ã€ŒæŸ”è»Ÿã€ã€‚', wealth: 'é–‹å‰µå‹è²¡é‹ï¼Œé©åˆå‰µæ¥­ã€‚', health: 'é ­éƒ¨ã€å¿ƒè‡Ÿã€è¡€å£“ã€‚' },
                hr: { archetype: 'é–‹å‰µå…ˆé‹’', slogan: 'ç ´å±€è€…', strengths: ['æ±ºç­–æœæ–·', 'æŠ—å£“æ€§å¼·', 'ç›®æ¨™å°å‘'], weaknesses: ['ç¨æ–·ç¨è¡Œ', 'å¿½ç•¥ç´°ç¯€', 'ç¼ºä¹è€å¿ƒ'], management: 'çµ¦äºˆç›®æ¨™èˆ‡èˆå°ï¼Œå‹¿å¾®è§€ç®¡ç†ã€‚', radar: [5, 5, 2, 3, 2] },
                intimacy: { type: 'è¦–è¦ºç³»å¸ç‹', zone: 'é ­çš®ã€èƒŒéƒ¨ã€è¦–è¦ºåˆºæ¿€ã€‚', fantasy: 'è¢«å´‡æ‹œçš„æ€§æ„›ï¼Œäº«å—çœ‹è‘—å°æ–¹è‡£æœã€‚', manual: 'çµ¦è¶³ä»–é¢å­ï¼Œå¶çˆ¾è¡¨ç¾å‡ºç„¡åŠ›æŠµæŠ—çš„æ¨£å­ã€‚', key: 'ã€Œä½ æ˜¯æœ€æ£’çš„ã€‚ã€' }
            },
            2: {
                title: 'èª¿å’Œè€…', slogan: 'æˆ‘æ„Ÿå—ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€ŒåŠƒæ¸…ç•Œç·šã€ã€‚', wealth: 'åˆä½œå‹è²¡é‹ï¼Œé äººè„ˆã€‚', health: 'æ¶ˆåŒ–ç³»çµ±ã€æ·‹å·´ã€‚' },
                hr: { archetype: 'æ•´åˆè»å¸«', slogan: 'è¶…ç´šè† æ°´', strengths: ['ç´°è†©æ•æ„Ÿ', 'å¼·å¤§å”ä½œ', 'å¯Ÿè¨€è§€è‰²'], weaknesses: ['æ±ºç­–çŒ¶è±«', 'æƒ…ç·’å…§è€—', 'ä¾è³´æ€§å¼·'], management: 'çµ¦äºˆå®‰å…¨æ„Ÿèˆ‡æ­¸å±¬æ„Ÿã€‚', radar: [2, 4, 5, 4, 3] },
                intimacy: { type: 'è‚Œè†šé£¢æ¸´ç—‡', zone: 'è€³å¾Œã€é ¸éƒ¨ã€ç´°å¾®è§¸ç¢°ã€‚', fantasy: 'é•·æ™‚é–“æ¥å»èˆ‡æ„›æ’«ï¼Œè¿½æ±‚èåˆã€‚', manual: 'å‰æˆ²è¦é•·ï¼Œå¾Œæˆ²æ“æŠ±æ›´é‡è¦ã€‚', key: 'ã€Œæˆ‘å¥½æ„›ä½ çš„å‘³é“ã€‚ã€' }
            },
            3: {
                title: 'å‰µé€ è€…', slogan: 'æˆ‘è¡¨é”ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œå°ˆæ³¨ã€èˆ‡ã€Œæ·±å…¥ã€ã€‚', wealth: 'æ‰è¯å‹è²¡é‹ï¼Œé å£æ‰ã€‚', health: 'å–‰åš¨ã€å‘¼å¸é“ã€‚' },
                hr: { archetype: 'å‰µæ„ç‡ƒç‡’è€…', slogan: 'æ°£æ°›æ“”ç•¶', strengths: ['å‰µæ„ç„¡é™', 'è¡¨é”åŠ›ä½³', 'é©æ‡‰åŠ›å¼·'], weaknesses: ['è™é ­è›‡å°¾', 'ç¼ºä¹ç´€å¾‹', 'æƒ…ç·’åŒ–'], management: 'çµ¦äºˆèˆå°èˆ‡æŒè²ã€‚', radar: [4, 3, 5, 2, 3] },
                intimacy: { type: 'ç©æ¨‚èª¿æƒ…é«˜æ‰‹', zone: 'å¤§è…¿å…§å´ã€è¨€èªæŒ‘é€—ã€‚', fantasy: 'è§’è‰²æ‰®æ¼”ï¼Œå–œæ­¡é©šå–œèˆ‡è®ŠåŒ–ã€‚', manual: 'è®“ä»–ç¬‘ï¼Œä¿æŒå¹½é»˜èˆ‡ç¥ç§˜æ„Ÿã€‚', key: 'ã€ŒçŒœçŒœæˆ‘ä»Šå¤©ç©¿ä»€éº¼ï¼Ÿã€' }
            },
            4: {
                title: 'å»ºé€ è€…', slogan: 'æˆ‘å»ºè¨­ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œå½ˆæ€§ã€èˆ‡ã€Œå†’éšªã€ã€‚', wealth: 'ç´¯ç©å‹è²¡é‹ï¼Œé©åˆæˆ¿ç”¢ã€‚', health: 'éª¨éª¼ã€ç‰™é½’ã€‚' },
                hr: { archetype: 'çµæ§‹å®ˆé–€å“¡', slogan: 'ç³»çµ±å»ºé€ è€…', strengths: ['é‚è¼¯åš´è¬¹', 'åŸ·è¡ŒåŠ›å¼·', 'å¿ èª åº¦é«˜'], weaknesses: ['ä¸çŸ¥è®Šé€š', 'æŠ—æ‹’æ”¹è®Š', 'éæ–¼åš´è‚…'], management: 'çµ¦äºˆæ˜ç¢ºè¦å‰‡èˆ‡SOPã€‚', radar: [2, 5, 2, 5, 4] },
                intimacy: { type: 'è€åŠ›å‹å¯¦å¹¹å®¶', zone: 'å …å¯¦æ“æŠ±ã€è‚©è†€æŒ‰æ‘©ã€‚', fantasy: 'è¿½æ±‚æ¬¡æ•¸èˆ‡æ™‚é–“çš„ç´€éŒ„çªç ´ã€‚', manual: 'ä¸è¦å¤ªå¤šé©šå–œï¼Œä»–å–œæ­¡æŒæ§ç¯€å¥ã€‚', key: 'ã€Œä½ çš„é«”åŠ›é©šäººã€‚ã€' }
            },
            5: {
                title: 'è®Šé©è€…', slogan: 'æˆ‘æ¢ç´¢ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œæ‰¿è«¾ã€èˆ‡ã€Œæ‰æ ¹ã€ã€‚', wealth: 'æ©Ÿæœƒå‹è²¡é‹ï¼Œé©åˆè²¿æ˜“ã€‚', health: 'ç¥ç¶“ç³»çµ±ã€è‚ºéƒ¨ã€‚' },
                hr: { archetype: 'è‡ªç”±ç‰¹ç¨®å…µ', slogan: 'å†’éšªå®¶', strengths: ['å±æ©Ÿè™•ç†', 'è«‡åˆ¤éŠ·å”®', 'å¿«é€Ÿå­¸ç¿’'], weaknesses: ['ä¸å—æ§', 'å®¹æ˜“å­å€¦', 'æ‰¿è«¾è·³ç¥¨'], management: 'çµ¦äºˆå½ˆæ€§èˆ‡æŒ‘æˆ°ã€‚', radar: [4, 4, 5, 1, 5] },
                intimacy: { type: 'æ„Ÿå®˜çµäºº', zone: 'è…³è¸ã€è…°çª©ï¼Œå–œæ­¡è’™çœ¼ã€‚', fantasy: 'é‡å¤–ã€åˆºæ¿€ã€æ²’è©¦éçš„æ–°èŠ±æ¨£ã€‚', manual: 'åˆ¥æƒ³ç¶ä½ä»–ï¼Œå¸¶ä»–å»å†’éšªã€‚', key: 'ã€Œä»Šæ™šè©¦è©¦æ–°ç©å…·ï¼Ÿã€' }
            },
            6: {
                title: 'ç…§é¡§è€…', slogan: 'æˆ‘æ„›ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œæ”¾æ‰‹ã€èˆ‡ã€Œæ„›è‡ªå·±ã€ã€‚', wealth: 'æœå‹™å‹è²¡é‹ï¼Œé©åˆé†«ç™‚ã€‚', health: 'å¿ƒè‡Ÿã€è‚©é ¸ã€‚' },
                hr: { archetype: 'å®Œç¾å®ˆè­·è€…', slogan: 'è²¬ä»»æ“”ç•¶', strengths: ['è²¬ä»»æ„Ÿå¼·', 'è§£æ±ºå•é¡Œ', 'é«˜å“è³ªè¦æ±‚'], weaknesses: ['éåº¦æ‰¿æ“”', 'é“å¾·ç¶æ¶', 'å®Œç¾ä¸»ç¾©'], management: 'è‚¯å®šå…¶ä»˜å‡ºã€‚', radar: [3, 4, 4, 4, 3] },
                intimacy: { type: 'æ¥µè‡´æœå‹™è€…', zone: 'èƒ¸å£ã€è‡‰é °ã€‚', fantasy: 'æº«é¦¨æµªæ¼«ï¼Œè®“å°æ–¹é«˜æ½®æ˜¯ä»–çš„æ˜¥è—¥ã€‚', manual: 'ç’°å¢ƒè¦ç¾ï¼Œä¸»å‹•æœå‹™ä»–ä¸€æ¬¡ã€‚', key: 'ã€Œæ›æˆ‘ä¾†æœä¾ä½ ã€‚ã€' }
            },
            7: {
                title: 'æ¢ç´¢è€…', slogan: 'æˆ‘æ€è€ƒï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œä¿¡ä»»ã€èˆ‡ã€Œé–‹æ”¾ã€ã€‚', wealth: 'å°ˆæ¥­å‹è²¡é‹ï¼Œé çŸ¥è­˜ã€‚', health: 'è…¦ç¥ç¶“ã€‚' },
                hr: { archetype: 'æˆ°ç•¥åˆ†æå¸«', slogan: 'å†·éœæ™ºå›Š', strengths: ['æ·±åº¦åˆ†æ', 'é‚è¼¯æ¨ç†', 'ç›´è¦ºæ•éŠ³'], weaknesses: ['äººéš›ç–é›¢', 'å¤šç–‘çŒœå¿Œ', 'åˆ†æç™±ç˜“'], management: 'å°Šé‡å°ˆæ¥­èˆ‡éš±ç§ã€‚', radar: [3, 3, 2, 4, 5] },
                intimacy: { type: 'ç¦æ…¾ç³»æ‚¶é¨·', zone: 'å¤§è…¦ã€çœ¼ç¥æ·±è¦–ã€‚', fantasy: 'å·çªºã€è¢«è§€å¯Ÿã€å†·éœåˆ†æå¿«æ„Ÿã€‚', manual: 'å…ˆæ”»ç ´è…¦è¢‹ï¼Œä¿æŒç¥ç§˜è·é›¢æ„Ÿã€‚', key: 'ã€Œä½ åœ¨æƒ³ä»€éº¼ï¼Ÿã€' }
            },
            8: {
                title: 'æŒæ¬Šè€…', slogan: 'æˆ‘æŒæ§ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œèª å¯¦ã€èˆ‡ã€Œæ”¾ä¸‹ã€ã€‚', wealth: 'ä¼æ¥­å‹è²¡é‹ï¼Œé©åˆé‡‘èã€‚', health: 'æ¶ˆåŒ–ç³»çµ±ã€‚' },
                hr: { archetype: 'æ¬ŠåŠ›åŸ·è¡Œå®˜', slogan: 'å•†æ¥­æ“ç›¤æ‰‹', strengths: ['è³‡æºæ•´åˆ', 'å®è§€è¦–é‡', 'ç›®æ¨™é”æˆ'], weaknesses: ['æ§åˆ¶ç‹‚', 'åŠŸåˆ©ä¸»ç¾©', 'å¿½ç•¥äººæ€§'], management: 'è«‡åˆ©ç›Šèˆ‡ROIã€‚', radar: [5, 5, 3, 3, 5] },
                intimacy: { type: 'æ ¼é›·ç¸½è£', zone: 'ä¸‹èƒŒã€è‡€éƒ¨ï¼Œå–œæ­¡æŠ“ç—•ã€‚', fantasy: 'æ¬ŠåŠ›äº¤æ›ï¼Œäº«å—æŒæ§æˆ–è¢«æŒæ§ã€‚', manual: 'å¼·åº¦è¦å¤ ï¼Œå¶çˆ¾æŒ‘é‡æ¿€èµ·å¾æœæ…¾ã€‚', key: 'ã€Œæˆ‘æ˜¯ä½ çš„ã€‚ã€' }
            },
            9: {
                title: 'æ™ºè€…', slogan: 'æˆ‘å¥‰ç»ï¼Œæ•…æˆ‘åœ¨',
                basic: { lesson: 'å­¸ç¿’ã€Œè½åœ°ã€èˆ‡ã€Œå°ˆæ³¨ã€ã€‚', wealth: 'è²æœ›å‹è²¡é‹ï¼Œéš¨ç·£è€Œä¾†ã€‚', health: 'å…¨èº«ç³»çµ±ã€‚' },
                hr: { archetype: 'é¡˜æ™¯å°å¸«', slogan: 'ç²¾ç¥é ˜è¢–', strengths: ['åŒ…å®¹åŠ›å¼·', 'è·¨ç•Œæ€è€ƒ', 'é è¦‹è¦åŠƒ'], weaknesses: ['ä¸åˆ‡å¯¦éš›', 'æƒ…ç·’å‹’ç´¢', 'åŸ·è¡ŒåŠ›å¼±'], management: 'è«‡é¡˜æ™¯èˆ‡æ„ç¾©ã€‚', radar: [4, 2, 5, 3, 4] },
                intimacy: { type: 'éˆé­‚è¡Œè€…', zone: 'é ­é ‚ã€è„Šæ¤ã€‚', fantasy: 'è­šå´”æ€§æ„›ï¼Œèº«å¿ƒéˆåˆä¸€ã€‚', manual: 'åƒå„€å¼èˆ¬ç¥è–ï¼Œé€£çµéˆé­‚ã€‚', key: 'ã€Œæˆ‘çœ‹è¦‹ä½ çš„éˆé­‚ã€‚ã€' }
            },
            11: {
                title: 'éˆæ€§ç›´è¦ºè€…', slogan: 'æˆ‘æ˜¯é€šé“', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œæ¥åœ°ã€ã€‚', wealth: 'éˆæ€§è²¡é‹ã€‚', health: 'ç¥ç¶“æ•æ„Ÿã€‚' },
                hr: { archetype: 'éˆæ€§å…ˆçŸ¥', slogan: 'ç›´è¦ºé€šé“', strengths: ['è¶…å¼·ç›´è¦º', 'å•Ÿç™¼äººå¿ƒ'], weaknesses: ['ç¥ç¶“è³ª', 'æƒ…ç·’å´©æ½°'], management: 'ä¿è­·é«˜æ•æ„Ÿç‰¹è³ªã€‚', radar: [5, 3, 5, 2, 5] },
                intimacy: { type: 'é›™ç”Ÿç«ç„°', zone: 'å…¨èº«æ°£å ´ã€‚', fantasy: 'å¿ƒé›»æ„Ÿæ‡‰å¼çš„èåˆã€‚', manual: 'çµ•å°èª å¯¦ï¼Œå‹•ä½œè¼•æŸ”æ·±æ²‰ã€‚', key: 'ã€Œæˆ‘æ‡‚ä½ ï¼Œä¸ç”¨èªªã€‚ã€' }
            },
            22: {
                title: 'å¤§å¸«å»ºé€ è€…', slogan: 'æˆ‘æ˜¯åŸºçŸ³', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œå¹³è¡¡ã€ã€‚', wealth: 'å·¨å¯Œå‹è²¡é‹ã€‚', health: 'å®¹æ˜“éå‹ã€‚' },
                hr: { archetype: 'ç¯‰å¤¢å·¨äºº', slogan: 'ç¸½å·¥ç¨‹å¸«', strengths: ['è¶…å¤§æ ¼å±€', 'å‹™å¯¦åŸ·è¡Œ'], weaknesses: ['å£“åŠ›éå‹', 'ç¨è£'], management: 'çµ¦äºˆè¶…å¤§å‹å°ˆæ¡ˆã€‚', radar: [5, 5, 3, 5, 5] },
                intimacy: { type: 'å¸åœ‹ç· é€ è€…', zone: 'è‚Œè‚‰ã€è„Šæ¤ã€‚', fantasy: 'å»ºç«‹å…±åŒçš„ç‹æœã€‚', manual: 'åšä»–å …å¼·çš„å¾Œç›¾ï¼Œå¹«ä»–é‡‹å£“ã€‚', key: 'ã€Œé€™è£¡åªæœ‰æˆ‘å€‘ã€‚ã€' }
            },
            33: {
                title: 'å¤§å¸«ç™‚ç™’è€…', slogan: 'æˆ‘æ˜¯æ„›', isMaster: true,
                basic: { lesson: 'å­¸ç¿’ã€Œä¸åŸ·è‘—ã€ã€‚', wealth: 'ç¦å ±å‹è²¡é‹ã€‚', health: 'å¿ƒè‡Ÿè² è·ã€‚' },
                hr: { archetype: 'å¤§æ„›ç™‚ç™’å¸«', slogan: 'è¶…ç´šå°å¸«', strengths: ['æ¥µè‡´åˆ©ä»–', 'å‡èšåœ˜éšŠ'], weaknesses: ['çƒˆå£«æƒ…çµ', 'æ¯«ç„¡ç•Œç·š'], management: 'å¼·åˆ¶ä¼‘æ¯ã€‚', radar: [3, 4, 5, 4, 3] },
                intimacy: { type: 'è–æ¯/æ•‘ä¸–ä¸»', zone: 'èƒ¸æ‡·ã€‚', fantasy: 'ç™‚ç™’å¼çš„æ€§æ„›ï¼Œç„¡æ¢ä»¶æ¥ç´ã€‚', manual: 'å¼·è¿«ä»–æ¥å—ä½ çš„æœå‹™èˆ‡æ„›ã€‚', key: 'ã€Œè®“æˆ‘ä¾†ç™‚ç™’ä½ ã€‚ã€' }
            }
        };

        const YEAR_STRATEGY = {
            1: { keyword: 'æ’­ç¨®', action: 'å•Ÿå‹•æ–°è¨ˆç•«ã€å‹‡æ•¢å†’éšª', caution: 'çŒ¶è±«ä¸æ±º', okr: 'è¨­å®šæœªä¾†9å¹´å¤§ç›®æ¨™' },
            2: { keyword: 'é€£çµ', action: 'å»ºç«‹åˆä½œã€è€å¿ƒç­‰å¾…', caution: 'è¡å‹•æ±ºç­–', okr: 'æ“´å±•æ ¸å¿ƒäººè„ˆåœˆ' },
            3: { keyword: 'ç¶»æ”¾', action: 'ç¤¾äº¤å…¬é—œã€å‰µæ„ç™¼è¡¨', caution: 'æƒ…ç·’å¤±æ§', okr: 'æå‡å€‹äººå“ç‰Œèƒ½è¦‹åº¦' },
            4: { keyword: 'æ‰æ ¹', action: 'å»ºç«‹åˆ¶åº¦ã€è²¡å‹™è¦åŠƒ', caution: 'æŠ•æ©Ÿå–å·§', okr: 'å»ºæ§‹ç©©å®šè¢«å‹•æ”¶å…¥' },
            5: { keyword: 'è½‰æŠ˜', action: 'è·¨ç•Œå˜—è©¦ã€é©æ‡‰è®ŠåŒ–', caution: 'éåº¦æ‰¿è«¾', okr: 'é–‹æ‹“å…¨æ–°å¸‚å ´' },
            6: { keyword: 'æ‰¿æ“”', action: 'æœå‹™å®¢æˆ¶ã€ç…§é¡§å®¶åº­', caution: 'æŒ‘å‰”å®Œç¾', okr: 'å„ªåŒ–æ»¿æ„åº¦' },
            7: { keyword: 'å…§çœ', action: 'ç¨è™•æ€è€ƒã€å°ˆæ¥­æ·±é€ ', caution: 'ç›²ç›®ç¤¾äº¤', okr: 'å–å¾—å°ˆæ¥­èªè­‰' },
            8: { keyword: 'è±æ”¶', action: 'å•†æ¥­è«‡åˆ¤ã€è³‡æºæ•´åˆ', caution: 'è²ªå©ªæ§åˆ¶', okr: 'ç‡Ÿæ”¶è³‡ç”¢æœ€å¤§åŒ–' },
            9: { keyword: 'æ–·æ¨é›¢', action: 'æ¸…ç†èˆŠç‰©ã€çµæŸé—œä¿‚', caution: 'åŸ·è‘—éå»', okr: 'å®Œæˆæœªç«Ÿäº‹å‹™' },
            11: { keyword: 'è¦ºé†’', action: 'è·Ÿéš¨ç›´è¦º', caution: 'ç¥ç¶“ç·Šå¼µ', okr: 'éˆæ€§èºå‡' },
            22: { keyword: 'ç¯‰å¤¢', action: 'è½å¯¦é¡˜æ™¯', caution: 'å£“åŠ›å´©æ½°', okr: 'å®Œæˆä¸å¯èƒ½ä»»å‹™' },
            33: { keyword: 'å¥‰ç»', action: 'ç™‚ç™’çœ¾ç”Ÿ', caution: 'è‡ªæˆ‘çŠ§ç‰²', okr: 'æˆç‚ºä»–äººçš„å…‰' }
        };

        // ==========================================
        // ç©©å¥é‚è¼¯å±¤
        // ==========================================

        const reduceToSingle = (num) => {
            if (!num || isNaN(num)) return 1;
            while (num > 9) num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            return num;
        };
        const reduceNumber = (num) => {
            if (!num || isNaN(num)) return 1;
            if ([11, 22, 33].includes(num)) return num;
            while (num > 9) {
                num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                if ([11, 22, 33].includes(num)) return num;
            }
            return num;
        };
        const getData = (num) => MASTER_DATA[num] || MASTER_DATA[reduceToSingle(num)] || MASTER_DATA[1];

        const logToSheet = (data) => {
            try {
                const img = new Image();
                img.src = `https://script.google.com/macros/s/AKfycbzlPM5yIuAlrQKbYa01bysqxYo3woLAfp1Tc0Ebk8-W4_3KiUfipUx9Li-10YTw2voIVA/exec?birthday=${data.year}-${data.month}-${data.day}&hour=${data.hourId}&source=MasterV7.8`;
            } catch(e) {}
        };

        const calculateHourLight = (data) => {
            logToSheet(data);
            const { year, month, day, lunarMonth, lunarDay, hourId } = data;
            const hourValue = HOURS.find(h => h.id === hourId)?.num || 0;
            
            // å®‰å…¨è½‰æ›
            const safeInt = (v) => parseInt(v) || 0;
            const hNum = reduceNumber(safeInt(lunarMonth) + safeInt(lunarDay));
            const oNumRaw = String(year) + String(month).padStart(2, '0') + String(day).padStart(2, '0');
            const oNum = reduceNumber(oNumRaw.split('').reduce((a, b) => safeInt(a) + safeInt(b), 0));
            const uNum = hourValue;
            const rNum = uNum ? reduceNumber(hNum + oNum + uNum) : reduceNumber(hNum + oNum);

            const lNum = safeInt(lunarMonth) > 9 ? reduceNumber(safeInt(lunarMonth)) : safeInt(lunarMonth);
            const gNum = reduceNumber(String(year).split('').reduce((a, b) => safeInt(a) + safeInt(b), 0));
            const hEnergyNum = safeInt(lunarDay) > 9 ? reduceNumber(safeInt(lunarDay)) : safeInt(lunarDay);
            const tNum = reduceNumber(lNum + (uNum || 5) + gNum + hEnergyNum);

            // 12å®®å®‰å…¨è¨ˆç®—
            const yearStr = String(year);
            const lastTwo = safeInt(yearStr.slice(-2));
            const p2Num = reduceNumber(Math.floor(lastTwo / 10) + (lastTwo % 10));
            const palaces = {
                1: reduceToSingle(hNum), 2: p2Num, 3: safeInt(month) > 9 ? reduceNumber(safeInt(month)) : safeInt(month),
                4: safeInt(day) > 9 ? reduceNumber(safeInt(day)) : safeInt(day),
                5: lNum, 6: hEnergyNum, 7: reduceToSingle(oNum), 8: gNum,
                9: safeInt(yearStr.charAt(yearStr.length - 3)) || 9, 10: uNum || 5, 11: tNum, 12: reduceToSingle(rNum)
            };

            return { inputData: { ...data, hourValue }, hour: { h: hNum, o: oNum, u: uNum, r: rNum }, palaces };
        };

        const calculateYearFortune = (rNum, year) => {
            const universeYear = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const personalYear = reduceNumber((rNum > 9 ? reduceToSingle(rNum) : rNum) + universeYear);
            const data = YEAR_STRATEGY[personalYear] || YEAR_STRATEGY[reduceToSingle(personalYear)] || YEAR_STRATEGY[1];
            return { universeYear, personalYear, ...data };
        };

        // ==========================================
        // UI å…ƒä»¶
        // ==========================================

        const MasterBadge = ({ num }) => {
            if (![11, 22, 33].includes(num)) return null;
            return <span className="master-badge ml-2">{num === 11 ? 'âœ¨ ç›´è¦ºå¤§å¸«' : num === 22 ? 'ğŸ›ï¸ å»ºé€ å¤§å¸«' : 'ğŸ’• ç™‚ç™’å¤§å¸«'}</span>;
        };

        const RadarChart = ({ data, labels, isNight, title }) => {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);
            useEffect(() => {
                // å®‰å…¨æª¢æŸ¥ï¼šå¦‚æœ Chart.js æ²’è¼‰å…¥ï¼Œå°±ä¸ç•«åœ–ï¼Œé¿å…ç™½ç•«é¢
                if (!chartRef.current || typeof Chart === 'undefined') return;
                if (chartInstance.current) chartInstance.current.destroy();
                try {
                    const ctx = chartRef.current.getContext('2d');
                    const color = isNight ? 'rgba(159, 95, 219, ' : 'rgba(212, 175, 55, ';
                    chartInstance.current = new Chart(ctx, {
                        type: 'radar',
                        data: { labels, datasets: [{ label: title, data, backgroundColor: color + '0.25)', borderColor: color + '1)', pointBackgroundColor: color + '1)', borderWidth: 2, pointRadius: 4 }] },
                        options: { scales: { r: { suggestedMin: 0, suggestedMax: 5, ticks: { display: false } } }, plugins: { legend: { display: false } }, maintainAspectRatio: false }
                    });
                } catch(e) { console.warn("Chart Error", e); }
            }, [data, labels, isNight]);
            
            // å¦‚æœæ²’æœ‰ Chart.jsï¼Œé¡¯ç¤ºæ›¿ä»£æ–‡å­—
            if (typeof Chart === 'undefined') return <div className="text-center opacity-50 text-xs py-10">[åœ–è¡¨è¼‰å…¥ä¸­...]</div>;
            return <div className="w-full h-64"><canvas ref={chartRef} /></div>;
        };

        const InputForm = ({ onCalculate }) => {
            const [formData, setFormData] = useState({ name: '', year: '', month: '1', day: '1', lunarMonth: '', lunarDay: '', hourId: '' });
            return (
                <div className="card p-6 fade-in max-w-xl mx-auto">
                    <h3 className="text-xl font-bold gold-text mb-4 serif text-center">é–‹å•Ÿä½ çš„å…§åœ¨åŸå ¡</h3>
                    <div className="space-y-4">
                        <input type="text" placeholder="å§“åï¼ˆé¸å¡«ï¼‰" className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.name} onChange={e=>setFormData({...formData, name:e.target.value})} />
                        <div className="grid grid-cols-3 gap-2">
                            <input type="number" placeholder="è¥¿å…ƒå¹´" className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.year} onChange={e=>setFormData({...formData, year:e.target.value})} />
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.month} onChange={e=>setFormData({...formData, month:e.target.value})}>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.day} onChange={e=>setFormData({...formData, day:e.target.value})}>{Array.from({length:31},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <div className="grid grid-cols-2 gap-2">
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarMonth} onChange={e=>setFormData({...formData, lunarMonth:e.target.value})}><option value="">è¾²æ›†æœˆ</option>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarDay} onChange={e=>setFormData({...formData, lunarDay:e.target.value})}><option value="">è¾²æ›†æ—¥</option>{Array.from({length:30},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <select className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.hourId} onChange={e=>setFormData({...formData, hourId:e.target.value})}><option value="">æ™‚è¾°ï¼ˆé¸å¡«ï¼‰</option>{HOURS.map(h=><option key={h.id} value={h.id}>{h.name}</option>)}</select>
                        <button onClick={()=>{
                            if(formData.year && formData.lunarMonth && formData.lunarDay) onCalculate(formData);
                            else alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™');
                        }} className="w-full gold-btn py-3 rounded-lg font-bold">é–‹å§‹è§£ç¢¼</button>
                    </div>
                </div>
            );
        };

        // é é¢ 1: åŸºç¤ç›¤ (éˆé­‚è—åœ–)
        const BasicDeepPage = ({ result, isNight }) => {
            const { hour, palaces } = result;
            const core = getData(hour.h);
            const outer = getData(hour.o);
            const copyBasicReport = () => {
                const text = `ã€é¦¥éˆç§˜ç¢¼ v7.8 éˆé­‚è—åœ–ã€‘\nå§“åï¼š${result.inputData.name || 'è«®è©¢è€…'}\nH${hour.h}.O${hour.o}.U${hour.u}.R${hour.r}\næœ¬è³ªï¼š${core.title}\nèª²é¡Œï¼š${core.basic.lesson}\nè²¡é‹ï¼š${core.basic.wealth}\nå¥åº·ï¼š${core.basic.health}`;
                navigator.clipboard.writeText(text); alert('å ±å‘Šå·²è¤‡è£½ï¼');
            };
            return (
                <div className="space-y-8 fade-in">
                    <div className={`card p-8 text-center relative overflow-hidden ${isNight ? 'bg-gradient-to-r from-purple-900/50 to-indigo-900/50' : 'bg-gradient-to-r from-amber-50 to-orange-50'}`}>
                        <div className="relative z-10"><div className="inline-block px-3 py-1 rounded-full bg-amber-500 text-white text-xs mb-2 tracking-widest">SOUL BLUEPRINT</div><h2 className="text-4xl font-bold gold-text serif mb-2">éˆé­‚ä½¿ç”¨èªªæ˜æ›¸</h2><p className="opacity-70 mb-6">H{hour.h} . O{hour.o} . U{hour.u} . R{hour.r}</p><div className="grid grid-cols-2 gap-4 text-left bg-white/10 p-6 rounded-xl backdrop-blur-sm"><div><div className="text-xs opacity-50 mb-1">éˆé­‚æœ¬è³ª (H{hour.h})</div><div className="font-bold text-lg">{core.title}</div><div className="text-sm opacity-80">{core.slogan}</div></div><div><div className="text-xs opacity-50 mb-1">å¤–åœ¨å±•ç¾ (O{hour.o})</div><div className="font-bold text-lg">{outer.title}</div><div className="text-sm opacity-80">{outer.slogan}</div></div></div></div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-6 border-l-4 border-amber-500"><h3 className="text-xl font-bold gold-text mb-4 serif">ğŸ“ äººç”Ÿèª²é¡Œ</h3><p className="text-lg font-bold mb-2">{core.basic.lesson}</p></div>
                        <div className="card p-6 border-l-4 border-green-500"><h3 className="text-xl font-bold text-green-600 mb-4 serif">ğŸ’° é‡‘éŒ¢è§€</h3><p className="text-md leading-relaxed">{core.basic.wealth}</p></div>
                        <div className="card p-6 border-l-4 border-red-500"><h3 className="text-xl font-bold text-red-500 mb-4 serif">â¤ï¸â€ğŸ©¹ å¥åº·å¼±é»</h3><p className="text-md leading-relaxed">{core.basic.health}</p></div>
                        <div className="card p-6 border-l-4 border-purple-500"><h3 className="text-xl font-bold text-purple-500 mb-4 serif">ğŸ° 12å®®ä½</h3><div className="grid grid-cols-3 gap-2 text-center text-xs">{Object.entries(palaces).map(([id, num]) => (<div key={id} className="p-2 bg-gray-100 dark:bg-gray-800 rounded"><div className="opacity-50">{id}å®®</div><div className="font-bold text-lg gold-text">{num}</div></div>))}</div></div>
                    </div>
                    <button onClick={copyBasicReport} className="w-full py-4 rounded-xl gold-btn text-lg shadow-lg">ğŸ“‹ è¤‡è£½éˆé­‚è—åœ–å ±å‘Š</button>
                </div>
            );
        };

        // é é¢ 2: HR æˆ°ç•¥ç‰ˆ
        const HRDeepPage = ({ result, isNight }) => {
            const { h, o, u, r } = result.hour;
            const hr = getData(o).hr;
            const consistency = (reduceToSingle(o) === reduceToSingle(u)) ? "è¡¨è£¡å¦‚ä¸€ï¼Œç©©å®šæ€§é«˜ã€‚" : `å…§å¤–æ‹‰æ‰¯ï¼Œå¤–é¡¯${o}ä½†å…§åœ¨${u}ï¼Œéœ€çµ¦äºˆå¿ƒç†è£œå„Ÿã€‚`;
            const copyReport = () => {
                const text = `ã€é¦¥éˆç§˜ç¢¼ HR æˆ°ç•¥å ±å‘Šã€‘\nå§“åï¼š${result.inputData.name}\nä»£ç¢¼ï¼šH${h}.O${o}.U${u}.R${r}\nåŸå‹ï¼š${hr.archetype}\n\nã€æˆ°åŠ›ã€‘\nå„ªå‹¢ï¼š${hr.strengths.join('ã€')}\né¢¨éšªï¼š${hr.weaknesses.join('ã€')}\n\nã€ç®¡ç†ã€‘\næ¿€å‹µï¼š${hr.management}\næ´å¯Ÿï¼š${consistency}`;
                navigator.clipboard.writeText(text); alert('å ±å‘Šå·²è¤‡è£½ï¼');
            };
            return (
                <div className="space-y-8 fade-in">
                    <div className="card p-8 text-center bg-blue-50 dark:bg-blue-900/20"><h2 className="text-3xl font-bold gold-text serif">{hr.archetype}</h2><p className="opacity-80 mt-2">ã€Œ{hr.slogan}ã€</p></div>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="space-y-6">
                            <div className="card p-6"><h4 className="font-bold mb-4">ğŸ“Š æˆ°åŠ›é›·é”</h4><RadarChart data={hr.radar} labels={['é–‹å‰µ', 'åŸ·è¡Œ', 'æºé€š', 'ç©©å®š', 'è¬€ç•¥']} isNight={isNight} title="è·å ´æˆ°åŠ›" /></div>
                            <div className="card p-6"><h4 className="font-bold text-green-600 mb-2">âœ… å„ªå‹¢</h4><div className="flex flex-wrap gap-2">{hr.strengths.map(s=><span key={s} className="px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm">âœ“ {s}</span>)}</div></div>
                        </div>
                        <div className="space-y-6">
                            <div className="card p-6 border-l-4 border-gold"><h3 className="text-xl font-bold mb-4">ğŸ“– ç®¡ç†æ‰‹å†Š</h3><p className="mb-4">{hr.management}</p><div className="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded text-sm text-yellow-800 dark:text-yellow-200">ğŸ’¡ äº¤å‰æ´å¯Ÿï¼š{consistency}</div></div>
                            <button onClick={copyReport} className="w-full py-4 rounded-xl gold-btn text-lg shadow-lg">ğŸ“‹ è¤‡è£½å°ˆæ¥­å ±å‘Š</button>
                        </div>
                    </div>
                </div>
            );
        };

        // é é¢ 3: è¦ªå¯†æŒ‡å— (æ·±å¤œç‰ˆ)
        const IntimacyDeepPage = ({ result }) => {
            const data = getData(result.hour.o).intimacy;
            return (
                <div className="space-y-8 fade-in max-w-2xl mx-auto">
                    <div className="card p-8 text-center bg-gradient-to-br from-pink-900 to-purple-900 border border-pink-500/50 shadow-[0_0_50px_rgba(236,72,153,0.3)]">
                        <div className="text-6xl mb-4 animate-pulse">ğŸ”¥</div>
                        <h2 className="text-3xl font-bold text-pink-300 serif mb-2">æ·±å¤œè¦ªå¯†è§£ç¢¼</h2>
                        <p className="text-pink-100/70 erotic-text">è§£é– Oæ•¸ {result.hour.o} çš„æ„›æ…¾åŸå» è¨­å®š</p>
                    </div>
                    <div className="card p-6 border-l-4 border-pink-500 bg-gray-900/50"><h4 className="text-xl font-bold text-pink-400 mb-3 erotic-text">ğŸ’‹ æ€§æ„›åŸå‹ï¼š{data.type}</h4><div className="space-y-4 text-gray-300"><div><span className="text-pink-300 font-bold">æ•æ„Ÿå¸¶ï¼š</span>{data.zone}</div><div><span className="text-purple-300 font-bold">ç§å¯†å¹»æƒ³ï¼š</span>{data.fantasy}</div></div></div>
                    <div className="card p-6 border-2 border-gold bg-gradient-to-r from-gray-900 to-black shadow-lg"><h4 className="text-xl font-bold text-gold mb-4 text-center serif">ğŸ”¥ èª¿æ•™èˆ‡ä½¿ç”¨æ‰‹å†Š</h4><p className="text-gray-300 leading-loose text-justify">{data.manual}</p><div className="mt-4 p-4 bg-gold/10 border border-gold/30 rounded text-center"><span className="text-gold font-bold">ğŸ—ï¸ é«˜æ½®å¯†é‘°ï¼š</span><span className="text-white italic">{data.key}</span></div></div>
                </div>
            );
        };

        // é é¢ 4: æµå¹´
        const YearDeepPage = ({ result, isNight }) => {
            const [year, setYear] = useState(new Date().getFullYear());
            const fortune = calculateYearFortune(result.hour.r, year);
            return (
                <div className="max-w-2xl mx-auto space-y-6 fade-in">
                    <div className="card p-6 flex justify-center gap-4">{[year-1, year, year+1].map(y=><button key={y} onClick={()=>setYear(y)} className={`px-4 py-2 rounded ${year===y?'gold-btn':'bg-gray-200 text-gray-700'}`}>{y}</button>)}</div>
                    <div className={`card p-8 text-center ${isNight ? 'bg-purple-900/30' : 'bg-orange-50'}`}><div className="text-7xl font-bold gold-text my-4">{fortune.personalYear}</div><div className="text-3xl font-bold serif">{fortune.keyword}å¹´</div></div>
                    <div className="card p-6 border-l-4 border-blue-500"><h4 className="font-bold text-blue-600 mb-2">ğŸ¯ å¹´åº¦æˆ°ç•¥ OKR</h4><p className="font-bold text-lg">{fortune.okr}</p></div>
                    <div className="grid grid-cols-2 gap-4"><div className="card p-4"><h4 className="font-bold text-green-600">âœ… Do's</h4><p className="text-sm">{fortune.action}</p></div><div className="card p-4"><h4 className="font-bold text-red-600">ğŸš« Don'ts</h4><p className="text-sm">{fortune.caution}</p></div></div>
                </div>
            );
        };

        // é é¢ 5: åˆç›¤
        const CompatPage = ({ result }) => {
            const [resB, setResB] = useState(null);
            return (
                <div className="max-w-4xl mx-auto space-y-6 fade-in">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-4 text-center"><div className="mb-2 gold-text">Aæ–¹ (ä½ )</div><div className="text-xl font-bold">H{result.hour.h} O{result.hour.o}</div></div>
                        <div><div className="text-center mb-2 gold-text">Bæ–¹ (å°æ–¹)</div>{resB ? <div className="card p-4 text-center"><div className="text-xl font-bold">H{resB.hour.h} O{resB.hour.o}</div><button onClick={()=>setResB(null)} className="text-xs opacity-50 mt-2">é‡è¨­</button></div> : <div className="card p-4"><input type="number" placeholder="Bæ–¹è¥¿å…ƒå¹´" className="w-full p-2 border mb-2 rounded" id="b-year" /><button onClick={()=>{ const y=document.getElementById('b-year').value; if(y) setResB(calculateHourLight({year:y, month:1, day:1, lunarMonth:1, lunarDay:1, hourId:'zi'})) }} className="w-full gold-btn py-2 rounded text-sm">å¿«é€Ÿè¨ˆç®— (ç°¡æ˜“ç‰ˆ)</button></div>}</div>
                    </div>
                    {resB && <div className="card p-8 text-center"><h3 className="text-2xl font-bold mb-4">é—œä¿‚åŒ–å­¸åæ‡‰</h3><p className="text-lg">Oæ•¸ {result.hour.o} vs {resB.hour.o}</p><p className="mt-4 text-sm opacity-70">Aæ–¹æ…¾æœ›ï¼š{getData(result.hour.o).intimacy.type}<br/>Bæ–¹æ…¾æœ›ï¼š{getData(resB.hour.o).intimacy.type}</p></div>}
                </div>
            );
        };

        const App = () => {
            const [result, setResult] = useState(null);
            const [isNight, setIsNight] = useState(false);
            const [activeTab, setActiveTab] = useState('basic');
            const [showAgeConfirm, setShowAgeConfirm] = useState(false);

            useEffect(() => { document.body.className = isNight ? 'night-mode' : 'day-mode'; }, [isNight]);
            const handleNightToggle = () => { if (!isNight) setShowAgeConfirm(true); else setIsNight(false); };

            const tabs = [
                { id: 'basic', label: 'ğŸ”® éˆé­‚è—åœ–' },
                { id: 'year', label: 'ğŸ—“ï¸ å¹´åº¦æˆ°ç•¥' },
                { id: 'hr', label: 'ğŸ’¼ HR è­˜äºº' },
                { id: 'compat', label: 'ğŸ’• é—œä¿‚åˆç›¤' },
                { id: 'intimacy', label: 'ğŸ’‹ è¦ªå¯†æŒ‡å—', hidden: !isNight }
            ];

            return (
                <div className="min-h-screen pb-20">
                    {showAgeConfirm && <div className="modal-overlay"><div className="card modal-content max-w-md w-full mx-4 p-8 text-center border-2 border-pink-500 bg-gray-900 text-white"><h3 className="text-3xl font-bold text-pink-500 mb-4 serif">ğŸ” æ·±å¤œç¦å€</h3><p className="mb-6 opacity-80 text-lg">é€™è£¡æ²’æœ‰é›æ¹¯ï¼Œåªæœ‰èµ¤è£¸çš„äººæ€§èˆ‡æ…¾æœ›ã€‚<br/>æœªæ»¿18æ­²è«‹å‹¿é€²å…¥ã€‚</p><div className="flex gap-4 justify-center"><button onClick={()=>setShowAgeConfirm(false)} className="px-6 py-2 bg-gray-700 rounded">æˆ‘é‚„å°</button><button onClick={()=>{setIsNight(true);setShowAgeConfirm(false)}} className="gold-btn px-6 py-2 rounded bg-pink-600">é€²å…¥ç¦å€</button></div></div></div>}
                    <header className={`backdrop-blur-md shadow-sm sticky top-0 z-50 ${isNight ? 'bg-gray-900/90' : 'bg-white/90'}`}>
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex justify-between items-center mb-3">
                                <div><h1 className="text-2xl font-bold gold-text tracking-widest serif">é¦¥éˆç§˜ç¢¼</h1><p className="text-[10px] opacity-50">Master v7.8</p></div>
                                <div className="flex gap-2">{result && <button onClick={()=>setResult(null)} className="text-xs px-3">é‡æ–°è§£ç¢¼</button>}<button onClick={handleNightToggle} className="gold-btn px-3 py-1 rounded-full text-xs">{isNight ? 'ğŸŒ™' : 'â˜€ï¸'}</button></div>
                            </div>
                            <div className="flex gap-1 overflow-x-auto pb-1">{tabs.filter(t=>!t.hidden).map(t=><button key={t.id} onClick={()=>setActiveTab(t.id)} className={`tab-btn px-3 py-2 text-sm whitespace-nowrap ${activeTab===t.id?'active font-bold':'opacity-60'}`}>{t.label}</button>)}</div>
                        </div>
                    </header>
                    <main className="container mx-auto px-4 py-8">
                        {!result ? (
                            <div className="max-w-xl mx-auto text-center"><h2 className="text-3xl font-bold gold-text serif mb-4">è¼¸å…¥ç”Ÿæ—¥ï¼Œè§£é–äººç”Ÿæ”»ç•¥</h2><p className="opacity-60 mb-8">çµåˆ æ±æ–¹æ™‚è¾° Ã— è¥¿æ–¹éˆæ•¸ Ã— ç¾ä»£æˆ°ç•¥</p><InputForm onCalculate={setResult} /></div>
                        ) : (
                            <>
                                {activeTab === 'basic' && <BasicDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'year' && <YearDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'hr' && <HRDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'compat' && <CompatPage result={result} />}
                                {activeTab === 'intimacy' && <IntimacyDeepPage result={result} />}
                            </>
                        )}
                    </main>
                    <footer className="text-center py-8 opacity-40 text-xs"><p>Â© 2026 é¦¥éˆç§˜ç¢¼ Hour Light v7.8</p><p>å‰µå§‹äººï¼šç‹é€¸å›</p></footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
