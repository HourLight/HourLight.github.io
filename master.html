<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¥éˆç§˜ç¢¼ Hour Light v7.3 - å¤§å¸«å…¨æ¯æˆ°ç•¥ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --gold-light: #F5E6A3;
            --cream: #FDF8E8;
            --brown: #4A3728;
            --night-bg: #1A1A2E;
            --night-card: #16213E;
            --purple: #9F5FDB;
        }
        
        body { font-family: 'Noto Sans TC', sans-serif; }
        .serif { font-family: 'Noto Serif TC', serif; }
        
        body.day-mode {
            background: linear-gradient(135deg, #FDF8E8 0%, #F5E6A3 50%, #FDF8E8 100%);
            color: #4A3728;
        }
        
        body.night-mode {
            background: linear-gradient(135deg, #1A1A2E 0%, #16213E 50%, #0F0F23 100%);
            color: #E0D4FC;
        }
        
        .gold-text { color: var(--gold); }
        .night-mode .gold-text { color: #FFD700; text-shadow: 0 0 15px rgba(255,215,0,0.3); }

        .gold-btn {
            background: linear-gradient(135deg, #D4AF37 0%, #F5E6A3 50%, #D4AF37 100%);
            color: #2D1B0E;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            transition: all 0.3s;
        }
        .gold-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4); }
        .night-mode .gold-btn {
            background: linear-gradient(135deg, #6B2C91 0%, #9F5FDB 50%, #6B2C91 100%);
            color: #fff;
        }

        .card {
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            transition: all 0.3s;
        }
        .day-mode .card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 4px 20px rgba(139, 115, 85, 0.1);
        }
        .night-mode .card {
            background: rgba(22, 33, 62, 0.9);
            border: 1px solid rgba(159, 95, 219, 0.3);
        }

        .tab-btn { transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { border-bottom-color: var(--gold); }
        .night-mode .tab-btn.active { border-bottom-color: var(--purple); }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            transform: translateX(-50%);
        }
        .day-mode .timeline-line { background: linear-gradient(to bottom, #D4AF37, #8B7355); }
        .night-mode .timeline-line { background: linear-gradient(to bottom, #9F5FDB, #4A2C7C); }

        .modal-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            display: flex; align-items: center; justify-content: center;
            z-index: 100;
        }
        .modal-content { max-height: 90vh; overflow-y: auto; }

        select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12'%3E%3Cpath fill='%23D4AF37' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            appearance: none;
        }

        .score-bar { height: 8px; border-radius: 4px; overflow: hidden; }
        .score-fill { height: 100%; transition: width 0.8s ease-out; }

        .master-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            animation: glow 2s ease-in-out infinite alternate;
        }
        .day-mode .master-badge { background: linear-gradient(135deg, #D4AF37, #F5E6A3); color: #4A3728; }
        .night-mode .master-badge { background: linear-gradient(135deg, #9F5FDB, #E066FF); color: #1A1A2E; }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); }
            to { box-shadow: 0 0 15px rgba(212, 175, 55, 0.8); }
        }

        @media (max-width: 768px) {
            .tab-btn { font-size: 0.75rem; padding: 0.5rem; }
        }
    </style>
</head>
<body class="day-mode">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        /* ============================================
           v7.3 çµ‚æ¥µæ•´åˆè³‡æ–™åº« (å…¨æ–¹ä½æ·±åº¦ç‰ˆ)
           ============================================ */

        const HOURS = [
            { id: 'zi', name: 'å­æ™‚ (23:00-01:00)', num: 1 }, { id: 'chou', name: 'ä¸‘æ™‚ (01:00-03:00)', num: 2 },
            { id: 'yin', name: 'å¯…æ™‚ (03:00-05:00)', num: 3 }, { id: 'mao', name: 'å¯æ™‚ (05:00-07:00)', num: 4 },
            { id: 'chen', name: 'è¾°æ™‚ (07:00-09:00)', num: 5 }, { id: 'si', name: 'å·³æ™‚ (09:00-11:00)', num: 6 },
            { id: 'wu', name: 'åˆæ™‚ (11:00-13:00)', num: 7 }, { id: 'wei', name: 'æœªæ™‚ (13:00-15:00)', num: 8 },
            { id: 'shen', name: 'ç”³æ™‚ (15:00-17:00)', num: 9 }, { id: 'you', name: 'é…‰æ™‚ (17:00-19:00)', num: 1 },
            { id: 'xu', name: 'æˆŒæ™‚ (19:00-21:00)', num: 11 }, { id: 'hai', name: 'äº¥æ™‚ (21:00-23:00)', num: 3 },
            { id: 'unknown', name: 'æ™‚è¾°ä¸è©³', num: 0 }
        ];
        const getHourNum = (id) => HOURS.find(h => h.id === id)?.num || 0;

        // â­ æ•¸å­—å…¨æ¯è³‡æ–™åº« (åŒ…å«HRã€åŸºç¤ã€å¥åº·ã€é‡‘éŒ¢)
        const MASTER_DATA = {
            1: {
                title: 'é ˜èˆªè€…', slogan: 'æˆ‘å‰µé€ ï¼Œæ•…æˆ‘åœ¨',
                essence: 'ç¨ç«‹ã€é–‹å‰µã€é ˜å°',
                traits: ['çµ•å°çš„é ˜å°åŠ›', 'ç„¡ä¸­ç”Ÿæœ‰çš„å‰µé€ ', 'ä¸é¡˜ä½é ­çš„è‡ªå°Š'],
                lesson: 'å­¸ç¿’ã€Œä¾è³´ã€èˆ‡ã€ŒæŸ”è»Ÿã€ã€‚çœŸæ­£çš„å¼·è€…ï¼Œæ˜¯æ•¢æ–¼ç¤ºå¼±çš„äººã€‚',
                wealth: 'é–‹å‰µå‹è²¡é‹ã€‚é©åˆå‰µæ¥­æˆ–æ¥­å‹™ï¼Œæ­£è²¡ç‚ºä¸»ï¼Œä¸é©åˆæŠ•æ©Ÿã€‚éŒ¢æ˜¯è³ºå‡ºä¾†çš„ï¼Œä¸æ˜¯å­˜å‡ºä¾†çš„ã€‚',
                health: 'é ­éƒ¨ã€å¿ƒè‡Ÿã€è¡€å£“ã€‚å®¹æ˜“å› å£“åŠ›éå¤§å°è‡´åé ­ç—›æˆ–è‚©é ¸åƒµç¡¬ã€‚',
                hr: {
                    archetype: 'é–‹å‰µå…ˆé‹’', slogan: 'ç ´å±€è€…', strengths: ['æ±ºç­–æœæ–·', 'æŠ—å£“æ€§å¼·', 'ç›®æ¨™å°å‘'], weaknesses: ['ç¨æ–·ç¨è¡Œ', 'å¿½ç•¥ç´°ç¯€', 'ç¼ºä¹è€å¿ƒ'],
                    management: 'çµ¦äºˆç›®æ¨™èˆ‡èˆå°ï¼Œå‹¿å¾®è§€ç®¡ç†ã€‚', radar: [5, 5, 2, 3, 2]
                },
                intimacy: { type: 'å¾æœè€…', healthy: 'è‡ªä¿¡è¡¨é”ï¼Œèƒ½çµ¦äºˆä¹Ÿèƒ½æ¥å—', shadow: 'åªé¡§è‡ªå·±æ»¿è¶³ï¼Œæ§åˆ¶æ…¾å¼·', tip: 'é©æ™‚è®“ä»–ä¸»å°ï¼Œæ»¿è¶³ä»–çš„è‹±é›„ä¸»ç¾©ã€‚' }
            },
            2: {
                title: 'èª¿å’Œè€…', slogan: 'æˆ‘æ„Ÿå—ï¼Œæ•…æˆ‘åœ¨',
                essence: 'é€£çµã€ç´°è†©ã€ä¾è³´',
                traits: ['å¤©ç”Ÿçš„å¤–äº¤å®˜', 'æƒ…ç·’çš„æ¥æ”¶å™¨', 'ç´°ç¯€çš„å®ˆè­·è€…'],
                lesson: 'å­¸ç¿’ã€ŒåŠƒæ¸…ç•Œç·šã€ã€‚ä¸è¦ç‚ºäº†å’Œè«§è€ŒçŠ§ç‰²è‡ªå·±ï¼Œä½ çš„æ„Ÿå—åŒæ¨£é‡è¦ã€‚',
                wealth: 'åˆä½œå‹è²¡é‹ã€‚é©åˆåˆå¤¥ã€ä»²ä»‹ã€æœå‹™æ¥­ã€‚éŒ¢æ˜¯é ã€Œäººè„ˆã€é€£çµä¾†çš„ã€‚',
                health: 'æ¶ˆåŒ–ç³»çµ±ã€æ·‹å·´ã€æƒ…ç·’ç—…ã€‚å®¹æ˜“å› éåº¦æ•æ„Ÿå°è‡´è…¸èƒƒä¸é©æˆ–å…§åˆ†æ³Œå¤±èª¿ã€‚',
                hr: {
                    archetype: 'æ•´åˆè»å¸«', slogan: 'è¶…ç´šè† æ°´', strengths: ['ç´°è†©æ•æ„Ÿ', 'å¼·å¤§å”ä½œ', 'å¯Ÿè¨€è§€è‰²'], weaknesses: ['æ±ºç­–çŒ¶è±«', 'æƒ…ç·’å…§è€—', 'ä¾è³´æ€§å¼·'],
                    management: 'çµ¦äºˆå®‰å…¨æ„Ÿèˆ‡æ­¸å±¬æ„Ÿï¼Œç§ä¸‹è¡¨æšã€‚', radar: [2, 4, 5, 4, 3]
                },
                intimacy: { type: 'é€£çµè€…', healthy: 'èº«å¿ƒåˆä¸€ï¼Œæ¥µå¼·æ„Ÿå—åŠ›', shadow: 'è¨å¥½å°æ–¹ï¼Œç”¨æ€§æ›æ„›', tip: 'æƒ…æ„Ÿæ¯”æŠ€å·§é‡è¦ï¼Œäº‹å¾Œæ“æŠ±æ˜¯é—œéµã€‚' }
            },
            3: {
                title: 'å‰µé€ è€…', slogan: 'æˆ‘è¡¨é”ï¼Œæ•…æˆ‘åœ¨',
                essence: 'å‰µæ„ã€æ¨‚è§€ã€ä»»æ€§',
                traits: ['é•·ä¸å¤§çš„å­©å­', 'è¡Œèµ°çš„é»å­åº«', 'å¿«æ¨‚çš„å‚³æŸ“æº'],
                lesson: 'å­¸ç¿’ã€Œå°ˆæ³¨ã€èˆ‡ã€Œæ·±å…¥ã€ã€‚ä¸è¦åªåœç•™åœ¨è¡¨é¢çš„å¿«æ¨‚ï¼Œå»è§¸ç¢°æ·±å±¤çš„æƒ…æ„Ÿã€‚',
                wealth: 'æ‰è¯å‹è²¡é‹ã€‚é å£æ‰ã€å‰µæ„ã€è¡¨æ¼”è³ºéŒ¢ã€‚å®¹æ˜“è¡å‹•æ¶ˆè²»ï¼Œéœ€å¼·åˆ¶å„²è“„ã€‚',
                health: 'å–‰åš¨ã€å‘¼å¸é“ã€çš®è†šã€‚å®¹æ˜“å› è¡¨é”å—é˜»è€Œå–‰åš¨ç—›ï¼Œæˆ–å£“åŠ›å¤§å°è‡´éæ•ã€‚',
                hr: {
                    archetype: 'å‰µæ„ç‡ƒç‡’è€…', slogan: 'æ°£æ°›æ“”ç•¶', strengths: ['å‰µæ„ç„¡é™', 'è¡¨é”åŠ›ä½³', 'é©æ‡‰åŠ›å¼·'], weaknesses: ['è™é ­è›‡å°¾', 'ç¼ºä¹ç´€å¾‹', 'æƒ…ç·’åŒ–'],
                    management: 'çµ¦äºˆèˆå°èˆ‡æŒè²ï¼ŒåŒ…å®¹å…¶å°ä»»æ€§ã€‚', radar: [4, 3, 5, 2, 3]
                },
                intimacy: { type: 'è¡¨æ¼”è€…', healthy: 'å……æ»¿å‰µæ„èˆ‡æ¨‚è¶£', shadow: 'å¤ªåœ¨æ„è¡¨ç¾ï¼Œå¿½ç•¥çœŸå¯¦é€£çµ', tip: 'ä¿æŒæ–°é®®æ„Ÿï¼Œè®šç¾ä»–çš„é­…åŠ›ã€‚' }
            },
            4: {
                title: 'å»ºé€ è€…', slogan: 'æˆ‘å»ºè¨­ï¼Œæ•…æˆ‘åœ¨',
                essence: 'ç©©å®šã€ç§©åºã€å®‰å…¨',
                traits: ['æœ€å …å¯¦çš„ä¾é ', 'è¦å‰‡çš„å®ˆè­·è€…', 'ç´°ç¯€çš„åŸ·è¡Œè€…'],
                lesson: 'å­¸ç¿’ã€Œå½ˆæ€§ã€èˆ‡ã€Œå†’éšªã€ã€‚å®‰å…¨æ„Ÿæ˜¯è‡ªå·±çµ¦çš„ï¼Œä¸æ˜¯é å¤–åœ¨ç’°å¢ƒã€‚',
                wealth: 'ç´¯ç©å‹è²¡é‹ã€‚é©åˆæˆ¿ç”¢ã€å„²è“„ã€å‚³çµ±ç”¢æ¥­ã€‚éŒ¢æ˜¯ä¸€ç£šä¸€ç“¦ç–Šå‡ºä¾†çš„ï¼Œä¸ä¿¡ä¸€å¤œè‡´å¯Œã€‚',
                health: 'éª¨éª¼ã€ç‰™é½’ã€é—œç¯€ã€‚å®¹æ˜“å› éåº¦åƒµåŒ–å°è‡´è…°ç— èƒŒç—›æˆ–é—œç¯€å•é¡Œã€‚',
                hr: {
                    archetype: 'çµæ§‹å®ˆé–€å“¡', slogan: 'ç³»çµ±å»ºé€ è€…', strengths: ['é‚è¼¯åš´è¬¹', 'åŸ·è¡ŒåŠ›å¼·', 'å¿ èª åº¦é«˜'], weaknesses: ['ä¸çŸ¥è®Šé€š', 'æŠ—æ‹’æ”¹è®Š', 'éæ–¼åš´è‚…'],
                    management: 'çµ¦äºˆæ˜ç¢ºè¦å‰‡èˆ‡SOPï¼Œé¿å…æœä»¤å¤•æ”¹ã€‚', radar: [2, 5, 2, 5, 4]
                },
                intimacy: { type: 'ç©©å®šè€…', healthy: 'æŒä¹…å¯é ï¼Œæ·±åšä¿¡ä»»', shadow: 'å¤ªåˆ¶å¼åŒ–ï¼Œæµæ–¼ä¾‹è¡Œå…¬äº‹', tip: 'å»ºç«‹å›ºå®šçš„å„€å¼æ„Ÿï¼Œä¸è¦å¤ªå¤šé©šå–œã€‚' }
            },
            5: {
                title: 'è®Šé©è€…', slogan: 'æˆ‘æ¢ç´¢ï¼Œæ•…æˆ‘åœ¨',
                essence: 'è‡ªç”±ã€è®ŠåŒ–ã€æ„Ÿå®˜',
                traits: ['æŠ“ä¸ä½çš„é¢¨', 'æ„Ÿå®˜çš„å†’éšªå®¶', 'æ‰“ç ´è¦å‰‡çš„äºº'],
                lesson: 'å­¸ç¿’ã€Œæ‰¿è«¾ã€èˆ‡ã€Œæ‰æ ¹ã€ã€‚çœŸæ­£çš„è‡ªç”±ï¼Œæ˜¯åœ¨é™åˆ¶ä¸­æ‰¾åˆ°è‡ªç”±ã€‚',
                wealth: 'æ©Ÿæœƒå‹è²¡é‹ã€‚é©åˆè²¿æ˜“ã€æ¥­å‹™ã€æŠ•è³‡ã€‚éŒ¢ä¾†å¾—å¿«å»å¾—ä¹Ÿå¿«ï¼Œåƒéè·¯è²¡ç¥ã€‚',
                health: 'ç¥ç¶“ç³»çµ±ã€è‚ºéƒ¨ã€‚å®¹æ˜“å› éåº¦åˆºæ¿€å°è‡´ç¥ç¶“è¡°å¼±æˆ–å¤±çœ ã€‚',
                hr: {
                    archetype: 'è‡ªç”±ç‰¹ç¨®å…µ', slogan: 'å†’éšªå®¶', strengths: ['å±æ©Ÿè™•ç†', 'è«‡åˆ¤éŠ·å”®', 'å¿«é€Ÿå­¸ç¿’'], weaknesses: ['ä¸å—æ§', 'å®¹æ˜“å­å€¦', 'æ‰¿è«¾è·³ç¥¨'],
                    management: 'çµ¦äºˆå½ˆæ€§èˆ‡æŒ‘æˆ°ï¼Œä»¥çµæœç‚ºå°å‘ã€‚', radar: [4, 4, 5, 1, 5]
                },
                intimacy: { type: 'å†’éšªè€…', healthy: 'é–‹æ”¾å¥½å¥‡ï¼Œå¯¦é©—ç²¾ç¥', shadow: 'é€ƒé¿æ‰¿è«¾ï¼Œæˆç™®å‚¾å‘', tip: 'ä¿æŒè®ŠåŒ–ï¼Œä¸€èµ·æ¢ç´¢æ–°äº‹ç‰©ã€‚' }
            },
            6: {
                title: 'ç…§é¡§è€…', slogan: 'æˆ‘æ„›ï¼Œæ•…æˆ‘åœ¨',
                essence: 'è²¬ä»»ã€å®Œç¾ã€å¥‰ç»',
                traits: ['æ„›çš„ä¾›æ‡‰ç«™', 'å®Œç¾çš„è¿½æ±‚è€…', 'å—å‚·çš„ç™‚ç™’å¸«'],
                lesson: 'å­¸ç¿’ã€Œæ”¾æ‰‹ã€èˆ‡ã€Œæ„›è‡ªå·±ã€ã€‚ä½ ä¸éœ€è¦æ‹¯æ•‘å…¨ä¸–ç•Œï¼Œå…ˆæ‹¯æ•‘ä½ è‡ªå·±ã€‚',
                wealth: 'æœå‹™å‹è²¡é‹ã€‚é©åˆé†«ç™‚ã€æ•™è‚²ã€ç¾æ¥­ã€‚éŒ¢æ˜¯ä¼´éš¨æ„›èˆ‡æœå‹™è€Œä¾†çš„å›å ±ã€‚',
                health: 'å¿ƒè‡Ÿã€ç”Ÿæ®–ç³»çµ±ã€è‚©é ¸ã€‚å®¹æ˜“å› éåº¦æ‰¿æ“”è²¬ä»»å°è‡´è‚©è†€æ²‰é‡ã€‚',
                hr: {
                    archetype: 'å®Œç¾å®ˆè­·è€…', slogan: 'è²¬ä»»æ“”ç•¶', strengths: ['è²¬ä»»æ„Ÿå¼·', 'è§£æ±ºå•é¡Œ', 'é«˜å“è³ªè¦æ±‚'], weaknesses: ['éåº¦æ‰¿æ“”', 'é“å¾·ç¶æ¶', 'å®Œç¾ä¸»ç¾©'],
                    management: 'è‚¯å®šå…¶ä»˜å‡ºï¼Œå¼•å°å…¶é©åº¦æ”¾æ‰‹ã€‚', radar: [3, 4, 4, 4, 3]
                },
                intimacy: { type: 'ç…§é¡§è€…', healthy: 'æº«æš–é«”è²¼ï¼Œç´°è†©å»æ„›', shadow: 'åªé¡§å°æ–¹ï¼Œå¿½ç•¥è‡ªå·±', tip: 'ä¸»å‹•ç…§é¡§ä»–ï¼Œè®“ä»–æ„Ÿè¦ºè¢«æ„›ã€‚' }
            },
            7: {
                title: 'æ¢ç´¢è€…', slogan: 'æˆ‘æ€è€ƒï¼Œæ•…æˆ‘åœ¨',
                essence: 'çœŸç†ã€å­¤ç¨ã€è³ªç–‘',
                traits: ['å­¤ç¨çš„æ™ºè€…', 'çœŸç†çš„æŒ–æ˜æ©Ÿ', 'æ‡·ç–‘è«–è€…'],
                lesson: 'å­¸ç¿’ã€Œä¿¡ä»»ã€èˆ‡ã€Œé–‹æ”¾ã€ã€‚æ‰“é–‹å¿ƒé–€ï¼Œè®“å…‰é€²ä¾†ï¼Œå­¤ç¨ä¸æ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚',
                wealth: 'å°ˆæ¥­å‹è²¡é‹ã€‚é çŸ¥è­˜ã€æŠ€è¡“ã€é¡§å•è³ºéŒ¢ã€‚ä¸å±‘è³ºå¿«éŒ¢ï¼Œé‡è¦–æ™ºæ…§è²¡ç”¢ã€‚',
                health: 'è…¦ç¥ç¶“ã€è…¿éƒ¨ã€ç²¾ç¥å£“åŠ›ã€‚å®¹æ˜“å› æƒ³å¤ªå¤šå°è‡´ç¥ç¶“ç·Šç¹ƒæˆ–å¤±çœ ã€‚',
                hr: {
                    archetype: 'æˆ°ç•¥åˆ†æå¸«', slogan: 'å†·éœæ™ºå›Š', strengths: ['æ·±åº¦åˆ†æ', 'é‚è¼¯æ¨ç†', 'ç›´è¦ºæ•éŠ³'], weaknesses: ['äººéš›ç–é›¢', 'å¤šç–‘çŒœå¿Œ', 'åˆ†æç™±ç˜“'],
                    management: 'å°Šé‡å°ˆæ¥­èˆ‡éš±ç§ï¼Œçµ¦äºˆç¨è™•ç©ºé–“ã€‚', radar: [3, 3, 2, 4, 5]
                },
                intimacy: { type: 'æ¢ç´¢è€…', healthy: 'èº«å¿ƒéˆåˆä¸€çš„æ·±åº¦é«”é©—', shadow: 'å¤§è…¦é‹ä½œï¼Œèº«é«”è§£é›¢', tip: 'å¿ƒéˆé€£çµæ˜¯å‰æï¼Œçµ¦ä»–æ™‚é–“æš–æ©Ÿã€‚' }
            },
            8: {
                title: 'æŒæ¬Šè€…', slogan: 'æˆ‘æŒæ§ï¼Œæ•…æˆ‘åœ¨',
                essence: 'æ¬ŠåŠ›ã€è±ç››ã€å› æœ',
                traits: ['å¤©ç”Ÿçš„è€é—†', 'è³‡æºçš„æ•´åˆè€…', 'éœ¸æ°£çš„å¯¦è¸å®¶'],
                lesson: 'å­¸ç¿’ã€Œèª å¯¦ã€èˆ‡ã€Œæ”¾ä¸‹ã€ã€‚èª å¯¦é¢å°è‡ªå·±çš„è„†å¼±ï¼Œæ”¾ä¸‹å°æ§åˆ¶çš„åŸ·è‘—ã€‚',
                wealth: 'ä¼æ¥­å‹è²¡é‹ã€‚é©åˆå‰µæ¥­ã€é‡‘èã€æŠ•è³‡ã€‚å¤©ç”Ÿå°éŒ¢æ•éŠ³ï¼Œèƒ½æ“ä½œå¤§è³‡é‡‘ã€‚',
                health: 'æ¶ˆåŒ–ç³»çµ±ã€è‚è‡Ÿã€‚å®¹æ˜“å› æ‡‰é…¬æˆ–å£“åŠ›éå¤§å°è‡´éå‹ã€‚',
                hr: {
                    archetype: 'æ¬ŠåŠ›åŸ·è¡Œå®˜', slogan: 'å•†æ¥­æ“ç›¤æ‰‹', strengths: ['è³‡æºæ•´åˆ', 'å®è§€è¦–é‡', 'ç›®æ¨™é”æˆ'], weaknesses: ['æ§åˆ¶ç‹‚', 'åŠŸåˆ©ä¸»ç¾©', 'å¿½ç•¥äººæ€§'],
                    management: 'è«‡åˆ©ç›Šèˆ‡ROIï¼Œçµ¦äºˆæ¬ŠåŠ›èˆ‡é ­éŠœã€‚', radar: [5, 5, 3, 3, 5]
                },
                intimacy: { type: 'æŒæ§è€…', healthy: 'å¼·å¤§æ€§èƒ½é‡ï¼Œæ¥µè‡´é«”é©—', shadow: 'ç”¨æ€§å±•ç¾æ¬ŠåŠ›ï¼Œæ§åˆ¶æ…¾å¼·', tip: 'é©åº¦è®“ä»–æŒæ§ï¼Œå¼·åº¦è¦å¤ ã€‚' }
            },
            9: {
                title: 'æ™ºè€…', slogan: 'æˆ‘å¥‰ç»ï¼Œæ•…æˆ‘åœ¨',
                essence: 'æ…ˆæ‚²ã€å¤§æ„›ã€æ”¾ä¸‹',
                traits: ['å¤¢æƒ³çš„å¯¦è¸å®¶', 'åšæ„›çš„äººé“ä¸»ç¾©è€…', 'éš¨ç·£çš„éš±å£«'],
                lesson: 'å­¸ç¿’ã€Œè½åœ°ã€èˆ‡ã€Œå°ˆæ³¨ã€ã€‚å¤¢æƒ³è¦æœ‰æ ¹ï¼Œæ„›äººè¦æœ‰ç•Œç·šã€‚',
                wealth: 'è²æœ›å‹è²¡é‹ã€‚é åè²ã€å…¬ç›Šã€å¨›æ¨‚è³ºéŒ¢ã€‚éŒ¢æ˜¯éš¨ç·£è€Œä¾†ï¼Œè¶Šä¸å¼·æ±‚è¶Šå¤šã€‚',
                health: 'å…¨èº«ç³»çµ±ã€‚å®¹æ˜“å—ç’°å¢ƒèƒ½é‡å½±éŸ¿ï¼Œéœ€è¦å®šæœŸæ·¨åŒ–æ’æ¯’ã€‚',
                hr: {
                    archetype: 'é¡˜æ™¯å°å¸«', slogan: 'ç²¾ç¥é ˜è¢–', strengths: ['åŒ…å®¹åŠ›å¼·', 'è·¨ç•Œæ€è€ƒ', 'é è¦‹è¦åŠƒ'], weaknesses: ['ä¸åˆ‡å¯¦éš›', 'æƒ…ç·’å‹’ç´¢', 'åŸ·è¡ŒåŠ›å¼±'],
                    management: 'è«‡é¡˜æ™¯èˆ‡æ„ç¾©ï¼Œé€£çµç¤¾æœƒåƒ¹å€¼ã€‚', radar: [4, 2, 5, 3, 4]
                },
                intimacy: { type: 'å¥‰ç»è€…', healthy: 'éˆæ€§é€£çµï¼Œè¶…è¶Šè‚‰é«”', shadow: 'è¦ºå¾—æ€§å¤ªä½å±¤æ¬¡è€Œç–é›¢', tip: 'å¼·èª¿éˆæ€§æ„ç¾©ï¼Œå‰µé€ ç¥è–æ°›åœã€‚' }
            },
            11: {
                title: 'éˆæ€§ç›´è¦ºè€…', slogan: 'æˆ‘æ˜¯é€šé“', essence: 'ç›´è¦ºã€éˆæ€§ã€å•Ÿç™¼', isMaster: true,
                traits: ['å®‡å®™çš„è¨Šæ¯æ¥æ”¶å™¨', 'æ¥µåº¦æ•æ„Ÿçš„éˆé­‚', 'é›™å€çš„é–‹å‰µåŠ›'],
                lesson: 'å­¸ç¿’ã€Œæ¥åœ°ã€ã€‚æŠŠæ¥æ”¶åˆ°çš„é«˜ç¶­è¨Šæ¯ï¼Œè½‰åŒ–ç‚ºåœ°çƒèƒ½ç”¨çš„èªè¨€ã€‚',
                wealth: 'éˆæ€§è²¡é‹ã€‚é ç›´è¦ºæŠ•è³‡æˆ–å¾äº‹èº«å¿ƒéˆç”¢æ¥­ã€‚',
                health: 'ç¥ç¶“ç³»çµ±æ¥µåº¦æ•æ„Ÿã€‚éœ€è¦å¤§é‡ç¡çœ èˆ‡ç¨è™•ã€‚',
                hr: { archetype: 'éˆæ€§å…ˆçŸ¥', slogan: 'ç›´è¦ºé€šé“', strengths: ['è¶…å¼·ç›´è¦º', 'å•Ÿç™¼äººå¿ƒ'], weaknesses: ['ç¥ç¶“è³ª', 'æƒ…ç·’å´©æ½°'], management: 'ä¿è­·é«˜æ•æ„Ÿç‰¹è³ªã€‚', radar: [5, 3, 5, 2, 5] },
                intimacy: { type: 'éˆæ€§é€£çµè€…', healthy: 'ç¥è–é«”é©—', shadow: 'éåº¦æ•æ„Ÿç„¡æ³•æ”¾é¬†', tip: 'å‰µé€ æ¥µåº¦å®‰å…¨èˆ‡ç¥è–çš„ç©ºé–“ã€‚' }
            },
            22: {
                title: 'å¤§å¸«å»ºé€ è€…', slogan: 'æˆ‘æ˜¯åŸºçŸ³', essence: 'é¡˜æ™¯ã€å¯¦è¸ã€ç³»çµ±', isMaster: true,
                traits: ['å°‡å¤¢æƒ³è½åœ°çš„å·¨äºº', 'é›™å€çš„åŸ·è¡ŒåŠ›', 'æ‰¿æ“”å¤§ä»»çš„é ˜è¢–'],
                lesson: 'å­¸ç¿’ã€Œå¹³è¡¡ã€ã€‚åœ¨å·¨å¤§çš„å£“åŠ›èˆ‡å¹³å‡¡çš„ç”Ÿæ´»ä¸­æ‰¾åˆ°å¹³è¡¡é»ã€‚',
                wealth: 'å·¨å¯Œå‹è²¡é‹ã€‚é©åˆè·¨åœ‹ä¼æ¥­ã€å¤§å‹åŸºå»ºã€‚',
                health: 'å®¹æ˜“éå‹æ­»ã€‚è‚©é ¸èƒŒéƒ¨æ‰¿å—æ¥µå¤§å£“åŠ›ã€‚',
                hr: { archetype: 'ç¯‰å¤¢å·¨äºº', slogan: 'ç¸½å·¥ç¨‹å¸«', strengths: ['è¶…å¤§æ ¼å±€', 'å‹™å¯¦åŸ·è¡Œ'], weaknesses: ['å£“åŠ›éå‹', 'ç¨è£'], management: 'çµ¦äºˆè¶…å¤§å‹å°ˆæ¡ˆã€‚', radar: [5, 5, 3, 5, 5] },
                intimacy: { type: 'æ·±åº¦å»ºé€ è€…', healthy: 'å»ºç«‹å¸åœ‹èˆ¬çš„æ‰¿è«¾', shadow: 'å·¥ä½œç‹‚å¿½ç•¥ä¼´ä¾¶', tip: 'è®“ä»–çŸ¥é“è¦ªå¯†é—œä¿‚ä¹Ÿæ˜¯é‡è¦å»ºè¨­ã€‚' }
            },
            33: {
                title: 'å¤§å¸«ç™‚ç™’è€…', slogan: 'æˆ‘æ˜¯æ„›', essence: 'æ…ˆæ‚²ã€ç™‚ç™’ã€çŠ§ç‰²', isMaster: true,
                traits: ['è¡Œèµ°çš„äººé–“è©è–©', 'é›™å€çš„è²¬ä»»èˆ‡æ„›', 'æ¥µè‡´çš„åˆ©ä»–ä¸»ç¾©'],
                lesson: 'å­¸ç¿’ã€Œä¸åŸ·è‘—ã€ã€‚æ„›æ˜¯æµå‹•çš„ï¼Œä¸è¦å› ç‚ºæ„›è€Œç”¢ç”ŸåŸ·è‘—èˆ‡ç—›è‹¦ã€‚',
                wealth: 'ç¦å ±å‹è²¡é‹ã€‚é€éå¹«åŠ©ä»–äººç²å¾—å·¨å¤§çš„è²¡å¯Œå›æµã€‚',
                health: 'å¿ƒè‡Ÿè² è·å¤§ã€‚å®¹æ˜“å› éåº¦æ‰¿æ“”ä»–äººç—›è‹¦è€Œç”Ÿç—…ã€‚',
                hr: { archetype: 'å¤§æ„›ç™‚ç™’å¸«', slogan: 'è¶…ç´šå°å¸«', strengths: ['æ¥µè‡´åˆ©ä»–', 'å‡èšåœ˜éšŠ'], weaknesses: ['çƒˆå£«æƒ…çµ', 'æ¯«ç„¡ç•Œç·š'], management: 'å¼·åˆ¶ä¼‘æ¯ï¼Œé¿å…éå‹ã€‚', radar: [3, 4, 5, 4, 3] },
                intimacy: { type: 'ç™‚ç™’è€…', healthy: 'ç„¡æ¢ä»¶æ¥ç´', shadow: 'çŠ§ç‰²è‡ªå·±æ›å–æ„›', tip: 'æ•™ä»–å­¸æœƒæ¥å—æ„›ã€‚' }
            }
        };

        const PALACE_DATA = {
            1: { name: 'å‹‡æ°£æ®¿', meridian: 'è†½ç¶“', theme: 'æˆ‘æ•¢ä¸æ•¢åšè‡ªå·±ï¼Ÿ', oils: ['è–‘', 'é»‘èƒ¡æ¤’', 'æœæ¾'] },
            2: { name: 'åŠ›é‡å»³', meridian: 'è‚ç¶“', theme: 'æˆ‘çš„åŠ›é‡å¡åœ¨å“ªï¼Ÿ', oils: ['ä½›æ‰‹æŸ‘', 'è–„è·', 'æ´‹ç”˜èŠ'] },
            3: { name: 'å‘Šåˆ¥è‹‘', meridian: 'è‚ºç¶“', theme: 'æˆ‘æ”¾ä¸ä¸‹ä»€éº¼ï¼Ÿ', oils: ['çµ²æŸ', 'ä¹³é¦™', 'å°¤åŠ åˆ©'] },
            4: { name: 'æ·¨åŒ–å®¤', meridian: 'å¤§è…¸ç¶“', theme: 'æˆ‘è©²ä¸Ÿæ‰ä»€éº¼ï¼Ÿ', oils: ['æª¸æª¬', 'è‘¡è„æŸš', 'èŒ¶æ¨¹'] },
            5: { name: 'æ¶ˆåŒ–é–£', meridian: 'èƒƒç¶“', theme: 'æˆ‘æ¶ˆåŒ–ä¸äº†ä»€éº¼ï¼Ÿ', oils: ['ç”œæ©™', 'è–‘', 'è±†è”»'] },
            6: { name: 'ä¿¡ä»»æ®¿', meridian: 'è„¾ç¶“', theme: 'æˆ‘æƒ³å¤ªå¤šä»€éº¼ï¼Ÿ', oils: ['æª€é¦™', 'å²©è˜­è‰', 'é¼ å°¾è‰'] },
            7: { name: 'å¿ƒé–€å®®', meridian: 'å¿ƒç¶“', theme: 'æˆ‘æ¸´æœ›ä»€éº¼æ„›ï¼Ÿ', oils: ['ç«ç‘°', 'èŒ‰è‰', 'ä¾è˜­'] },
            8: { name: 'æ˜è¾¨å»³', meridian: 'å°è…¸ç¶“', theme: 'æˆ‘åˆ†ä¸æ¸…ä»€éº¼ï¼Ÿ', oils: ['è¿·è¿­é¦™', 'ç¾…å‹’', 'è–„è·'] },
            9: { name: 'å¸è¼‰è‹‘', meridian: 'è†€èƒ±ç¶“', theme: 'æˆ‘æ‰›è‘—ä»€éº¼ï¼Ÿ', oils: ['è–°è¡£è‰', 'é¦¬é¬±è˜­', 'è‹¦æ©™è‘‰'] },
            10: { name: 'å¿—æ°£æ®¿', meridian: 'è…ç¶“', theme: 'æˆ‘å®³æ€•ä»€éº¼ï¼Ÿ', oils: ['é›ªæ¾', 'æª€é¦™', 'æ²’è—¥'] },
            11: { name: 'æ•é–‹é–£', meridian: 'å¿ƒåŒ…ç¶“', theme: 'æˆ‘åœ¨ä¿è­·ä»€éº¼ï¼Ÿ', oils: ['ç«ç‘°è‰', 'æ©™èŠ±', 'å»£è—¿é¦™'] },
            12: { name: 'å¹³è¡¡å®¤', meridian: 'ä¸‰ç„¦ç¶“', theme: 'æˆ‘å“ªè£¡ä¸å¹³è¡¡ï¼Ÿ', oils: ['å¤©ç«ºè‘µ', 'ä¹³é¦™', 'èŠ±æ¢¨æœ¨'] }
        };

        const YEAR_STRATEGY = {
            1: { keyword: 'æ’­ç¨®', action: 'å•Ÿå‹•æ–°è¨ˆç•«ã€å‹‡æ•¢å†’éšªã€ç¨ç«‹ä½œæ¥­', caution: 'çŒ¶è±«ä¸æ±ºã€ä¾è³´ä»–äºº', okr: 'è¨­å®šæœªä¾†9å¹´å¤§ç›®æ¨™' },
            2: { keyword: 'é€£çµ', action: 'å»ºç«‹åˆä½œã€è€å¿ƒç­‰å¾…ã€ç´°ç¯€å„ªåŒ–', caution: 'è¡å‹•æ±ºç­–ã€å–®æ‰“ç¨é¬¥', okr: 'æ“´å±•æ ¸å¿ƒäººè„ˆåœˆ' },
            3: { keyword: 'ç¶»æ”¾', action: 'ç¤¾äº¤å…¬é—œã€å‰µæ„ç™¼è¡¨ã€å±•ç¾è‡ªæˆ‘', caution: 'æƒ…ç·’å¤±æ§ã€è™é ­è›‡å°¾', okr: 'æå‡å€‹äººå“ç‰Œèƒ½è¦‹åº¦' },
            4: { keyword: 'æ‰æ ¹', action: 'å»ºç«‹åˆ¶åº¦ã€è²¡å‹™è¦åŠƒã€å­¸ç¿’é€²ä¿®', caution: 'æŠ•æ©Ÿå–å·§ã€é »ç¹è®Šå‹•', okr: 'å»ºæ§‹ç©©å®šè¢«å‹•æ”¶å…¥ç³»çµ±' },
            5: { keyword: 'è½‰æŠ˜', action: 'è·¨ç•Œå˜—è©¦ã€è¡ŒéŠ·æ¨å»£ã€é©æ‡‰è®ŠåŒ–', caution: 'éåº¦æ‰¿è«¾ã€æ²ˆè¿·ç©æ¨‚', okr: 'é–‹æ‹“å…¨æ–°å¸‚å ´æˆ–æŠ€èƒ½' },
            6: { keyword: 'æ‰¿æ“”', action: 'æœå‹™å®¢æˆ¶ã€ç…§é¡§å®¶åº­ã€è§£æ±ºå•é¡Œ', caution: 'æŒ‘å‰”å®Œç¾ã€æŠ±æ€¨çŠ§ç‰²', okr: 'å„ªåŒ–å®¢æˆ¶/å®¶åº­æ»¿æ„åº¦' },
            7: { keyword: 'å…§çœ', action: 'ç¨è™•æ€è€ƒã€å°ˆæ¥­æ·±é€ ã€ç­–ç•¥ä½ˆå±€', caution: 'å¼·è¡Œå¤–æ±‚ã€ç›²ç›®ç¤¾äº¤', okr: 'å–å¾—å°ˆæ¥­èªè­‰æˆ–æ·±åº¦æ´å¯Ÿ' },
            8: { keyword: 'è±æ”¶', action: 'å•†æ¥­è«‡åˆ¤ã€è³‡æºæ•´åˆã€çµæœå°å‘', caution: 'è²ªå©ªæ§åˆ¶ã€é•æ³•é‚Šç·£', okr: 'ç‡Ÿæ”¶èˆ‡è³‡ç”¢æœ€å¤§åŒ–' },
            9: { keyword: 'æ–·æ¨é›¢', action: 'æ¸…ç†èˆŠç‰©ã€çµæŸé—œä¿‚ã€èº«å¿ƒæ’æ¯’', caution: 'åŸ·è‘—éå»ã€é–‹å•Ÿæ–°å±€', okr: 'å®Œæˆæœªç«Ÿäº‹å‹™ï¼Œæ¸…ç©ºæ­¸é›¶' },
            11: { keyword: 'è¦ºé†’', action: 'è·Ÿéš¨ç›´è¦ºã€éˆæ€§å­¸ç¿’', caution: 'ç¥ç¶“ç·Šå¼µ', okr: 'éˆæ€§å±¤æ¬¡èºå‡' },
            22: { keyword: 'ç¯‰å¤¢', action: 'è½å¯¦å¤§é¡˜æ™¯', caution: 'å£“åŠ›å´©æ½°', okr: 'å®Œæˆä¸å¯èƒ½çš„ä»»å‹™' },
            33: { keyword: 'å¥‰ç»', action: 'ç™‚ç™’çœ¾ç”Ÿ', caution: 'è‡ªæˆ‘çŠ§ç‰²', okr: 'æˆç‚ºä»–äººçš„å…‰' }
        };

        /* ============================================
           æ ¸å¿ƒè¨ˆç®—é‚è¼¯ (ä¿æŒç©©å®šä¸è®Š)
           ============================================ */
        
        const reduceToSingle = (num) => {
            while (num > 9) num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            return num;
        };
        const reduceNumber = (num) => {
            if (num === 11 || num === 22 || num === 33) return num;
            while (num > 9) {
                num = String(num).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                if (num === 11 || num === 22 || num === 33) return num;
            }
            return num;
        };
        const isMasterNumber = (num) => [11, 22, 33].includes(num);
        const getBaseNum = (num) => MASTER_DATA[num] ? num : reduceToSingle(num);
        const getData = (num) => MASTER_DATA[num] || MASTER_DATA[reduceToSingle(num)] || MASTER_DATA[1];

        const calculateHourLight = (data) => {
            const { year, month, day, lunarMonth, lunarDay, hourId } = data;
            const hourValue = getHourNum(hourId);
            
            const hNum = reduceNumber(parseInt(lunarMonth) + parseInt(lunarDay));
            const oNumRaw = String(year) + String(month).padStart(2, '0') + String(day).padStart(2, '0');
            const oNum = reduceNumber(oNumRaw.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const uNum = hourValue || 0;
            const rNum = uNum ? reduceNumber(hNum + oNum + uNum) : reduceNumber(hNum + oNum);

            // Light è¨ˆç®—
            const lNum = parseInt(lunarMonth) > 9 ? reduceNumber(parseInt(lunarMonth)) : parseInt(lunarMonth);
            const gNum = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const hEnergyNum = parseInt(lunarDay) > 9 ? reduceNumber(parseInt(lunarDay)) : parseInt(lunarDay);
            const tNum = reduceNumber(lNum + (uNum || 5) + gNum + hEnergyNum);

            // 12å®®è¨ˆç®— (ç°¡åŒ–é‚è¼¯ä¾›é¡¯ç¤º)
            const yearStr = String(year);
            const lastTwo = parseInt(yearStr.slice(-2));
            const p2Num = reduceNumber(Math.floor(lastTwo / 10) + (lastTwo % 10));
            const palaces = {
                1: getBaseNum(hNum), 2: p2Num, 3: parseInt(month), 4: parseInt(day) > 9 ? reduceNumber(parseInt(day)) : parseInt(day),
                5: lNum, 6: hEnergyNum, 7: getBaseNum(oNum), 8: gNum,
                9: parseInt(yearStr.charAt(yearStr.length - 3)) || 9, 10: uNum || 5, 11: tNum, 12: getBaseNum(rNum)
            };

            return {
                inputData: { ...data, hourValue },
                hour: { h: hNum, o: oNum, u: uNum, r: rNum },
                light: { l: lNum, i: uNum || 5, g: gNum, h: hEnergyNum, t: tNum },
                palaces,
                hasMaster: [hNum, oNum, rNum].some(isMasterNumber)
            };
        };

        const calculateYearFortune = (rNum, year) => {
            const universeYear = reduceNumber(String(year).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0));
            const personalYear = reduceNumber(getBaseNum(rNum) + universeYear);
            const data = YEAR_STRATEGY[personalYear] || YEAR_STRATEGY[reduceToSingle(personalYear)];
            return { universeYear, personalYear, ...data };
        };

        /* ============================================
           UI å…ƒä»¶ (å…¨é¢å‡ç´šç‰ˆ)
           ============================================ */

        const MasterBadge = ({ num }) => {
            if (!isMasterNumber(num)) return null;
            const labels = { 11: 'âœ¨ ç›´è¦ºå¤§å¸«', 22: 'ğŸ›ï¸ å»ºé€ å¤§å¸«', 33: 'ğŸ’• ç™‚ç™’å¤§å¸«' };
            return <span className="master-badge ml-2">{labels[num]}</span>;
        };

        const RadarChart = ({ data, labels, isNight, title }) => {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);
            useEffect(() => {
                if (!chartRef.current) return;
                if (chartInstance.current) chartInstance.current.destroy();
                const ctx = chartRef.current.getContext('2d');
                const color = isNight ? 'rgba(159, 95, 219, ' : 'rgba(212, 175, 55, ';
                chartInstance.current = new Chart(ctx, {
                    type: 'radar',
                    data: { labels, datasets: [{ label: title, data, backgroundColor: color + '0.25)', borderColor: color + '1)', pointBackgroundColor: color + '1)', borderWidth: 2, pointRadius: 4 }] },
                    options: { scales: { r: { suggestedMin: 0, suggestedMax: 5, ticks: { display: false } } }, plugins: { legend: { display: false } }, maintainAspectRatio: false }
                });
            }, [data, labels, isNight]);
            return <div className="w-full h-64"><canvas ref={chartRef} /></div>;
        };

        const InputForm = ({ onCalculate, title }) => {
            const [formData, setFormData] = useState({ name: '', year: '', month: '1', day: '1', lunarMonth: '', lunarDay: '', hourId: '' });
            return (
                <div className="card p-6 fade-in">
                    {title && <h3 className="text-xl font-bold gold-text mb-4 serif">{title}</h3>}
                    <div className="space-y-4">
                        <input type="text" placeholder="å§“åï¼ˆé¸å¡«ï¼‰" className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.name} onChange={e=>setFormData({...formData, name:e.target.value})} />
                        <div className="grid grid-cols-3 gap-2">
                            <input type="number" placeholder="è¥¿å…ƒå¹´" className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.year} onChange={e=>setFormData({...formData, year:e.target.value})} />
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.month} onChange={e=>setFormData({...formData, month:e.target.value})}>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.day} onChange={e=>setFormData({...formData, day:e.target.value})}>{Array.from({length:31},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <div className="grid grid-cols-2 gap-2">
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarMonth} onChange={e=>setFormData({...formData, lunarMonth:e.target.value})}><option value="">è¾²æ›†æœˆ</option>{Array.from({length:12},(_,i)=><option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                            <select className="p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.lunarDay} onChange={e=>setFormData({...formData, lunarDay:e.target.value})}><option value="">è¾²æ›†æ—¥</option>{Array.from({length:30},(_,i)=><option key={i+1} value={i+1}>{i+1}æ—¥</option>)}</select>
                        </div>
                        <select className="w-full p-3 border rounded-lg bg-white/80 text-gray-800" value={formData.hourId} onChange={e=>setFormData({...formData, hourId:e.target.value})}><option value="">æ™‚è¾°ï¼ˆé¸å¡«ï¼‰</option>{HOURS.map(h=><option key={h.id} value={h.id}>{h.name}</option>)}</select>
                        <button onClick={()=>formData.year&&formData.lunarMonth&&formData.lunarDay?onCalculate(formData):alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™')} className="w-full gold-btn py-3 rounded-lg">é–‹å§‹è§£ç¢¼</button>
                    </div>
                </div>
            );
        };

        /* ============================================
           é é¢è¦–åœ– (æ·±åº¦ç‰ˆ)
           ============================================ */
        
        // åŸºç¤ç›¤æ·±åº¦ç‰ˆ (éˆé­‚ä½¿ç”¨èªªæ˜æ›¸)
        const BasicDeepPage = ({ result, isNight }) => {
            const { hour, palaces } = result;
            const mainNum = hour.o; // ä»¥Oæ•¸ç‚ºå¤–é¡¯æ ¸å¿ƒ
            const coreData = getData(hour.h); // Hæ•¸ç‚ºéˆé­‚æœ¬è³ª
            const outerData = getData(hour.o); // Oæ•¸ç‚ºå¤–åœ¨å±•ç¾

            return (
                <div className="space-y-8 fade-in">
                    <div className={`card p-8 text-center relative overflow-hidden ${isNight ? 'bg-gradient-to-r from-purple-900/50 to-indigo-900/50' : 'bg-gradient-to-r from-amber-50 to-orange-50'}`}>
                        <div className="relative z-10">
                            <div className="inline-block px-3 py-1 rounded-full bg-amber-500 text-white text-xs mb-2 tracking-widest">SOUL BLUEPRINT</div>
                            <h2 className="text-4xl font-bold gold-text serif mb-2">éˆé­‚ä½¿ç”¨èªªæ˜æ›¸</h2>
                            <p className="opacity-70 mb-6">H{hour.h} . O{hour.o} . U{hour.u} . R{hour.r}</p>
                            <div className="grid grid-cols-2 gap-4 text-left bg-white/10 p-6 rounded-xl backdrop-blur-sm">
                                <div>
                                    <div className="text-xs opacity-50 mb-1">éˆé­‚æœ¬è³ª (H{hour.h})</div>
                                    <div className="font-bold text-lg">{coreData.title}</div>
                                    <div className="text-sm opacity-80">{coreData.slogan}</div>
                                </div>
                                <div>
                                    <div className="text-xs opacity-50 mb-1">å¤–åœ¨å±•ç¾ (O{hour.o})</div>
                                    <div className="font-bold text-lg">{outerData.title}</div>
                                    <div className="text-sm opacity-80">{outerData.slogan}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-6 border-l-4 border-amber-500">
                            <h3 className="text-xl font-bold gold-text mb-4 serif">ğŸ“ äººç”Ÿèª²é¡Œ (Soul Lesson)</h3>
                            <p className="text-lg font-bold mb-2">{coreData.lesson}</p>
                            <p className="opacity-70 text-sm">é€™æ˜¯ä½ éˆé­‚é¸æ“‡ä¾†åœ°çƒé«”é©—çš„å¿…ä¿®èª²ï¼Œé‡åˆ°å›°é›£æ™‚ï¼Œè«‹å›é ­çœ‹çœ‹é€™å¥è©±ã€‚</p>
                        </div>
                        <div className="card p-6 border-l-4 border-green-500">
                            <h3 className="text-xl font-bold text-green-600 mb-4 serif">ğŸ’° é‡‘éŒ¢è§€èˆ‡è²¡é‹ (Wealth)</h3>
                            <p className="text-md leading-relaxed">{coreData.wealth}</p>
                        </div>
                        <div className="card p-6 border-l-4 border-red-500">
                            <h3 className="text-xl font-bold text-red-500 mb-4 serif">â¤ï¸â€ğŸ©¹ å¥åº·å¼±é» (Health)</h3>
                            <p className="text-md leading-relaxed">{coreData.health}</p>
                            <div className="mt-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm">
                                ğŸŒ¿ èª¿é »ç²¾æ²¹ï¼š{coreData.hr.oils?.join('ã€') || 'è–°è¡£è‰ã€ä¹³é¦™'}
                            </div>
                        </div>
                        <div className="card p-6 border-l-4 border-purple-500">
                            <h3 className="text-xl font-bold text-purple-500 mb-4 serif">ğŸ° 12å®®ä½èƒ½é‡åˆ†ä½ˆ</h3>
                            <div className="grid grid-cols-3 gap-2 text-center text-xs">
                                {Object.entries(palaces).map(([id, num]) => (
                                    <div key={id} className="p-2 bg-gray-100 dark:bg-gray-800 rounded">
                                        <div className="opacity-50">{id}å®®</div>
                                        <div className="font-bold text-lg gold-text">{num}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // HR æˆ°ç•¥ç‰ˆ (ä¿ç•™åŸæœ¬ v7.2 çš„å¼·å¤§åŠŸèƒ½)
        const HRDeepPage = ({ result, isNight }) => {
            const { h, o, u, r } = result.hour;
            const hrData = getData(o).hr;
            const consistency = getBaseNum(o) === getBaseNum(u) ? "è¡¨è£¡å¦‚ä¸€ï¼Œç©©å®šæ€§é«˜ã€‚" : `å…§å¤–æ‹‰æ‰¯ï¼Œå¤–é¡¯${o}ä½†å…§åœ¨${u}ï¼Œéœ€çµ¦äºˆå¿ƒç†è£œå„Ÿã€‚`;

            const copyReport = () => {
                const text = `ã€é¦¥éˆç§˜ç¢¼ v7.3 ä¼æ¥­æˆ°ç•¥å ±å‘Šã€‘\nå§“åï¼š${result.inputData.name}\nä»£ç¢¼ï¼šH${h}.O${o}.U${u}.R${r}\nåŸå‹ï¼š${hrData.archetype}\n\nã€æˆ°åŠ›åˆ†æã€‘\nå„ªå‹¢ï¼š${hrData.strengths.join('ã€')}\né¢¨éšªï¼š${hrData.weaknesses.join('ã€')}\n\nã€ç®¡ç†æ‰‹å†Šã€‘\næ¿€å‹µï¼š${hrData.management}\näº¤å‰åˆ†æï¼š${consistency}`;
                navigator.clipboard.writeText(text); alert('çµé ­å ±å‘Šå·²è¤‡è£½ï¼');
            };

            return (
                <div className="space-y-8 fade-in">
                     <div className={`card p-8 text-center relative overflow-hidden ${isNight ? 'bg-gradient-to-r from-blue-900/50 to-indigo-900/50' : 'bg-gradient-to-r from-slate-100 to-gray-100'}`}>
                        <div className="relative z-10"><div className="inline-block px-3 py-1 rounded-full bg-blue-500 text-white text-xs mb-2 tracking-widest">HR INTELLIGENCE</div><h2 className="text-4xl font-bold gold-text serif mb-2">{hrData.archetype}</h2><p className="text-lg opacity-80 italic font-serif">ã€Œ{hrData.slogan}ã€</p></div>
                    </div>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="space-y-6">
                            <div className="card p-6"><h4 className="font-bold border-l-4 border-blue-500 pl-3 mb-4">ğŸ“Š äº”ç¶­æˆ°åŠ›åœ–</h4><RadarChart data={hrData.radar} labels={['é–‹å‰µ', 'åŸ·è¡Œ', 'æºé€š', 'ç©©å®š', 'è¬€ç•¥']} isNight={isNight} title="è·å ´æˆ°åŠ›" /></div>
                            <div className="card p-6"><h4 className="font-bold border-l-4 border-green-500 pl-3 mb-4">âœ… å„ªå‹¢</h4><div className="flex flex-wrap gap-2">{hrData.strengths.map(s=><span key={s} className="px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm">âœ“ {s}</span>)}</div></div>
                        </div>
                        <div className="space-y-6">
                            <div className="card p-6 bg-gradient-to-br from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 border-l-4 border-gold"><h3 className="text-xl font-bold gold-text mb-4 serif">ğŸ“– ç®¡ç†æ‰‹å†Š</h3><p className="text-sm leading-relaxed mb-4">{hrData.management}</p><div className="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded text-sm text-yellow-800 dark:text-yellow-200">ğŸ’¡ äº¤å‰æ´å¯Ÿï¼š{consistency}</div></div>
                            <button onClick={copyReport} className="w-full py-4 rounded-xl gold-btn text-lg shadow-lg">ğŸ“‹ è¤‡è£½å°ˆæ¥­çµé ­å ±å‘Š</button>
                        </div>
                    </div>
                </div>
            );
        };

        // æµå¹´æˆ°ç•¥ç‰ˆ
        const YearDeepPage = ({ result, isNight }) => {
            const [year, setYear] = useState(new Date().getFullYear());
            if(!result) return <div className="text-center p-10 opacity-50">è«‹å…ˆè§£ç¢¼</div>;
            const fortune = calculateYearFortune(result.hour.r, year);

            return (
                <div className="max-w-2xl mx-auto space-y-6 fade-in">
                    <div className="card p-6 flex justify-center gap-4">{[year-1, year, year+1].map(y=><button key={y} onClick={()=>setYear(y)} className={`px-4 py-2 rounded ${year===y?'gold-btn':'bg-gray-200 text-gray-700'}`}>{y}</button>)}</div>
                    <div className={`card p-8 text-center ${isNight ? 'bg-gradient-to-br from-purple-900/50 to-pink-900/30' : 'bg-gradient-to-br from-amber-50 to-orange-50'}`}>
                        <div className="text-sm opacity-60">{year} å¹´åº¦æˆ°ç•¥</div>
                        <div className="text-7xl font-bold gold-text my-4">{fortune.personalYear}</div>
                        <div className="text-3xl font-bold serif">{fortune.keyword}å¹´</div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="card p-6 border-t-4 border-green-500">
                            <h4 className="font-bold text-green-600 mb-2">âœ… è¡Œå‹•æŒ‡å— (Do's)</h4>
                            <p>{fortune.action}</p>
                        </div>
                        <div className="card p-6 border-t-4 border-red-500">
                            <h4 className="font-bold text-red-600 mb-2">ğŸš« é¿é›·å€ (Don'ts)</h4>
                            <p>{fortune.caution}</p>
                        </div>
                    </div>
                    <div className="card p-6 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500">
                        <h4 className="font-bold text-blue-600 mb-2">ğŸ¯ å¹´åº¦æˆ°ç•¥ OKR</h4>
                        <p className="font-bold text-lg">{fortune.okr}</p>
                        <p className="text-sm opacity-70 mt-2">è«‹åœç¹æ­¤ç›®æ¨™è¨­å®šä½ çš„å¹´åº¦è¨ˆç•«ï¼Œé€™æ˜¯ä¸€å¹´ä¸­æœ€é †æµçš„æ–¹å‘ã€‚</p>
                    </div>
                </div>
            );
        };

        // åˆç›¤åŒ–å­¸åæ‡‰ç‰ˆ
        const CompatDeepPage = ({ result, isNight }) => {
            const [resultB, setResultB] = useState(null);
            
            const analyzeChemistry = (rA, rB) => {
                const oA = getBaseNum(rA.hour.o), oB = getBaseNum(rB.hour.o);
                const diff = Math.abs(oA - oB);
                let title, desc, color;
                if(diff === 0) { title = "éˆé­‚é¡åƒ"; desc = "ä½ å€‘åƒç…§é¡å­ï¼Œæ¥µåº¦æ‡‚å°æ–¹ï¼Œä½†ä¹Ÿå®¹æ˜“äº’çœ‹ä¸é †çœ¼ç¼ºé»ã€‚"; color = "text-purple-500"; }
                else if(diff % 2 === 0) { title = "å¼·å¼·è¯æ‰‹"; desc = "æ€§è³ªç›¸ä¼¼ï¼ˆå¦‚åŒç‚ºå–®æ•¸æˆ–é›™æ•¸ï¼‰ï¼Œå®¹æ˜“é”æˆå…±è­˜ï¼Œä½†ç¼ºä¹ç«èŠ±ã€‚"; color = "text-blue-500"; }
                else { title = "è‡´å‘½å¸å¼•"; desc = "å®Œå…¨ä¸åŒçš„ç‰©ç¨®ï¼Œå¼µåŠ›æ¥µå¼·ï¼Œè¦å˜›å¤©é›·å‹¾å‹•åœ°ç«ï¼Œè¦å˜›æ°´ç«ä¸å®¹ã€‚"; color = "text-red-500"; }
                return { title, desc, color, score: 100 - (diff * 10) + (diff===0?10:0) }; // ç°¡æ˜“ç®—æ³•
            };

            const chemistry = result && resultB ? analyzeChemistry(result, resultB) : null;

            return (
                <div className="max-w-4xl mx-auto space-y-6 fade-in">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div><div className="text-center mb-2 gold-text">Aæ–¹ (ä½ )</div>{result ? <div className="card p-4 text-center text-xl font-bold">H{result.hour.h} O{result.hour.o}</div> : <div className="text-center opacity-50">è«‹å…ˆè§£ç¢¼</div>}</div>
                        <div><div className="text-center mb-2 gold-text">Bæ–¹ (å°æ–¹)</div>{resultB ? <div className="card p-4 text-center text-xl font-bold">H{resultB.hour.h} O{resultB.hour.o}<br/><button onClick={()=>setResultB(null)} className="text-xs opacity-50 mt-2">é‡è¨­</button></div> : <InputForm title="è¼¸å…¥Bæ–¹è³‡æ–™" onCalculate={(d)=>setResultB(calculateHourLight(d))} />}</div>
                    </div>
                    {chemistry && (
                        <div className="card p-8 text-center animate-pulse-slow">
                            <h3 className="text-2xl font-bold mb-2">ğŸ§ª é—œä¿‚åŒ–å­¸åæ‡‰</h3>
                            <div className={`text-5xl font-bold ${chemistry.color} my-4 serif`}>{chemistry.title}</div>
                            <p className="text-lg opacity-80">{chemistry.desc}</p>
                            <div className="mt-6 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left">
                                <h4 className="font-bold mb-2">ğŸ’¡ ç›¸è™•æ”»ç•¥</h4>
                                <p className="text-sm">Aæ–¹({result.hour.o}) éœ€è¦ï¼š{getData(result.hour.o).intimacy.healthy}</p>
                                <p className="text-sm mt-1">Bæ–¹({resultB.hour.o}) éœ€è¦ï¼š{getData(resultB.hour.o).intimacy.healthy}</p>
                                <p className="text-sm mt-3 text-gold italic">ç§˜è¨£ï¼š{getData(resultB.hour.o).intimacy.tip} (é€™æ˜¯æå®šBæ–¹çš„é—œéµ)</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // è¦ªå¯†æŒ‡å— (æ·±å¤œé™å®š)
        const IntimacyDeepPage = ({ result }) => {
            const data = getData(result.hour.o).intimacy;
            return (
                <div className="max-w-2xl mx-auto space-y-6 fade-in">
                    <div className="card p-8 text-center bg-gradient-to-br from-pink-900/30 to-purple-900/50">
                        <div className="text-6xl mb-4">ğŸ’‹</div>
                        <h3 className="text-3xl font-bold gold-text serif mb-2">æ·±å¤œè¦ªå¯†æŒ‡å—</h3>
                        <p className="opacity-70">Oæ•¸ {result.hour.o} çš„æ„›æ…¾åŸå» è¨­å®š</p>
                    </div>
                    <div className="card p-6"><h4 className="font-bold text-pink-500 mb-2">åŸå‹ï¼š{data.type}</h4><p>{data.healthy}</p></div>
                    <div className="card p-6"><h4 className="font-bold text-red-500 mb-2">é™°å½±ï¼šå¤±è¡¡ç‹€æ…‹</h4><p>{data.shadow}</p></div>
                    <div className="card p-6 bg-yellow-900/20 border-l-4 border-yellow-500"><h4 className="font-bold text-yellow-500 mb-2">ğŸ’¡ çµ¦ä¼´ä¾¶çš„ä½œå¼Šæ¢</h4><p>{data.tip}</p></div>
                </div>
            );
        };

        const App = () => {
            const [result, setResult] = useState(null);
            const [isNight, setIsNight] = useState(false);
            const [activeTab, setActiveTab] = useState('basic');
            const [showAgeConfirm, setShowAgeConfirm] = useState(false);

            useEffect(() => { document.body.className = isNight ? 'night-mode' : 'day-mode'; }, [isNight]);
            const handleNightToggle = () => { if (!isNight) setShowAgeConfirm(true); else setIsNight(false); };

            const tabs = [
                { id: 'basic', label: 'ğŸ”® éˆé­‚è—åœ–' },
                { id: 'year', label: 'ğŸ—“ï¸ å¹´åº¦æˆ°ç•¥' },
                { id: 'compat', label: 'ğŸ§ª é—œä¿‚åŒ–å­¸' },
                { id: 'hr', label: 'ğŸ’¼ HR è­˜äºº' },
                { id: 'intimacy', label: 'ğŸ’‹ è¦ªå¯†æŒ‡å—', hidden: !isNight }
            ];

            return (
                <div className="min-h-screen pb-20">
                    {showAgeConfirm && <div className="modal-overlay"><div className="card modal-content max-w-md w-full mx-4 p-8 text-center"><h3 className="text-2xl font-bold gold-text mb-4 serif">æ·±å¤œæ¨¡å¼</h3><p className="mb-6 opacity-80">é€²å…¥è¦ªå¯†æŒ‡å—é ˜åŸŸï¼Œéœ€å¹´æ»¿18æ­²ã€‚</p><div className="flex gap-4 justify-center"><button onClick={()=>setShowAgeConfirm(false)} className="px-6 py-2 bg-gray-200 text-gray-800 rounded">æœªæ»¿</button><button onClick={()=>{setIsNight(true);setShowAgeConfirm(false)}} className="gold-btn px-6 py-2 rounded">é€²å…¥</button></div></div></div>}
                    
                    <header className={`backdrop-blur-md shadow-sm sticky top-0 z-50 ${isNight ? 'bg-gray-900/90' : 'bg-white/90'}`}>
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex justify-between items-center mb-3">
                                <div><h1 className="text-2xl font-bold gold-text tracking-widest serif">é¦¥éˆç§˜ç¢¼</h1><p className="text-[10px] opacity-50">v7.3 å¤§å¸«å…¨æ¯æˆ°ç•¥ç‰ˆ</p></div>
                                <div className="flex gap-2">{result && <button onClick={()=>setResult(null)} className="text-xs px-3">é‡æ–°è§£ç¢¼</button>}<button onClick={handleNightToggle} className="gold-btn px-3 py-1 rounded-full text-xs">{isNight ? 'ğŸŒ™' : 'â˜€ï¸'}</button></div>
                            </div>
                            <div className="flex gap-1 overflow-x-auto pb-1">{tabs.filter(t=>!t.hidden).map(t=><button key={t.id} onClick={()=>setActiveTab(t.id)} className={`tab-btn px-3 py-2 text-sm whitespace-nowrap ${activeTab===t.id?'active font-bold':'opacity-60'}`}>{t.label}</button>)}</div>
                        </div>
                    </header>

                    <main className="container mx-auto px-4 py-8">
                        {!result ? (
                            <div className="max-w-xl mx-auto text-center">
                                <h2 className="text-3xl font-bold gold-text serif mb-4">è¼¸å…¥ç”Ÿæ—¥ï¼Œè§£é–äººç”Ÿæ”»ç•¥</h2>
                                <p className="opacity-60 mb-8">çµåˆ æ±æ–¹æ™‚è¾° Ã— è¥¿æ–¹éˆæ•¸ Ã— ç¾ä»£æˆ°ç•¥</p>
                                <InputForm title="è¼¸å…¥è³‡æ–™" onCalculate={(d)=>setResult(calculateHourLight(d))} />
                            </div>
                        ) : (
                            <>
                                {activeTab === 'basic' && <BasicDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'year' && <YearDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'hr' && <HRDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'compat' && <CompatDeepPage result={result} isNight={isNight} />}
                                {activeTab === 'intimacy' && <IntimacyDeepPage result={result} isNight={isNight} />}
                            </>
                        )}
                    </main>
                    <footer className="text-center py-8 opacity-40 text-xs"><p>Â© 2026 é¦¥éˆç§˜ç¢¼ Hour Light v7.3</p><p>å‰µå§‹äººï¼šç‹é€¸å›</p></footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
