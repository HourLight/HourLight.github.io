<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>é¦¥éˆè¼•ç›ˆï½œæ„è­˜ç˜¦èº«å”è­°ï½œé¦¥éˆä¹‹é‘° Hour Light</title>
<meta name="description" content="28å¼µç‰Œå¡ Ã— 7ç¨®é¡å‹ Ã— 4å±¤é¢å‘ã€‚é€éæ·±åº¦è¨ªè«‡èˆ‡ç‰Œå¡è§£è®€ï¼Œæ‰¾å‡ºé«”é‡èƒŒå¾Œçš„æƒ…ç·’æ ¹æºï¼Œä¸ç¯€é£Ÿã€ä¸é‹å‹•ã€ä¸é æ„å¿—åŠ›ã€‚" />
<link rel="icon" href="favicon.ico" />

<style>
:root {
  --hl-font-main: "Noto Sans TC","PingFang TC","Microsoft JhengHei",system-ui,sans-serif;
  --hl-font-serif: "Noto Serif TC", serif;
  --hl-bg-deep: #05030a;
  --hl-bg-panel: rgba(10,6,24,0.92);
  --hl-ink-main: #f9f0e5;
  --hl-ink-soft: #d4c8ba;
  --hl-ink-muted: #a89b8c;
  --hl-gold: #e9c27d;
  --hl-gold-deep: #cda86e;
  --hl-rose: #f0b5b3;
  --hl-rose-deep: #d4918f;
  --hl-rose-soft: rgba(240,181,179,0.15);
  --hl-border-rose: rgba(240,181,179,0.5);
  --hl-border-gold: rgba(233,194,125,0.5);
  --hl-ease: cubic-bezier(0.4, 0, 0.2, 1);
}

*{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth}

body {
  min-height: 100vh;
  font-family: var(--hl-font-main);
  color: var(--hl-ink-main);
  line-height: 1.8;
  padding: 0 0 72px;
  background:
    radial-gradient(circle at 10% 0%, rgba(240,181,179,0.12) 0, transparent 50%),
    radial-gradient(circle at 90% 100%, rgba(233,194,125,0.15) 0, transparent 50%),
    radial-gradient(circle at 50% 50%, rgba(255,255,255,0.04) 0, transparent 60%),
    url('background.jpg') center/cover fixed no-repeat,
    var(--hl-bg-deep);
}

/* Header */
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  padding: 16px 24px;
  backdrop-filter: blur(18px) saturate(150%);
  background: radial-gradient(circle at top left, rgba(240,181,179,0.12), transparent 55%), rgba(10,6,24,0.88);
  border-bottom: 1px solid var(--hl-border-rose);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  font-family: var(--hl-font-serif);
  font-size: 1rem;
  font-weight: 500;
  color: var(--hl-ink-main);
  text-decoration: none;
  letter-spacing: 2px;
}

.logo span {
  background: linear-gradient(135deg, var(--hl-rose), var(--hl-rose-deep));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.back-link {
  font-size: 0.9rem;
  color: var(--hl-ink-soft);
  text-decoration: none;
  transition: color 0.3s;
}

.back-link:hover { color: var(--hl-rose); }

/* Main */
.main {
  max-width: 1080px;
  margin: 0 auto;
  padding: 24px 16px;
}

/* Glass Panel */
.glass-panel {
  border-radius: 24px;
  padding: 32px 28px;
  margin-bottom: 24px;
  backdrop-filter: blur(20px) saturate(160%);
  background:
    radial-gradient(circle at top left, rgba(240,181,179,0.18), transparent 50%),
    radial-gradient(circle at bottom right, rgba(233,194,125,0.12), transparent 50%),
    rgba(10,6,24,0.94);
  border: 1.5px solid var(--hl-border-rose);
  box-shadow: 0 24px 60px rgba(0,0,0,0.9), 0 0 40px rgba(240,181,179,0.15);
}

/* Hero */
.hero {
  text-align: center;
  padding: 20px 0 10px;
}

.hero-icon {
  font-size: 4rem;
  margin-bottom: 20px;
  filter: drop-shadow(0 4px 20px rgba(240,181,179,0.4));
}

.hero-title {
  font-family: var(--hl-font-serif);
  font-size: clamp(1.8rem, 5vw, 2.4rem);
  font-weight: 600;
  letter-spacing: 4px;
  margin-bottom: 12px;
  background: linear-gradient(135deg, #fff5f5 0%, var(--hl-rose) 40%, var(--hl-rose-deep) 70%, #fff5f5 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.hero-subtitle {
  font-size: 1.1rem;
  color: var(--hl-gold);
  font-weight: 600;
  margin-bottom: 20px;
  letter-spacing: 2px;
}

.hero-desc {
  font-size: 0.95rem;
  color: var(--hl-ink-soft);
  line-height: 2;
  max-width: 600px;
  margin: 0 auto 24px;
}

/* 28å¼µç‰Œå¡æ¶æ§‹èªªæ˜ */
.structure-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin-top: 24px;
  padding: 20px;
  border-radius: 16px;
  background: rgba(9,6,20,0.7);
  border: 1px solid rgba(240,181,179,0.2);
}

.structure-item {
  text-align: center;
  padding: 12px;
}

.structure-item .num {
  font-size: 1.8rem;
  font-weight: 900;
  color: var(--hl-gold);
}

.structure-item .label {
  font-size: 0.85rem;
  color: var(--hl-ink-soft);
  margin-top: 4px;
}

/* Draw Section */
.draw-section { text-align: center; }

.section-title {
  font-family: var(--hl-font-serif);
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--hl-rose);
  margin-bottom: 16px;
  letter-spacing: 2px;
}

.section-hint {
  font-size: 0.9rem;
  color: var(--hl-ink-soft);
  margin-bottom: 20px;
  line-height: 1.8;
}

/* Draw Button */
.draw-btn-row {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
  margin: 24px 0;
}

.draw-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 16px 32px;
  border: none;
  border-radius: 999px;
  font-family: var(--hl-font-main);
  font-size: 1rem;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.3s var(--hl-ease);
  background: linear-gradient(135deg, var(--hl-rose), var(--hl-rose-deep));
  color: #2a1515;
  box-shadow: 0 12px 32px rgba(0,0,0,0.8), 0 0 30px rgba(240,181,179,0.5);
}

.draw-btn:hover {
  transform: translateY(-3px) scale(1.02);
  box-shadow: 0 16px 40px rgba(0,0,0,0.9), 0 0 40px rgba(240,181,179,0.7);
}

/* Toolbar */
.toolbar {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 20px 0;
}

.tool-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 10px 18px;
  border: 1.5px solid var(--hl-gold-deep);
  border-radius: 999px;
  background: transparent;
  color: var(--hl-gold);
  font-family: var(--hl-font-main);
  font-size: 0.85rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.25s var(--hl-ease);
}

.tool-btn:hover:not(:disabled) {
  background: rgba(233,194,125,0.15);
  border-color: var(--hl-gold);
}

.tool-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.tool-btn-gold {
  background: linear-gradient(135deg, var(--hl-gold), var(--hl-gold-deep));
  color: #20120a;
  border: none;
  box-shadow: 0 8px 24px rgba(0,0,0,0.6), 0 0 16px rgba(233,194,125,0.4);
}

.tool-btn-gold:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 12px 32px rgba(0,0,0,0.7), 0 0 24px rgba(233,194,125,0.6);
}

/* ç‰Œé™£çµæœå€ */
.spread-result {
  margin-top: 24px;
  text-align: left;
}

.spread-section {
  margin-bottom: 28px;
  padding: 24px;
  border-radius: 20px;
  background: radial-gradient(circle at top left, rgba(240,181,179,0.1), transparent 60%), rgba(9,6,20,0.85);
  border: 1px solid rgba(240,181,179,0.25);
}

.spread-section-title {
  font-family: var(--hl-font-serif);
  font-size: 1.15rem;
  font-weight: 600;
  color: var(--hl-rose);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.spread-section-title .emoji { font-size: 1.4rem; }

.spread-section-desc {
  font-size: 0.85rem;
  color: var(--hl-ink-muted);
  margin-bottom: 20px;
  padding-left: 32px;
}

/* æ ¸å¿ƒä¸»é¡Œç‰Œ - å–®å¼µå¤§ç‰Œ */
.core-card-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

.core-card-wrap .card-item {
  width: 180px;
  max-width: 180px;
}

.core-card-meaning {
  text-align: center;
  font-size: 0.9rem;
  color: var(--hl-ink-soft);
  max-width: 400px;
  line-height: 1.7;
}

/* é¡å‹ç‰Œçµ„ */
.type-group {
  margin-bottom: 24px;
  padding: 20px;
  border-radius: 16px;
  background: rgba(5,3,10,0.5);
  border: 1px solid rgba(240,181,179,0.15);
}

.type-group:last-child {
  margin-bottom: 0;
}

.type-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
}

.type-emoji {
  font-size: 1.5rem;
}

.type-name {
  font-weight: 800;
  color: var(--hl-gold);
  font-size: 1.05rem;
}

.type-desc {
  font-size: 0.8rem;
  color: var(--hl-ink-muted);
  margin-left: auto;
}

.type-cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media(max-width: 600px) {
  .type-cards { gap: 10px; }
}

.type-card-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.type-card-wrap .card-item {
  width: 100%;
  max-width: 140px;
}

.card-role-label {
  margin-top: 8px;
  font-size: 0.75rem;
  color: var(--hl-ink-soft);
  text-align: center;
}

.card-role-label .role-icon {
  margin-right: 4px;
}

/* é«˜æˆ‘æŒ‡å¼• */
.highself-cards {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 12px;
}

@media(max-width: 800px) {
  .highself-cards { grid-template-columns: repeat(3, 1fr); }
}

@media(max-width: 500px) {
  .highself-cards { grid-template-columns: repeat(2, 1fr); }
}

.highself-card-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.highself-card-wrap .card-item {
  width: 100%;
  max-width: 120px;
}

.highself-num {
  margin-top: 6px;
  font-size: 0.7rem;
  color: var(--hl-gold);
  font-weight: 700;
}

/* å–®å¼µç‰Œ */
.card-item {
  border-radius: 12px;
  border: 1.5px solid rgba(240,181,179,0.4);
  background: radial-gradient(circle at top left, rgba(240,181,179,0.15), transparent 60%), rgba(9,6,20,0.96);
  box-shadow: 0 8px 24px rgba(0,0,0,0.7);
  overflow: hidden;
  transition: all 0.35s var(--hl-ease);
}

.card-item:hover {
  transform: translateY(-4px) scale(1.02);
  border-color: var(--hl-rose);
  box-shadow: 0 12px 32px rgba(0,0,0,0.85), 0 0 20px rgba(240,181,179,0.2);
}

.card-thumb {
  display: block;
  width: 100%;
  aspect-ratio: 7/10;
  object-fit: contain;
  background: radial-gradient(circle at center, #1a1220, #050309);
}

.card-label {
  padding: 8px 6px;
  text-align: center;
  font-weight: 800;
  font-size: 0.75rem;
  color: #fff5f5;
  background: radial-gradient(circle at top left, rgba(240,181,179,0.15), transparent 60%), rgba(5,5,15,0.98);
  border-top: 1px solid rgba(240,181,179,0.3);
  letter-spacing: 1px;
  line-height: 1.4;
}

/* çµæœèªªæ˜ */
.result-note {
  margin-top: 24px;
  padding: 24px;
  border-radius: 16px;
  background: radial-gradient(circle at top, rgba(240,181,179,0.12), transparent 50%), rgba(9,6,20,0.9);
  border: 1px solid rgba(240,181,179,0.3);
  text-align: center;
}

.result-note p {
  font-size: 0.9rem;
  color: var(--hl-ink-soft);
  line-height: 1.9;
  margin-bottom: 12px;
}

.result-note p:last-child { margin-bottom: 0; }

.result-note strong { color: var(--hl-gold); }

/* CTA */
.cta-section { text-align: center; }

.cta-title {
  font-family: var(--hl-font-serif);
  font-size: 1.4rem;
  font-weight: 600;
  color: var(--hl-rose);
  margin-bottom: 16px;
}

.cta-desc {
  font-size: 0.95rem;
  color: var(--hl-ink-soft);
  line-height: 1.9;
  margin-bottom: 24px;
}

.cta-price {
  font-size: 1.8rem;
  font-weight: 900;
  color: var(--hl-gold);
  margin-bottom: 8px;
}

.cta-price-note {
  font-size: 0.85rem;
  color: var(--hl-ink-muted);
  margin-bottom: 24px;
}

.cta-btns {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-width: 400px;
  margin: 0 auto;
}

.cta-btn {
  display: block;
  text-decoration: none;
  padding: 16px 28px;
  border-radius: 999px;
  font-weight: 900;
  font-size: 1rem;
  text-align: center;
  transition: all 0.3s var(--hl-ease);
}

.cta-btn-primary {
  background: linear-gradient(135deg, var(--hl-gold), var(--hl-gold-deep));
  color: #20120a;
  box-shadow: 0 12px 32px rgba(0,0,0,0.8), 0 0 24px rgba(233,194,125,0.5);
}

.cta-btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 16px 40px rgba(0,0,0,0.9), 0 0 32px rgba(233,194,125,0.7);
}

.cta-btn-secondary {
  background: transparent;
  color: var(--hl-gold);
  border: 2px solid var(--hl-gold-deep);
}

.cta-btn-secondary:hover {
  background: rgba(233,194,125,0.15);
}

/* Footer */
.footer {
  margin-top: 32px;
  padding: 28px 24px;
  border-radius: 20px;
  backdrop-filter: blur(18px) saturate(150%);
  background: radial-gradient(circle at top left, rgba(240,181,179,0.12), transparent 55%), rgba(10,6,24,0.90);
  border: 1px solid rgba(240,181,179,0.3);
  text-align: center;
}

.footer-text {
  font-size: 0.8rem;
  color: var(--hl-ink-soft);
  line-height: 1.8;
  margin-bottom: 16px;
}

.footer-copyright {
  font-size: 0.75rem;
  color: var(--hl-ink-muted);
}

.footer-link {
  display: inline-block;
  margin-top: 16px;
  padding: 12px 24px;
  background: linear-gradient(135deg, var(--hl-gold), var(--hl-gold-deep));
  color: #20120a;
  font-weight: 800;
  border-radius: 999px;
  text-decoration: none;
  box-shadow: 0 8px 24px rgba(0,0,0,0.7), 0 0 16px rgba(233,194,125,0.4);
  transition: all 0.25s var(--hl-ease);
}

.footer-link:hover { transform: translateY(-2px); }

/* Modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.modal-overlay.show {
  opacity: 1;
  pointer-events: all;
}

.modal-content {
  background: radial-gradient(circle at top left, rgba(240,181,179,0.18), transparent 55%), rgba(10,6,24,0.98);
  border: 1.5px solid var(--hl-border-rose);
  border-radius: 24px;
  padding: 36px 32px;
  max-width: 520px;
  width: 92%;
  box-shadow: 0 24px 70px rgba(0,0,0,0.85), 0 0 40px rgba(240,181,179,0.2);
  transform: scale(0.9);
  transition: transform 0.3s;
}

.modal-overlay.show .modal-content { transform: scale(1); }

.modal-header { text-align: center; margin-bottom: 24px; }
.modal-icon { font-size: 56px; margin-bottom: 16px; }

.modal-title {
  font-family: var(--hl-font-serif);
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--hl-rose);
  margin-bottom: 10px;
}

.modal-subtitle {
  font-size: 0.95rem;
  color: var(--hl-ink-soft);
  line-height: 1.7;
}

.modal-body { margin: 24px 0; }

.modal-question {
  width: 100%;
  min-height: 100px;
  padding: 16px;
  border-radius: 14px;
  border: 2px solid var(--hl-border-rose);
  background: rgba(20,15,30,0.8);
  color: var(--hl-ink-main);
  font-family: var(--hl-font-main);
  font-size: 0.95rem;
  resize: vertical;
}

.modal-question::placeholder { color: rgba(255,255,255,0.4); }

.modal-question:focus {
  outline: none;
  border-color: var(--hl-rose);
  box-shadow: 0 0 0 4px rgba(240,181,179,0.2);
}

.modal-footer {
  display: flex;
  gap: 12px;
  justify-content: center;
}

.modal-btn {
  padding: 14px 28px;
  border-radius: 14px;
  font-size: 1rem;
  font-weight: 800;
  cursor: pointer;
  border: none;
  transition: all 0.25s var(--hl-ease);
  font-family: var(--hl-font-main);
}

.modal-btn-primary {
  background: linear-gradient(135deg, var(--hl-rose), var(--hl-rose-deep));
  color: #2a1515;
  box-shadow: 0 10px 28px rgba(0,0,0,0.8), 0 0 20px rgba(240,181,179,0.5);
}

.modal-btn-primary:hover { transform: translateY(-2px); }

.modal-btn-secondary {
  background: transparent;
  color: var(--hl-rose);
  border: 2px solid var(--hl-border-rose);
}

.modal-btn-secondary:hover { background: var(--hl-rose-soft); }

/* Toast */
.toast {
  position: fixed;
  left: 50%;
  bottom: 32px;
  transform: translateX(-50%);
  background: linear-gradient(135deg, var(--hl-rose), var(--hl-rose-deep));
  color: #2a1515;
  padding: 14px 28px;
  border-radius: 14px;
  font-size: 0.95rem;
  font-weight: 700;
  z-index: 9999;
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
  animation: toast-in 0.35s ease-out;
}

@keyframes toast-in {
  from { opacity: 0; transform: translateX(-50%) translateY(24px); }
  to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

@media (max-width: 640px) {
  .glass-panel { padding: 24px 18px; }
  .hero-title { letter-spacing: 2px; }
  .draw-btn { padding: 14px 24px; font-size: 0.9rem; }
  .cta-price { font-size: 1.5rem; }
  .spread-section { padding: 16px 18px; }
  .type-cards { grid-template-columns: repeat(3, 1fr); }
}
</style>
</head>
<body>

<header class="header">
  <a href="index.html" class="logo">é¦¥éˆä¹‹é‘° <span>Hour Light</span></a>
  <a href="draw.html" class="back-link">â† è¿”å›ä¸»æŠ½ç‰Œ</a>
</header>

<main class="main">

  <!-- Hero -->
  <section class="glass-panel hero">
    <div class="hero-icon">ğŸª¶</div>
    <h1 class="hero-title">é¦¥éˆè¼•ç›ˆï½œæ„è­˜ç˜¦èº«å”è­°</h1>
    <p class="hero-subtitle">28å¼µç‰Œå¡ Ã— 7ç¨®é¡å‹ Ã— æ·±åº¦è¨ªè«‡</p>
    <p class="hero-desc">
      è‚¥èƒ–å¾ä¾†ä¸æ˜¯æ„å¿—åŠ›çš„å•é¡Œï¼Œæ˜¯èº«é«”åœ¨ç”¨è„‚è‚ªä¿è­·ä½ ã€‚<br>
      é€éæ·±åº¦è¨ªè«‡èˆ‡ç‰Œå¡è§£è®€ï¼Œæ‰¾å‡ºé«”é‡èƒŒå¾Œçš„æƒ…ç·’æ ¹æºï¼Œ<br>
      ä¸ç¯€é£Ÿã€ä¸é‹å‹•ã€ä¸é æ„å¿—åŠ›â€”â€”å¾æ ¹æºé‡‹æ”¾ï¼Œè‡ªç„¶å›åˆ°è©²æœ‰çš„è¼•ç›ˆã€‚
    </p>

    <div class="structure-info">
      <div class="structure-item">
        <div class="num">1</div>
        <div class="label">ğŸŒŸ æ ¸å¿ƒä¸»é¡Œç‰Œ<br><small>ä½ èˆ‡èº«é«”çš„æ„è­˜ç‹€æ…‹</small></div>
      </div>
      <div class="structure-item">
        <div class="num">21</div>
        <div class="label">ğŸ“ ä¸ƒé¡å‹æ¢ç´¢ç‰Œ<br><small>æ ¹æº Ã— ææ‡¼ Ã— ç²¾æ²¹</small></div>
      </div>
      <div class="structure-item">
        <div class="num">6</div>
        <div class="label">âœ¨ é«˜æˆ‘æŒ‡å¼•ç‰Œ<br><small>å…§åœ¨æ™ºæ…§çš„è½‰åŒ–è¨Šæ¯</small></div>
      </div>
    </div>
  </section>

  <!-- æŠ½ç‰Œå€ -->
  <section class="glass-panel draw-section">
    <h2 class="section-title">ğŸª¶ é¦¥éˆè¼•ç›ˆç‰Œå¡æŠ½å–</h2>
    <p class="section-hint" id="guideHint">
      å…ˆåœ¨å¿ƒä¸­æƒ³è‘—ä½ èˆ‡èº«é«”ã€é«”é‡ã€é£Ÿç‰©çš„é—œä¿‚<br>
      ç„¶å¾ŒæŠ½å– 28 å¼µç‰Œï¼ŒæŠ½å®Œè«‹è¤‡è£½ç‰Œé™£çµæœï¼Œé ç´„èª¿é »å¸«é€²è¡Œæ·±åº¦è§£è®€
    </p>

    <div class="draw-btn-row" id="drawBtnRow">
      <button class="draw-btn" id="drawBtn">ğŸª¶ æŠ½å– 28 å¼µç‰Œå¡</button>
    </div>

    <div class="toolbar">
      <button class="tool-btn tool-btn-gold" id="copyBtn" disabled>ğŸ“‹ è¤‡è£½ç‰Œé™£çµæœ</button>
      <button class="tool-btn" id="shareBtn" disabled>ğŸ”— ç”¢ç”Ÿåˆ†äº«é€£çµ</button>
      <button class="tool-btn" id="clearBtn">ğŸ”„ æ¸…é™¤é‡æŠ½</button>
    </div>

    <!-- ç‰Œé™£çµæœ -->
    <div id="spreadResult" class="spread-result" style="display:none;"></div>

    <div class="result-note" id="resultNote" style="display:none;">
      <p>âœ¨ ä½ å·²æŠ½å– <strong>28 å¼µ</strong>é¦¥éˆè¼•ç›ˆç‰Œå¡</p>
      <p>ğŸŒŸ <strong>1å¼µæ ¸å¿ƒä¸»é¡Œ</strong> + ğŸ“ <strong>21å¼µé¡å‹æ¢ç´¢</strong>ï¼ˆ7é¡å‹Ã—3å¼µï¼‰ + âœ¨ <strong>6å¼µé«˜æˆ‘æŒ‡å¼•</strong></p>
      <p>ğŸ“‹ è«‹é»æ“Š<strong>ã€Œè¤‡è£½ç‰Œé™£çµæœã€</strong>ï¼Œç„¶å¾Œé ç´„èª¿é »å¸«é€²è¡Œå®Œæ•´æ·±åº¦è§£è®€</p>
    </div>
  </section>

  <!-- CTA -->
  <section class="glass-panel cta-section">
    <h3 class="cta-title">ğŸŒŸ å®Œæ•´æ·±åº¦è§£è®€æœå‹™</h3>
    <p class="cta-desc">
      é¦¥éˆè¼•ç›ˆä¸åªæ˜¯æŠ½ç‰Œï¼Œæ˜¯ä¸€å¥—å®Œæ•´çš„æ„è­˜ç˜¦èº«å”è­°<br>
      ç”±èª¿é »å¸«ä¸€å°ä¸€æ·±åº¦è¨ªè«‡ï¼Œçµåˆç‰Œå¡è§£è®€èˆ‡ç²¾æ²¹è™•æ–¹<br>
      å¾æƒ…ç·’æ ¹æºè‘—æ‰‹ï¼Œè®“ä½ çš„èº«é«”è‡ªç„¶å›åˆ°è©²æœ‰çš„è¼•ç›ˆç‹€æ…‹
    </p>
    <div class="cta-price">NT$ 6,600</div>
    <p class="cta-price-note">å«æ·±åº¦è¨ªè«‡ + å®Œæ•´è§£è®€å ±å‘Š + ç²¾æ²¹è™•æ–¹å»ºè­° + 21å¤©è¡Œå‹•æ–¹æ¡ˆ</p>
    <div class="cta-btns">
      <a href="https://lin.ee/vpbLhNjF" class="cta-btn cta-btn-primary" target="_blank" rel="noopener">ğŸ’¬ LINE é ç´„æ·±åº¦è§£è®€</a>
      <a href="services.html" class="cta-btn cta-btn-secondary">ğŸ“– äº†è§£æ›´å¤šæœå‹™</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <p class="footer-text">
      ğŸ›¡ï¸ <strong>æº«é¦¨æé†’</strong><br>
      é¦¥éˆè¼•ç›ˆæä¾›æƒ…ç·’ç´“è§£ã€å£“åŠ›ç®¡ç†ã€èƒ½é‡èª¿é »ç­‰æ—¥å¸¸æŒ‡å¼•ï¼Œ<br>
      ä¸å±¬æ–¼é†«ç™‚è¡Œç‚ºï¼Œè‹¥æœ‰èº«å¿ƒä¸é©è«‹å°‹æ±‚å°ˆæ¥­é†«ç™‚å”åŠ©ã€‚
    </p>
    <p class="footer-copyright">Â© 2026 é¦¥éˆä¹‹é‘°â„¢ Hour Lightâ„¢ï½œAll Rights Reserved</p>
    <a href="https://lin.ee/vpbLhNjF" class="footer-link" target="_blank" rel="noopener">ğŸ’¬ è¯çµ¡æˆ‘å€‘</a>
  </footer>

</main>

<!-- Modal -->
<div id="confirmModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-icon">ğŸª¶</div>
      <h2 class="modal-title">æº–å‚™å¥½æ¢ç´¢äº†å—ï¼Ÿ</h2>
      <p class="modal-subtitle">
        è«‹å…ˆåœ¨å¿ƒä¸­æƒ³å¥½ä½ æƒ³å•çš„å•é¡Œ<br>
        é—œæ–¼é«”é‡ã€èº«æã€é£²é£Ÿã€æˆ–æ˜¯èˆ‡èº«é«”çš„é—œä¿‚<br>
        ç„¶å¾ŒæŒ‰ä¸‹ç¢ºå®šé–‹å§‹æŠ½ç‰Œ
      </p>
    </div>
    <div class="modal-body">
      <textarea id="modalQuestion" class="modal-question" placeholder="ä½ ä¹Ÿå¯ä»¥åœ¨é€™è£¡å¯«ä¸‹å•é¡Œï¼ˆé¸å¡«ï¼‰&#10;ä¾‹å¦‚ï¼šç‚ºä»€éº¼æˆ‘ç¸½æ˜¯ç˜¦ä¸ä¸‹ä¾†ï¼Ÿ&#10;ä¾‹å¦‚ï¼šæˆ‘å’Œé£Ÿç‰©çš„é—œä¿‚æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
    </div>
    <div class="modal-footer">
      <button class="modal-btn modal-btn-secondary" id="modalCancel">å–æ¶ˆ</button>
      <button class="modal-btn modal-btn-primary" id="modalConfirm">ğŸª¶ ç¢ºå®šï¼Œé–‹å§‹æŠ½ç‰Œ</button>
    </div>
  </div>
</div>

<!-- å¼•ç”¨ç‰Œå¡è³‡æ–™ -->
<script src="cardData.js"></script>

<script>
'use strict';

// ==============================
// ç‰Œå¡è³‡æ–™
// ==============================

// å¤§ç§˜å„€ A00-A21 (22å¼µ)
const ARCANA_CARDS = [
  'A00','A01','A02','A03','A04','A05','A06','A07','A08','A09','A10',
  'A11','A12','A13','A14','A15','A16','A17','A18','A19','A20','A21'
];

// ç²¾æ²¹ç‰Œ 001-108 (108å¼µ)
const OIL_CARDS = [];
for (let i = 1; i <= 108; i++) {
  OIL_CARDS.push(String(i).padStart(3, '0'));
}

// 7ç¨®è‚¥èƒ–é¡å‹ - å®Œæ•´å®šç¾©
const TYPES = [
  { 
    id: 'emotional', 
    name: 'æƒ…ç·’å¡«å……å‹', 
    emoji: 'ğŸ’”',
    desc: 'ç”¨é£Ÿç‰©å¡«è£œæƒ…ç·’ç©ºæ´',
    detail: 'é£Ÿç‰©æˆç‚ºä¸»è¦çš„æƒ…ç·’èª¿ç¯€å·¥å…·'
  },
  { 
    id: 'stress', 
    name: 'å£“åŠ›å€‰å„²å‹', 
    emoji: 'âš¡',
    desc: 'é•·æœŸé«˜å£“å°è‡´çš®è³ªé†‡åé«˜',
    detail: 'èº«é«”é€²å…¥å„²å­˜æ¨¡å¼ï¼Œè„‚è‚ªå †ç©åœ¨è…¹éƒ¨'
  },
  { 
    id: 'trauma', 
    name: 'å‰µå‚·ä¿è­·å‹', 
    emoji: 'ğŸ›¡ï¸',
    desc: 'èº«é«”ç”¨è„‚è‚ªä½œç‚ºä¿è­·å±¤',
    detail: 'æ½›æ„è­˜èªç‚ºé«”å‹å¤§ä¸€é»æ¯”è¼ƒå®‰å…¨'
  },
  { 
    id: 'family', 
    name: 'å®¶æ—å‚³æ‰¿å‹', 
    emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§',
    desc: 'ç„¡æ„è­˜èªåŒå®¶æ—çš„è‚¥èƒ–æ¨¡å¼',
    detail: 'æ‰¿è¼‰ä¸å±¬æ–¼è‡ªå·±çš„é‡é‡'
  },
  { 
    id: 'neural', 
    name: 'ç¥ç¶“å¤±èª¿å‹', 
    emoji: 'ğŸ”Œ',
    desc: 'é£¢é¤“/é£½è¶³è¨Šè™Ÿæ··äº‚',
    detail: 'è¿·èµ°ç¥ç¶“åŠŸèƒ½ä½ä¸‹ï¼Œå¤§è…¦èˆ‡èº«é«”æºé€šä¸è‰¯'
  },
  { 
    id: 'metabolic', 
    name: 'ä»£è¬å—æå‹', 
    emoji: 'ğŸ”¥',
    desc: 'éå»æ¥µç«¯ç¯€é£Ÿæå®³ä»£è¬',
    detail: 'èº«é«”é€²å…¥é£¢è’æ¨¡å¼ï¼Œåƒå¾ˆå°‘é‚„æ˜¯ç˜¦ä¸ä¸‹ä¾†'
  },
  { 
    id: 'worth', 
    name: 'è‡ªæˆ‘åƒ¹å€¼å‹', 
    emoji: 'ğŸ‘‘',
    desc: 'æŠŠé«”é‡å’Œè‡ªæˆ‘åƒ¹å€¼ç¶åœ¨ä¸€èµ·',
    detail: 'ã€Œèƒ–=å¤±æ•—ã€ã€Œç˜¦=æˆåŠŸã€ï¼Œå°è‡ªå·±æ¥µåº¦åš´è‹›'
  }
];

// ç‰Œå¡è§’è‰²å®šç¾©
const CARD_ROLES = {
  root: { icon: 'ğŸ”', name: 'æ ¹æºç‰Œ', desc: 'çœ‹è¦‹å•é¡Œçš„æ ¹æºåœ¨å“ªè£¡' },
  fear: { icon: 'ğŸ˜¨', name: 'ææ‡¼ç‰Œ', desc: 'æ½›æ„è­˜åœ¨å®³æ€•ä»€éº¼' },
  oil: { icon: 'ğŸŒ¿', name: 'ç²¾æ²¹ç‰Œ', desc: 'ç²¾æ²¹èƒ½é‡è™•æ–¹å»ºè­°' }
};

// ==============================
// è¼”åŠ©å‡½æ•¸
// ==============================

function getCardName(code) {
  if (typeof cardData !== 'undefined' && cardData[code]) {
    return cardData[code].title || cardData[code].name || '';
  }
  return '';
}

// ==============================
// æŠ½ç‰Œçµæœçµæ§‹
// ==============================

let drawResult = null;
let userQuestion = '';

// ==============================
// DOM
// ==============================

let drawBtn, copyBtn, shareBtn, clearBtn, guideHint, resultNote, spreadResult, drawBtnRow;
let confirmModal, modalQuestion, modalConfirm, modalCancel;

document.addEventListener('DOMContentLoaded', () => {
  drawBtn = document.getElementById('drawBtn');
  copyBtn = document.getElementById('copyBtn');
  shareBtn = document.getElementById('shareBtn');
  clearBtn = document.getElementById('clearBtn');
  guideHint = document.getElementById('guideHint');
  resultNote = document.getElementById('resultNote');
  spreadResult = document.getElementById('spreadResult');
  drawBtnRow = document.getElementById('drawBtnRow');
  confirmModal = document.getElementById('confirmModal');
  modalQuestion = document.getElementById('modalQuestion');
  modalConfirm = document.getElementById('modalConfirm');
  modalCancel = document.getElementById('modalCancel');

  bindEvents();
  restoreFromURL();
});

function bindEvents() {
  drawBtn.addEventListener('click', showModal);
  clearBtn.addEventListener('click', clearDraw);
  copyBtn.addEventListener('click', copySpreadResult);
  shareBtn.addEventListener('click', generateShareLink);
  modalConfirm.addEventListener('click', handleConfirm);
  modalCancel.addEventListener('click', hideModal);
  confirmModal.addEventListener('click', (e) => {
    if (e.target === confirmModal) hideModal();
  });
}

function showModal() {
  confirmModal.classList.add('show');
  modalQuestion.value = '';
  document.body.style.overflow = 'hidden';
}

function hideModal() {
  confirmModal.classList.remove('show');
  document.body.style.overflow = '';
}

function handleConfirm() {
  userQuestion = modalQuestion.value.trim();
  hideModal();
  performDraw();
}

// ==============================
// æŠ½ç‰Œé‚è¼¯
// ==============================

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function performDraw() {
  // æ‰“äº‚å¤§ç§˜å„€ï¼Œå–7å¼µ (1æ ¸å¿ƒ + 6é«˜æˆ‘)
  const shuffledArcana = shuffle(ARCANA_CARDS);
  const coreTheme = shuffledArcana[0];
  const highSelf = shuffledArcana.slice(1, 7);

  // æ‰“äº‚ç²¾æ²¹ç‰Œï¼Œå–21å¼µ (7é¡å‹ Ã— 3å¼µ)
  const shuffledOils = shuffle(OIL_CARDS);
  const types = [];
  
  for (let i = 0; i < 7; i++) {
    const t = TYPES[i];
    types.push({
      typeId: t.id,
      typeName: t.name,
      emoji: t.emoji,
      desc: t.desc,
      detail: t.detail,
      root: shuffledOils[i * 3],
      fear: shuffledOils[i * 3 + 1],
      oil: shuffledOils[i * 3 + 2]
    });
  }

  drawResult = { coreTheme, types, highSelf };

  renderSpread();
  updateURL();
  showToast('âœ¨ å·²æŠ½å– 28 å¼µé¦¥éˆè¼•ç›ˆç‰Œå¡');
}

// ==============================
// æ¸²æŸ“ç‰Œé™£
// ==============================

function renderSpread() {
  if (!drawResult) {
    guideHint.style.display = 'block';
    resultNote.style.display = 'none';
    spreadResult.style.display = 'none';
    drawBtnRow.style.display = 'flex';
    copyBtn.disabled = true;
    shareBtn.disabled = true;
    return;
  }

  guideHint.style.display = 'none';
  resultNote.style.display = 'block';
  spreadResult.style.display = 'block';
  drawBtnRow.style.display = 'none';
  copyBtn.disabled = false;
  shareBtn.disabled = false;

  let html = '';

  // ========== æ ¸å¿ƒä¸»é¡Œ ==========
  const coreName = getCardName(drawResult.coreTheme);
  html += `
    <div class="spread-section">
      <div class="spread-section-title">
        <span class="emoji">ğŸŒŸ</span> æ ¸å¿ƒä¸»é¡Œï½œä½ èˆ‡èº«é«”é—œä¿‚çš„æ„è­˜ç‹€æ…‹
      </div>
      <div class="spread-section-desc">é€™å¼µç‰Œæ­ç¤ºä½ ç›®å‰èˆ‡èº«é«”ã€é«”é‡ã€é£Ÿç‰©ä¹‹é–“çš„æ ¸å¿ƒè­°é¡Œ</div>
      <div class="core-card-wrap">
        ${renderCard(drawResult.coreTheme, coreName)}
        <div class="core-card-meaning">
          é€™æ˜¯ä½ ç•¶å‰èˆ‡èº«é«”é—œä¿‚çš„ã€Œä¸»æ—‹å¾‹ã€<br>
          å¾ŒçºŒçš„é¡å‹æ¢ç´¢éƒ½åœç¹é€™å€‹æ ¸å¿ƒè­°é¡Œå±•é–‹
        </div>
      </div>
    </div>
  `;

  // ========== ä¸ƒç¨®é¡å‹æ¢ç´¢ ==========
  html += `
    <div class="spread-section">
      <div class="spread-section-title">
        <span class="emoji">ğŸ“</span> ä¸ƒç¨®é¡å‹æ¢ç´¢ï½œæ ¹æº Ã— ææ‡¼ Ã— ç²¾æ²¹
      </div>
      <div class="spread-section-desc">æ¯ç¨®é¡å‹å„æŠ½3å¼µç‰Œï¼šçœ‹è¦‹æ ¹æºã€é¢å°ææ‡¼ã€æ‰¾åˆ°ç²¾æ²¹è™•æ–¹</div>
  `;

  for (const t of drawResult.types) {
    const rootName = getCardName(t.root);
    const fearName = getCardName(t.fear);
    const oilName = getCardName(t.oil);
    
    html += `
      <div class="type-group">
        <div class="type-header">
          <span class="type-emoji">${t.emoji}</span>
          <span class="type-name">${t.typeName}</span>
          <span class="type-desc">${t.desc}</span>
        </div>
        <div class="type-cards">
          <div class="type-card-wrap">
            ${renderCard(t.root, rootName)}
            <div class="card-role-label"><span class="role-icon">ğŸ”</span>æ ¹æºç‰Œ</div>
          </div>
          <div class="type-card-wrap">
            ${renderCard(t.fear, fearName)}
            <div class="card-role-label"><span class="role-icon">ğŸ˜¨</span>ææ‡¼ç‰Œ</div>
          </div>
          <div class="type-card-wrap">
            ${renderCard(t.oil, oilName)}
            <div class="card-role-label"><span class="role-icon">ğŸŒ¿</span>ç²¾æ²¹ç‰Œ</div>
          </div>
        </div>
      </div>
    `;
  }

  html += '</div>';

  // ========== é«˜æˆ‘æŒ‡å¼• ==========
  html += `
    <div class="spread-section">
      <div class="spread-section-title">
        <span class="emoji">âœ¨</span> é«˜æˆ‘æŒ‡å¼•ï½œå…§åœ¨æ™ºæ…§çµ¦ä½ çš„è½‰åŒ–è¨Šæ¯
      </div>
      <div class="spread-section-desc">6å¼µå¤§ç§˜å„€ç‰Œï¼Œä¾†è‡ªä½ å…§åœ¨æ™ºæ…§çš„æŒ‡å¼•èˆ‡ç¥ç¦</div>
      <div class="highself-cards">
  `;
  
  drawResult.highSelf.forEach((code, i) => {
    const name = getCardName(code);
    html += `
      <div class="highself-card-wrap">
        ${renderCard(code, name)}
        <div class="highself-num">æŒ‡å¼• ${i+1}</div>
      </div>
    `;
  });
  
  html += `
      </div>
    </div>
  `;

  spreadResult.innerHTML = html;
}

function renderCard(cardId, cardName) {
  return `
    <div class="card-item">
      <img class="card-thumb" src="${cardId}.png" alt="${cardId}" onerror="this.style.background='linear-gradient(135deg,#1a1220,#050309)'">
      <div class="card-label">${cardId}${cardName ? '<br>' + cardName : ''}</div>
    </div>
  `;
}

// ==============================
// è¤‡è£½ç‰Œé™£çµæœ - å®Œæ•´æ˜ç¢ºç‰ˆ
// ==============================

function copySpreadResult() {
  if (!drawResult) return;

  const now = new Date();
  const dateStr = `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()}`;
  const coreName = getCardName(drawResult.coreTheme);

  let text = ``;
  text += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
  text += `ğŸª¶ é¦¥éˆè¼•ç›ˆï½œæ„è­˜ç˜¦èº«ç‰Œå¡çµæœ\n`;
  text += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
  text += `ğŸ“… æŠ½ç‰Œæ—¥æœŸï¼š${dateStr}\n`;
  if (userQuestion) {
    text += `â“ æå•ï¼š${userQuestion}\n`;
  }
  text += `\n`;

  // æ ¸å¿ƒä¸»é¡Œ
  text += `â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n`;
  text += `â”‚ ğŸŒŸã€æ ¸å¿ƒä¸»é¡Œã€‘               â”‚\n`;
  text += `â”‚ ä½ èˆ‡èº«é«”é—œä¿‚çš„æ„è­˜ç‹€æ…‹       â”‚\n`;
  text += `â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n`;
  text += `   ${drawResult.coreTheme}${coreName ? ' ' + coreName : ''}\n\n`;

  // ä¸ƒç¨®é¡å‹
  text += `â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n`;
  text += `â”‚ ğŸ“ã€ä¸ƒç¨®é¡å‹æ¢ç´¢ã€‘           â”‚\n`;
  text += `â”‚ æ ¹æº Ã— ææ‡¼ Ã— ç²¾æ²¹          â”‚\n`;
  text += `â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n`;

  for (const t of drawResult.types) {
    const rootName = getCardName(t.root);
    const fearName = getCardName(t.fear);
    const oilName = getCardName(t.oil);
    
    text += `${t.emoji} ${t.typeName}\n`;
    text += `   ${t.desc}\n`;
    text += `   â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„\n`;
    text += `   ğŸ” æ ¹æºç‰Œï¼š${t.root}${rootName ? ' ' + rootName : ''}\n`;
    text += `   ğŸ˜¨ ææ‡¼ç‰Œï¼š${t.fear}${fearName ? ' ' + fearName : ''}\n`;
    text += `   ğŸŒ¿ ç²¾æ²¹ç‰Œï¼š${t.oil}${oilName ? ' ' + oilName : ''}\n\n`;
  }

  // é«˜æˆ‘æŒ‡å¼•
  text += `â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n`;
  text += `â”‚ âœ¨ã€é«˜æˆ‘æŒ‡å¼•ã€‘               â”‚\n`;
  text += `â”‚ å…§åœ¨æ™ºæ…§çµ¦ä½ çš„è½‰åŒ–è¨Šæ¯       â”‚\n`;
  text += `â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n`;
  
  drawResult.highSelf.forEach((code, i) => {
    const name = getCardName(code);
    text += `   æŒ‡å¼•${i+1}ï¼š${code}${name ? ' ' + name : ''}\n`;
  });

  text += `\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
  text += `ğŸ“Š ç‰Œå¡çµ±è¨ˆ\n`;
  text += `   ğŸŒŸ æ ¸å¿ƒä¸»é¡Œç‰Œï¼š1 å¼µï¼ˆå¤§ç§˜å„€ï¼‰\n`;
  text += `   ğŸ“ é¡å‹æ¢ç´¢ç‰Œï¼š21 å¼µï¼ˆ7é¡å‹Ã—3å¼µï¼‰\n`;
  text += `   âœ¨ é«˜æˆ‘æŒ‡å¼•ç‰Œï¼š6 å¼µï¼ˆå¤§ç§˜å„€ï¼‰\n`;
  text += `   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;
  text += `   ğŸ“¦ ç¸½è¨ˆï¼š28 å¼µç‰Œå¡\n`;
  text += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n`;

  text += `ğŸ’« é€™ 28 å¼µç‰Œæ­ç¤ºäº†ä½ èº«é«”èˆ‡æƒ…ç·’çš„æ·±å±¤è¨Šæ¯\n`;
  text += `ğŸ“‹ è«‹å°‡æ­¤çµæœå‚³çµ¦èª¿é »å¸«ï¼Œé ç´„å®Œæ•´æ·±åº¦è§£è®€\n\n`;

  text += `ğŸª¶ é¦¥éˆè¼•ç›ˆï½œæ„è­˜ç˜¦èº«å”è­°\n`;
  text += `   ä¸ç¯€é£Ÿ Ã— ä¸é‹å‹• Ã— ä¸é æ„å¿—åŠ›\n`;
  text += `   å¾æƒ…ç·’æ ¹æºè§£æ±ºé«”é‡å•é¡Œ\n\n`;

  text += `ğŸ’¬ é ç´„æ·±åº¦è§£è®€\n`;
  text += `ğŸ‘‰ https://lin.ee/vpbLhNjF\n`;
  text += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;

  copyToClipboard(text, 'âœ… ç‰Œé™£çµæœå·²è¤‡è£½ï¼å¯ç›´æ¥è²¼åˆ° LINE é ç´„è§£è®€');
}

// ==============================
// åˆ†äº«é€£çµ
// ==============================

function generateShareLink() {
  if (!drawResult) return;

  const data = {
    c: drawResult.coreTheme,
    t: drawResult.types.map(t => `${t.root},${t.fear},${t.oil}`).join('|'),
    h: drawResult.highSelf.join(',')
  };

  const encoded = btoa(JSON.stringify(data));
  const url = new URL(location.href);
  url.searchParams.set('s', encoded);
  
  copyToClipboard(url.toString(), 'ğŸ”— åˆ†äº«é€£çµå·²è¤‡è£½ï¼');
}

// ==============================
// URL ç‹€æ…‹
// ==============================

function updateURL() {
  const url = new URL(location.href);
  
  if (drawResult) {
    const data = {
      c: drawResult.coreTheme,
      t: drawResult.types.map(t => `${t.root},${t.fear},${t.oil}`).join('|'),
      h: drawResult.highSelf.join(',')
    };
    url.searchParams.set('s', btoa(JSON.stringify(data)));
  } else {
    url.searchParams.delete('s');
  }
  
  history.replaceState(null, '', url);
}

function restoreFromURL() {
  const url = new URL(location.href);
  const encoded = url.searchParams.get('s');
  if (!encoded) return;

  try {
    const data = JSON.parse(atob(encoded));
    
    const types = data.t.split('|').map((group, i) => {
      const [root, fear, oil] = group.split(',');
      const t = TYPES[i];
      return {
        typeId: t.id,
        typeName: t.name,
        emoji: t.emoji,
        desc: t.desc,
        detail: t.detail,
        root, fear, oil
      };
    });

    drawResult = {
      coreTheme: data.c,
      types,
      highSelf: data.h.split(',')
    };

    renderSpread();
  } catch (e) {
    console.error('Failed to restore from URL', e);
  }
}

// ==============================
// æ¸…é™¤
// ==============================

function clearDraw() {
  if (!drawResult) {
    showToast('ç›®å‰æ²’æœ‰å·²æŠ½çš„ç‰Œ');
    return;
  }
  if (confirm('ç¢ºå®šè¦æ¸…é™¤ç›®å‰çš„æŠ½ç‰Œçµæœå—ï¼Ÿ')) {
    drawResult = null;
    userQuestion = '';
    renderSpread();
    updateURL();
    showToast('å·²æ¸…é™¤æŠ½ç‰Œçµæœ');
  }
}

// ==============================
// å·¥å…·
// ==============================

function copyToClipboard(text, successMsg) {
  if (!navigator.clipboard) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);
    showToast(successMsg);
    return;
  }
  navigator.clipboard.writeText(text).then(() => {
    showToast(successMsg);
  }).catch(() => {
    showToast('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½');
  });
}

function showToast(msg) {
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = msg;
  document.body.appendChild(toast);
  setTimeout(() => toast.remove(), 2500);
}
</script>

</body>
</html>
