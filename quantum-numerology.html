<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡å­éˆæ•¸â„¢ å®Œæ•´åˆ†æ | é¦¥éˆä¹‹é‘°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #f5f0eb 0%, #e8ddd3 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #d4a574 0%, #c89b6d 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #8b7355;
            font-size: 1.1em;
            margin-top: 10px;
        }

        .input-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #5d4e37;
            font-weight: 600;
        }

        input[type="date"],
        input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e8ddd3;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #d4a574;
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #d4a574 0%, #c89b6d 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.4);
        }

        .result-section {
            display: none;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .result-card h2 {
            color: #5d4e37;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8ddd3;
        }

        .triangle-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            position: relative;
        }

        .triangle-svg {
            width: 100%;
            max-width: 500px;
            height: auto;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 30px auto;
        }

        .grid-cell {
            aspect-ratio: 1;
            border: 3px solid #d4a574;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #fff 0%, #f5f0eb 100%);
            position: relative;
            transition: all 0.3s;
        }

        .grid-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 16px rgba(212, 165, 116, 0.3);
        }

        .grid-number {
            font-size: 2em;
            font-weight: bold;
            color: #5d4e37;
        }

        .grid-dots {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 8px;
            max-width: 60px;
            justify-content: center;
        }

        .dot {
            width: 10px;
            height: 10px;
            background: #d4a574;
            border-radius: 50%;
        }

        .traits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .trait-card {
            padding: 20px;
            background: linear-gradient(135deg, #fff 0%, #f9f6f3 100%);
            border-radius: 12px;
            border-left: 4px solid #d4a574;
        }

        .trait-title {
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .trait-content {
            color: #8b7355;
            line-height: 1.6;
        }

        .element-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-right: 8px;
        }

        .wood { background: #90EE90; color: #2d5016; }
        .fire { background: #FFB6C1; color: #8b0000; }
        .earth { background: #F4A460; color: #654321; }
        .metal { background: #D3D3D3; color: #2f4f4f; }
        .water { background: #87CEEB; color: #00008b; }

        .oil-recommendation {
            background: linear-gradient(135deg, #f9f6f3 0%, #f5f0eb 100%);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border: 2px dashed #d4a574;
        }

        .oil-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .back-btn {
            background: linear-gradient(135deg, #8b7355 0%, #6b5644 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(107, 86, 68, 0.4);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .triangle-svg {
                max-width: 100%;
            }

            .grid-container {
                max-width: 300px;
            }

            .traits-grid {
                grid-template-columns: 1fr;
            }
        }

        .connection-line {
            position: absolute;
            background: rgba(212, 165, 116, 0.3);
            height: 2px;
            transform-origin: left center;
        }

        .line-label {
            position: absolute;
            background: #d4a574;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âœ¨ é‡å­éˆæ•¸â„¢ å®Œæ•´åˆ†æ âœ¨</h1>
            <p class="subtitle">ç‹é€¸å›ç¨å‰µ | ä¸‰è§’æ˜Ÿä½åœ– Ã— ç”Ÿå‘½ä¹å®®æ ¼ Ã— èƒ½é‡èª¿é »</p>
            <p style="color: #8b7355; margin-top: 15px; font-size: 0.95em;">
                æ•´åˆé¾ç¼®å¤¤è€å¸«æ•¸å­—å¿ƒç†å­¸ Ã— è˜‡æ–¹è¡Œä¸‰è§’å®šå¾‹ Ã— æ½˜ç¦æ˜Ÿæ•¸å­—ä¿¡æ¯é æ¸¬å­¸
            </p>
        </header>

        <div class="input-section" id="inputSection">
            <h2 style="color: #5d4e37; margin-bottom: 25px;">è«‹è¼¸å…¥æ‚¨çš„å‡ºç”Ÿè³‡æ–™</h2>
            <div class="form-group">
                <label for="birthdate">å‡ºç”Ÿæ—¥æœŸ</label>
                <input type="date" id="birthdate" required>
            </div>
            <div class="form-group">
                <label for="name">å§“åï¼ˆé¸å¡«ï¼‰</label>
                <input type="text" id="name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
            </div>
            <button class="btn" onclick="calculateNumerology()">é–‹å§‹åˆ†ææˆ‘çš„ç”Ÿå‘½å¯†ç¢¼</button>
        </div>

        <div class="result-section" id="resultSection">
            <!-- ä¸‰è§’æ˜Ÿä½åœ– -->
            <div class="result-card">
                <h2>ğŸ”º ä¸‰è§’æ˜Ÿä½åœ–ï¼ˆå…§åœ¨çœŸå¯¦è‡ªæˆ‘ï¼‰</h2>
                <div class="triangle-container" id="triangleContainer"></div>
                <div id="triangleExplanation" style="margin-top: 30px;"></div>
            </div>

            <!-- ç”Ÿå‘½ä¹å®®æ ¼ -->
            <div class="result-card">
                <h2>ğŸ¯ ç”Ÿå‘½ä¹å®®æ ¼ï¼ˆå¤©è³¦èˆ‡èª²é¡Œï¼‰</h2>
                <div class="grid-container" id="gridContainer"></div>
                <div id="gridAnalysis" style="margin-top: 30px;"></div>
            </div>

            <!-- æ•¸å­—ç‰¹è³ªåˆ†æ -->
            <div class="result-card">
                <h2>ğŸŒŸ æ ¸å¿ƒæ•¸å­—èƒ½é‡è§£è®€</h2>
                <div class="traits-grid" id="traitsGrid"></div>
            </div>

            <!-- æ„å¿µå¼èŠ³ç™‚èª¿é »å»ºè­° -->
            <div class="result-card">
                <h2>ğŸŒ¿ é¦¥éˆä¹‹é‘° æ„å¿µå¼èŠ³ç™‚èª¿é »</h2>
                <p style="color: #8b7355; margin-bottom: 20px; line-height: 1.7;">
                    <strong style="color: #5d4e37;">ğŸ’¡ ä»€éº¼æ˜¯æ„å¿µå¼èŠ³ç™‚ï¼Ÿ</strong><br>
                    ä¸æ˜¯ã€Œé¼»å­åœ¨èã€ï¼Œè€Œæ˜¯ã€Œå¤§è…¦åœ¨è¨˜å¾—ã€ã€‚å°±åƒæƒ³åˆ°æª¸æª¬å°±æµå£æ°´ä¸€æ¨£ï¼Œä½ çš„å¤§è…¦æœƒå°ã€Œæƒ³åƒã€åšå‡ºçœŸå¯¦åæ‡‰ã€‚<br>
                    <strong>ä¸éœ€è¦å¯¦é«”ç²¾æ²¹</strong>ï¼Œåªè¦ç”¨æ„å¿µå•Ÿå‹•æ„Ÿå®˜è¨˜æ†¶ï¼Œå°±èƒ½èª¿æ•´æƒ…ç·’ç‹€æ…‹ã€‚ç²¾æ²¹æ˜¯åŠ åˆ†é …ï¼ŒçœŸæ­£èª¿é »çš„æ˜¯ä½ çš„æ„å¿µã€‚
                </p>
                <div id="oilRecommendation"></div>
            </div>

            <button class="back-btn" onclick="resetCalculator()">â† é‡æ–°åˆ†æ</button>
        </div>
    </div>

    <script>
        const numberTraits = {
            1: {
                element: 'å°æœ¨',
                elementClass: 'wood',
                positive: 'ç¨ç«‹ã€è‡ªä¿¡ã€é ˜å°ã€æœæ–·ã€ç©æ¥µä¸»å‹•',
                negative: 'è‡ªæˆ‘ä¸­å¿ƒã€å›ºåŸ·ã€ä¸è€ç…©ã€é€å¼·',
                oil: 'èƒ½é‡å®ˆè­·',
                advice: 'ç©©ä½è¡å‹•çš„å€‹æ€§ï¼Œå­¸ç¿’èˆ‡ä»–äººåˆä½œï¼Œä¿¡ä»»åœ˜éšŠåŠ›é‡'
            },
            2: {
                element: 'å°æ°´',
                elementClass: 'water',
                positive: 'é«”è²¼ã€æ•æ„Ÿã€ç´°è†©ã€å–„è§£äººæ„ã€åˆä½œåŠ›å¼·',
                negative: 'æƒ…ç·’åŒ–ã€ä¾è³´ã€å„ªæŸ”å¯¡æ–·ã€é€ƒé¿',
                oil: 'æ·±å±¤é‡‹æ”¾',
                advice: 'é‡‹æ”¾éåº¦æ•æ„Ÿçš„æƒ…ç·’ï¼Œå»ºç«‹å¥åº·ç•Œç·šï¼Œå­¸ç¿’ç¨ç«‹'
            },
            3: {
                element: 'å°ç«',
                elementClass: 'fire',
                positive: 'å‰µæ„ã€ç†±æƒ…ã€è¡¨é”åŠ›å¼·ã€å¹½é»˜ã€æ´»æ½‘',
                negative: 'æƒ…ç·’èµ·ä¼å¿«ã€ç¼ºä¹è€æ€§ã€æ˜“åˆ†å¿ƒ',
                oil: 'ç©©å®šç£å ´',
                advice: 'å¹³è¡¡å¿«é€Ÿæ³¢å‹•çš„æƒ…ç·’ï¼ŒåŸ¹é¤Šè€å¿ƒèˆ‡å°ˆæ³¨åŠ›'
            },
            4: {
                element: 'å°é‡‘',
                elementClass: 'metal',
                positive: 'å‹™å¯¦ã€ç©©å®šã€æœ‰ç´€å¾‹ã€å¯é ã€å®‰å…¨æ„Ÿå¼·',
                negative: 'å›ºåŸ·ã€ä¿å®ˆã€ç„¦æ…®ã€éåº¦è¬¹æ…',
                oil: 'å¿ƒéˆç¶»æ”¾',
                advice: 'æ“æŠ±è®ŠåŒ–èˆ‡æ–°äº‹ç‰©ï¼Œé‡‹æ”¾ç„¦æ…®ï¼Œå­¸ç¿’å½ˆæ€§'
            },
            5: {
                element: 'ä¸­å¤®åœŸ',
                elementClass: 'earth',
                positive: 'è‡ªç”±ã€å¤šè®Šã€å†’éšªç²¾ç¥ã€é©æ‡‰åŠ›å¼·',
                negative: 'ç¼ºä¹å®šæ€§ã€ä¸ç©©å®šã€ç„¦èºã€å–„è®Š',
                oil: 'èƒ½é‡å®ˆè­·',
                advice: 'ç©©å®šå–„è®Šç„¦èºçš„ç‰¹è³ªï¼ŒåŸ¹é¤Šè€å¿ƒèˆ‡æŒçºŒåŠ›'
            },
            6: {
                element: 'å¤§é‡‘',
                elementClass: 'metal',
                positive: 'è²¬ä»»æ„Ÿå¼·ã€é—œæ‡·ã€å®¶åº­å–å‘ã€å¥‰ç»',
                negative: 'æƒ…ç·’å‹’ç´¢ã€æ§åˆ¶æ¬²å¼·ã€éåº¦ä»˜å‡º',
                oil: 'æ·±å±¤é‡‹æ”¾',
                advice: 'é‡‹æ”¾éåº¦ä»˜å‡ºçš„å£“åŠ›ï¼Œå­¸ç¿’æ„›è‡ªå·±ï¼Œè¨­ç«‹ç•Œç·š'
            },
            7: {
                element: 'å¤§æ°´',
                elementClass: 'water',
                positive: 'æ·±æ€ç†Ÿæ…®ã€æ´å¯ŸåŠ›å¼·ã€æ•éŠ³ã€æ™ºæ…§',
                negative: 'å…§å‘å¤šç–‘ã€ç„¦æ…®ã€ä¸å–„è¡¨é”',
                oil: 'æ·±å±¤é‡‹æ”¾',
                advice: 'æ¸…ç†å…§åœ¨è¤‡é›œçš„æƒ…ç·’å£“åŠ›ï¼Œå­¸ç¿’ä¿¡ä»»èˆ‡è¡¨é”'
            },
            8: {
                element: 'å¤§ç«',
                elementClass: 'fire',
                positive: 'æ¬Šå¨ã€è‡ªä¿¡ã€æœ‰é ˜å°åŠ›ã€ä¼åœ–å¿ƒå¼·',
                negative: 'æ§åˆ¶æ¬²å¼·ã€æƒ…ç·’æ‚¶ç‡’ã€å›ºåŸ·ã€éœ¸é“',
                oil: 'ç©©å®šç£å ´',
                advice: 'é¿å…æƒ…ç·’æ‚¶ç‡’çˆ†ç™¼ï¼Œå­¸ç¿’æŸ”è»Ÿèˆ‡å‚¾è½'
            },
            9: {
                element: 'å¤§æœ¨',
                elementClass: 'wood',
                positive: 'æ…ˆæ‚²ã€å¥‰ç»ã€åŒ…å®¹åŠ›å¼·ã€ç†æƒ³ä¸»ç¾©',
                negative: 'éåº¦çŠ§ç‰²ã€è‡ªæˆ‘å£“æŠ‘ã€æ˜“æ„Ÿå§”å±ˆ',
                oil: 'å¿ƒéˆç¶»æ”¾',
                advice: 'æ¸›å°‘éåº¦çŠ§ç‰²èˆ‡å£“æŠ‘ï¼Œå­¸ç¿’æ„›è‡ªå·±ï¼Œæ¥å—ä¸å®Œç¾'
            }
        };

        function calculateNumerology() {
            const birthdate = document.getElementById('birthdate').value;
            const name = document.getElementById('name').value || 'æ‚¨';

            if (!birthdate) {
                alert('è«‹é¸æ“‡å‡ºç”Ÿæ—¥æœŸ');
                return;
            }

            const date = new Date(birthdate);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();

            // è¨ˆç®—åŸºç¤æ•¸å­—
            const dayNum = reduceToSingle(day);
            const monthNum = reduceToSingle(month);
            const yearFront = reduceToSingle(Math.floor(year / 100));
            const yearBack = year >= 2000 && year % 100 === 0 ? 5 : reduceToSingle(year % 100);

            // è¨ˆç®—ä¸‰è§’æ•¸å­—
            const leftSecond = reduceToSingle(dayNum + monthNum);
            const rightSecond = reduceToSingle(yearFront + yearBack);
            const core = reduceToSingle(leftSecond + rightSecond);

            // è¨ˆç®—ä¹å®®æ ¼
            const gridData = calculateGrid(year, month, day);

            // é¡¯ç¤ºçµæœ
            document.getElementById('inputSection').style.display = 'none';
            document.getElementById('resultSection').style.display = 'block';

            // ç¹ªè£½ä¸‰è§’åœ–
            drawTriangle(dayNum, monthNum, yearFront, yearBack, leftSecond, rightSecond, core);

            // ç¹ªè£½ä¹å®®æ ¼
            drawGrid(gridData);

            // é¡¯ç¤ºæ•¸å­—ç‰¹è³ª
            displayTraits(core, leftSecond, rightSecond);

            // é¡¯ç¤ºç²¾æ²¹å»ºè­°
            displayOilRecommendation(core, gridData);

            // æ»¾å‹•åˆ°çµæœå€åŸŸ
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        function reduceToSingle(num) {
            while (num > 9) {
                num = num.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            return num;
        }

        function calculateGrid(year, month, day) {
            const dateString = `${year}${month.toString().padStart(2, '0')}${day.toString().padStart(2, '0')}`;
            const digits = dateString.split('').map(Number).filter(n => n > 0);
            
            const grid = {};
            for (let i = 1; i <= 9; i++) {
                grid[i] = digits.filter(d => d === i).length;
            }
            
            return grid;
        }

        function drawTriangle(day, month, yearFront, yearBack, left2, right2, core) {
            const container = document.getElementById('triangleContainer');
            
            const svg = `
                <svg class="triangle-svg" viewBox="0 0 500 450" xmlns="http://www.w3.org/2000/svg">
                    <!-- å¤–ä¸‰è§’ -->
                    <line x1="250" y1="50" x2="100" y2="350" stroke="#d4a574" stroke-width="3"/>
                    <line x1="250" y1="50" x2="400" y2="350" stroke="#d4a574" stroke-width="3"/>
                    <line x1="100" y1="350" x2="400" y2="350" stroke="#d4a574" stroke-width="3"/>
                    
                    <!-- å…§ä¸‰è§’ -->
                    <line x1="250" y1="150" x2="150" y2="300" stroke="#c89b6d" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="250" y1="150" x2="350" y2="300" stroke="#c89b6d" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="150" y1="300" x2="350" y2="300" stroke="#c89b6d" stroke-width="2" stroke-dasharray="5,5"/>
                    
                    <!-- æ ¸å¿ƒæ•¸å­— -->
                    <circle cx="250" cy="150" r="35" fill="#d4a574" opacity="0.9"/>
                    <text x="250" y="160" text-anchor="middle" font-size="32" font-weight="bold" fill="white">${core}</text>
                    <text x="250" y="120" text-anchor="middle" font-size="14" fill="#5d4e37" font-weight="600">å…§åœ¨æ ¸å¿ƒ</text>
                    
                    <!-- ç¬¬äºŒå±¤ -->
                    <circle cx="150" cy="300" r="30" fill="#c89b6d" opacity="0.9"/>
                    <text x="150" y="308" text-anchor="middle" font-size="28" font-weight="bold" fill="white">${left2}</text>
                    <text x="150" y="270" text-anchor="middle" font-size="12" fill="#5d4e37">æƒ…æ„Ÿé¢</text>
                    
                    <circle cx="350" cy="300" r="30" fill="#c89b6d" opacity="0.9"/>
                    <text x="350" y="308" text-anchor="middle" font-size="28" font-weight="bold" fill="white">${right2}</text>
                    <text x="350" y="270" text-anchor="middle" font-size="12" fill="#5d4e37">è¡Œå‹•é¢</text>
                    
                    <!-- åº•å±¤å››å€‹æ•¸å­— -->
                    <circle cx="100" cy="350" r="25" fill="#e8ddd3"/>
                    <text x="100" y="357" text-anchor="middle" font-size="24" font-weight="bold" fill="#5d4e37">${day}</text>
                    <text x="100" y="390" text-anchor="middle" font-size="11" fill="#8b7355">æ—¥</text>
                    
                    <circle cx="200" cy="350" r="25" fill="#e8ddd3"/>
                    <text x="200" y="357" text-anchor="middle" font-size="24" font-weight="bold" fill="#5d4e37">${month}</text>
                    <text x="200" y="390" text-anchor="middle" font-size="11" fill="#8b7355">æœˆ</text>
                    
                    <circle cx="300" cy="350" r="25" fill="#e8ddd3"/>
                    <text x="300" y="357" text-anchor="middle" font-size="24" font-weight="bold" fill="#5d4e37">${yearFront}</text>
                    <text x="300" y="390" text-anchor="middle" font-size="11" fill="#8b7355">å¹´å‰</text>
                    
                    <circle cx="400" cy="350" r="25" fill="#e8ddd3"/>
                    <text x="400" y="357" text-anchor="middle" font-size="24" font-weight="bold" fill="#5d4e37">${yearBack}</text>
                    <text x="400" y="390" text-anchor="middle" font-size="11" fill="#8b7355">å¹´å¾Œ</text>
                </svg>
            `;
            
            container.innerHTML = svg;
            
            const explanation = `
                <div class="trait-card">
                    <div class="trait-title">ğŸ¯ æ‚¨çš„å…§åœ¨æ ¸å¿ƒæ•¸å­—ï¼š${core}ï¼ˆ${numberTraits[core].element}ï¼‰</div>
                    <div class="trait-content">
                        é€™æ˜¯æ‚¨éˆé­‚æ·±è™•æœ€çœŸå¯¦çš„è‡ªæˆ‘ã€‚${numberTraits[core].element}èƒ½é‡ä»£è¡¨${numberTraits[core].positive.split('ã€')[0]}çš„ç‰¹è³ªã€‚
                    </div>
                </div>
                <div class="trait-card" style="margin-top: 15px;">
                    <div class="trait-title">ğŸ’« æƒ…æ„Ÿé¢ï¼ˆ${left2}ï¼‰Ã— è¡Œå‹•é¢ï¼ˆ${right2}ï¼‰</div>
                    <div class="trait-content">
                        æ‚¨çš„æƒ…æ„Ÿç›´è¦ºç”±æ•¸å­—${left2}ä¸»å°ï¼Œè¡Œå‹•ç†æ€§ç”±æ•¸å­—${right2}å¼•é ˜ã€‚å…©è€…çµåˆå½¢æˆæ‚¨ç¨ç‰¹çš„äººæ ¼ç‰¹è³ªã€‚
                    </div>
                </div>
            `;
            
            document.getElementById('triangleExplanation').innerHTML = explanation;
        }

        function drawGrid(gridData) {
            const container = document.getElementById('gridContainer');
            const gridLayout = [
                [3, 6, 9],
                [2, 5, 8],
                [1, 4, 7]
            ];
            
            let html = '';
            gridLayout.forEach(row => {
                row.forEach(num => {
                    const count = gridData[num];
                    const dots = 'â—'.repeat(Math.min(count, 6));
                    html += `
                        <div class="grid-cell">
                            <div class="grid-number">${num}</div>
                            <div class="grid-dots">${dots}${count > 6 ? '...' : ''}</div>
                        </div>
                    `;
                });
            });
            
            container.innerHTML = html;
            
            // åˆ†æé€£ç·šå’Œç©ºç¼º
            const analysis = analyzeGrid(gridData);
            document.getElementById('gridAnalysis').innerHTML = analysis;
        }

        function analyzeGrid(gridData) {
            const lines = {
                'æˆåŠŸç·š (1-5-9)': [1, 5, 9],
                'è²´äººç·š (3-6-9)': [3, 6, 9],
                'è²¡å¯Œç·š (4-5-6)': [4, 5, 6],
                'æ™ºæ…§ç·š (2-5-8)': [2, 5, 8]
            };
            
            let html = '<div class="traits-grid">';
            
            // æª¢æŸ¥é€£ç·š
            for (const [lineName, numbers] of Object.entries(lines)) {
                const hasLine = numbers.every(n => gridData[n] > 0);
                if (hasLine) {
                    html += `
                        <div class="trait-card" style="border-left-color: #90EE90;">
                            <div class="trait-title">âœ¨ ${lineName}</div>
                            <div class="trait-content">æ­å–œï¼æ‚¨æ“æœ‰å®Œæ•´çš„${lineName.split(' ')[0]}ï¼Œé€™ä»£è¡¨æ‚¨åœ¨é€™æ–¹é¢å…·æœ‰å¤©è³¦å„ªå‹¢ã€‚</div>
                        </div>
                    `;
                }
            }
            
            // æª¢æŸ¥ç©ºç¼º
            const missing = [];
            const excessive = [];
            for (let i = 1; i <= 9; i++) {
                if (gridData[i] === 0) missing.push(i);
                if (gridData[i] >= 3) excessive.push(i);
            }
            
            if (missing.length > 0) {
                html += `
                    <div class="trait-card" style="border-left-color: #FFB6C1;">
                        <div class="trait-title">ğŸ“š éœ€è¦å­¸ç¿’çš„èª²é¡Œ</div>
                        <div class="trait-content">
                            ç©ºç¼ºæ•¸å­—ï¼š${missing.join(', ')}<br>
                            é€™äº›æ•¸å­—ä»£è¡¨æ‚¨éœ€è¦å­¸ç¿’å’Œç™¼å±•çš„ç‰¹è³ªï¼Œæ˜¯äººç”Ÿæˆé•·çš„é‡è¦æ–¹å‘ã€‚
                        </div>
                    </div>
                `;
            }
            
            if (excessive.length > 0) {
                html += `
                    <div class="trait-card" style="border-left-color: #F4A460;">
                        <div class="trait-title">âš–ï¸ éœ€è¦å¹³è¡¡çš„èƒ½é‡</div>
                        <div class="trait-content">
                            é‡è¤‡æ•¸å­—ï¼š${excessive.join(', ')}<br>
                            é€™äº›æ•¸å­—å‡ºç¾éå¤šï¼Œç‰¹è³ªå¯èƒ½éåº¦å¼·çƒˆï¼Œéœ€è¦å­¸ç¿’å¹³è¡¡èˆ‡èª¿å’Œã€‚
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }

        function displayTraits(core, left2, right2) {
            const container = document.getElementById('traitsGrid');
            const numbers = [core, left2, right2];
            const uniqueNumbers = [...new Set(numbers)];
            
            let html = '';
            uniqueNumbers.forEach(num => {
                const trait = numberTraits[num];
                html += `
                    <div class="trait-card">
                        <div class="trait-title">
                            æ•¸å­— ${num} 
                            <span class="element-badge ${trait.elementClass}">${trait.element}</span>
                        </div>
                        <div class="trait-content">
                            <p><strong>âœ¨ æ­£é¢ç‰¹è³ªï¼š</strong>${trait.positive}</p>
                            <p style="margin-top: 10px;"><strong>âš ï¸ è² é¢ç‰¹è³ªï¼š</strong>${trait.negative}</p>
                            <p style="margin-top: 10px; color: #d4a574;"><strong>ğŸ’¡ èª¿é »å»ºè­°ï¼š</strong>${trait.advice}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function displayOilRecommendation(core, gridData) {
            const container = document.getElementById('oilRecommendation');
            const coreTrait = numberTraits[core];
            
            // æ‰¾å‡ºç©ºç¼ºå’Œéå¤šçš„æ•¸å­—
            const missing = [];
            const excessive = [];
            for (let i = 1; i <= 9; i++) {
                if (gridData[i] === 0) missing.push(i);
                if (gridData[i] >= 3) excessive.push(i);
            }
            
            let html = `
                <div class="oil-title">ğŸŒ¿ ä¸»è¦æ¨è–¦ï¼š${coreTrait.oil}ï¼ˆæ„å¿µèª¿é »ï¼‰</div>
                <div class="trait-content" style="margin-bottom: 20px;">
                    æ ¹æ“šæ‚¨çš„æ ¸å¿ƒæ•¸å­—${core}ï¼ˆ${coreTrait.element}ï¼‰ï¼Œå»ºè­°å•Ÿå‹•ã€Œ${coreTrait.oil}ã€çš„æ„Ÿå®˜è¨˜æ†¶ã€‚<br>
                    <strong>èª¿é »é‡é»ï¼š</strong>${coreTrait.advice}<br>
                    <em style="color: #a88257; font-size: 0.95em; margin-top: 8px; display: block;">ğŸ’­ æƒ³åƒé€™å€‹é¦™æ°£çš„ç•«é¢ã€é¡è‰²ã€æº«åº¦ï¼Œè®“å¤§è…¦è‡ªå‹•èª¿æ•´ä½ çš„æƒ…ç·’ç‹€æ…‹ã€‚</em>
                </div>
            `;
            
            if (missing.length > 0 || excessive.length > 0) {
                html += `<div class="oil-title" style="margin-top: 25px;">ğŸŒ¸ è¼”åŠ©ç²¾æ²¹å»ºè­°</div>`;
                
                if (excessive.length > 0) {
                    const oils = excessive.map(n => numberTraits[n].oil);
                    const uniqueOils = [...new Set(oils)];
                    html += `
                        <div class="trait-content" style="margin-top: 10px;">
                            <strong>å¹³è¡¡éåº¦èƒ½é‡ï¼š</strong>${uniqueOils.join('ã€')}ï¼ˆæ„å¿µèª¿é »ï¼‰<br>
                            æƒ³åƒé€™äº›é¦™æ°£ï¼Œå¹«åŠ©æ‚¨å¹³è¡¡æ•¸å­—${excessive.join(', ')}çš„éåº¦èƒ½é‡ã€‚
                        </div>
                    `;
                }
                
                if (missing.length > 0) {
                    const oils = missing.map(n => numberTraits[n].oil);
                    const uniqueOils = [...new Set(oils)];
                    html += `
                        <div class="trait-content" style="margin-top: 15px;">
                            <strong>è£œè¶³ç©ºç¼ºèƒ½é‡ï¼š</strong>${uniqueOils.join('ã€')}ï¼ˆæ„å¿µèª¿é »ï¼‰<br>
                            å•Ÿå‹•é€™äº›é¦™æ°£çš„æ„Ÿå®˜è¨˜æ†¶ï¼Œå¹«åŠ©æ‚¨ç™¼å±•æ•¸å­—${missing.join(', ')}çš„ç‰¹è³ªã€‚
                        </div>
                    `;
                }
            }
            
            html += `
                <div style="margin-top: 25px; padding: 15px; background: rgba(212, 165, 116, 0.1); border-radius: 8px;">
                    <strong style="color: #5d4e37;">ğŸ’« æ„å¿µèª¿é »ä¸‰æ­¥é©Ÿï¼š</strong><br>
                    <span style="color: #8b7355;">
                        <strong>1. å–šé†’æ„Ÿå®˜è¨˜æ†¶</strong> - æƒ³åƒé€™å€‹é¦™æ°£çš„ç•«é¢ã€é¡è‰²ã€æº«åº¦<br>
                        <strong>2. é€£æ¥èº«é«”æ„Ÿå—</strong> - æ³¨æ„å‘¼å¸ã€å¿ƒè·³ã€è‚©è†€çš„æ”¾é¬†ç¨‹åº¦<br>
                        <strong>3. è¨­å®šèª¿é »æ„åœ–</strong> - é»˜å¿µã€Œæˆ‘é‡‹æ”¾ï¼ˆè² é¢ç‰¹è³ªï¼‰ï¼Œæˆ‘æ“æŠ±ï¼ˆæ­£é¢ç‰¹è³ªï¼‰ã€<br><br>
                        <em style="font-size: 0.9em;">ğŸ’¡ æ¯æ—¥æ—©æ™šå„3åˆ†é˜ï¼ŒæŒçºŒ21å¤©ã€‚å¦‚æœ‰å¯¦é«”ç²¾æ²¹å¯åŠ å¼·æ•ˆæœï¼Œä½†éå¿…éœ€ã€‚</em>
                    </span>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function resetCalculator() {
            document.getElementById('inputSection').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('birthdate').value = '';
            document.getElementById('name').value = '';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
